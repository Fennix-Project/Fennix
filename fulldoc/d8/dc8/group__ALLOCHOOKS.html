<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fennix: liballoc hooks</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fennix
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Opeating System from scratch made in C and C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/dc8/group__ALLOCHOOKS.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">liballoc hooks</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga397816ee230d64fe081f93d31bf5a534"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(func)&#160;&#160;&#160;kliballoc_##func</td></tr>
<tr class="separator:ga397816ee230d64fe081f93d31bf5a534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga397816ee230d64fe081f93d31bf5a534"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(func)&#160;&#160;&#160;kliballoc_##func</td></tr>
<tr class="separator:ga397816ee230d64fe081f93d31bf5a534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga397816ee230d64fe081f93d31bf5a534"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(func)&#160;&#160;&#160;__##func</td></tr>
<tr class="separator:ga397816ee230d64fe081f93d31bf5a534"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8b5670e4594b0b6f8be78fe17f0c3b53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga8b5670e4594b0b6f8be78fe17f0c3b53">liballoc_lock</a> ()</td></tr>
<tr class="separator:ga8b5670e4594b0b6f8be78fe17f0c3b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaedc23f198b2882d41d0caa316453967b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a> ()</td></tr>
<tr class="separator:gaedc23f198b2882d41d0caa316453967b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2da84788fc4ab3f487214d24a3e55af4"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga2da84788fc4ab3f487214d24a3e55af4">liballoc_alloc</a> (<a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>)</td></tr>
<tr class="separator:ga2da84788fc4ab3f487214d24a3e55af4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d5be3c85e157d771a44c48509b43c42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga8d5be3c85e157d771a44c48509b43c42">liballoc_free</a> (void *, <a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>)</td></tr>
<tr class="separator:ga8d5be3c85e157d771a44c48509b43c42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5223b5fb1255b5179f53b0595fe9251c"><td class="memItemLeft" align="right" valign="top">void *<a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga5223b5fb1255b5179f53b0595fe9251c">malloc</a> (<a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>)</td></tr>
<tr class="memdesc:ga5223b5fb1255b5179f53b0595fe9251c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The standard function.  <a href="../../d8/dc8/group__ALLOCHOOKS.html#ga5223b5fb1255b5179f53b0595fe9251c">More...</a><br /></td></tr>
<tr class="separator:ga5223b5fb1255b5179f53b0595fe9251c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc710223dc26577d1e49cac212d7d083"><td class="memItemLeft" align="right" valign="top">void *<a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#gadc710223dc26577d1e49cac212d7d083">realloc</a> (void *, <a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>)</td></tr>
<tr class="memdesc:gadc710223dc26577d1e49cac212d7d083"><td class="mdescLeft">&#160;</td><td class="mdescRight">The standard function.  <a href="../../d8/dc8/group__ALLOCHOOKS.html#gadc710223dc26577d1e49cac212d7d083">More...</a><br /></td></tr>
<tr class="separator:gadc710223dc26577d1e49cac212d7d083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9db1af54761723ecddbd1e253c01a2ad"><td class="memItemLeft" align="right" valign="top">void *<a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga9db1af54761723ecddbd1e253c01a2ad">calloc</a> (<a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>, <a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>)</td></tr>
<tr class="memdesc:ga9db1af54761723ecddbd1e253c01a2ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">The standard function.  <a href="../../d8/dc8/group__ALLOCHOOKS.html#ga9db1af54761723ecddbd1e253c01a2ad">More...</a><br /></td></tr>
<tr class="separator:ga9db1af54761723ecddbd1e253c01a2ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4835fe140973dbc5e1aafd9c33acf6d4"><td class="memItemLeft" align="right" valign="top">void <a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga4835fe140973dbc5e1aafd9c33acf6d4">free</a> (void *)</td></tr>
<tr class="memdesc:ga4835fe140973dbc5e1aafd9c33acf6d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The standard function.  <a href="../../d8/dc8/group__ALLOCHOOKS.html#ga4835fe140973dbc5e1aafd9c33acf6d4">More...</a><br /></td></tr>
<tr class="separator:ga4835fe140973dbc5e1aafd9c33acf6d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These are the OS specific functions which need to be implemented on any platform that the library is expected to work on. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga397816ee230d64fe081f93d31bf5a534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga397816ee230d64fe081f93d31bf5a534">&#9670;&nbsp;</a></span>PREFIX <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PREFIX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">func</td><td>)</td>
          <td>&#160;&#160;&#160;kliballoc_##func</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>

<p class="definition">Definition at line <a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h_source.html#l00020">20</a> of file <a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h_source.html">liballoc_1_1.h</a>.</p>

</div>
</div>
<a id="ga397816ee230d64fe081f93d31bf5a534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga397816ee230d64fe081f93d31bf5a534">&#9670;&nbsp;</a></span>PREFIX <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PREFIX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">func</td><td>)</td>
          <td>&#160;&#160;&#160;kliballoc_##func</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d7/d90/Lynx_2UEFI_2src_2Memory_2liballoc__1__1_8h.html">Lynx/UEFI/src/Memory/liballoc_1_1.h</a>&gt;</code></p>

<p class="definition">Definition at line <a class="el" href="../../d7/d90/Lynx_2UEFI_2src_2Memory_2liballoc__1__1_8h_source.html#l00036">36</a> of file <a class="el" href="../../d7/d90/Lynx_2UEFI_2src_2Memory_2liballoc__1__1_8h_source.html">liballoc_1_1.h</a>.</p>

</div>
</div>
<a id="ga397816ee230d64fe081f93d31bf5a534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga397816ee230d64fe081f93d31bf5a534">&#9670;&nbsp;</a></span>PREFIX <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PREFIX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">func</td><td>)</td>
          <td>&#160;&#160;&#160;__##func</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d6/d4e/Userspace_2libc_2src_2mem_2liballoc__1__1_8h.html">Userspace/libc/src/mem/liballoc_1_1.h</a>&gt;</code></p>

<p class="definition">Definition at line <a class="el" href="../../d6/d4e/Userspace_2libc_2src_2mem_2liballoc__1__1_8h_source.html#l00020">20</a> of file <a class="el" href="../../d6/d4e/Userspace_2libc_2src_2mem_2liballoc__1__1_8h_source.html">liballoc_1_1.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga9db1af54761723ecddbd1e253c01a2ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9db1af54761723ecddbd1e253c01a2ad">&#9670;&nbsp;</a></span>calloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* <a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>() calloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>&#160;</td>
          <td class="paramname"><em>nobj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>

<p>The standard function. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00686">686</a> of file <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html">liballoc_1_1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">int</span> real_size;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    real_size = nobj * <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a> = <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(<a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga5223b5fb1255b5179f53b0595fe9251c">malloc</a>)(real_size);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad824e94da51543e1febb05f96f0083ba">liballoc_memset</a>(<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>, 0, real_size);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;}</div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_ad824e94da51543e1febb05f96f0083ba"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad824e94da51543e1febb05f96f0083ba">liballoc_memset</a></div><div class="ttdeci">static void * liballoc_memset(void *s, int c, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00102">liballoc_1_1.c:102</a></div></div>
<div class="ttc" id="agroup__ALLOCHOOKS_html_ga397816ee230d64fe081f93d31bf5a534"><div class="ttname"><a href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a></div><div class="ttdeci">#define PREFIX(func)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h_source.html#l00020">liballoc_1_1.h:20</a></div></div>
<div class="ttc" id="agroup__ALLOCHOOKS_html_ga5223b5fb1255b5179f53b0595fe9251c"><div class="ttname"><a href="../../d8/dc8/group__ALLOCHOOKS.html#ga5223b5fb1255b5179f53b0595fe9251c">malloc</a></div><div class="ttdeci">void *PREFIX() malloc(size_t req_size)</div><div class="ttdoc">The standard function.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00228">liballoc_1_1.c:228</a></div></div>
<div class="ttc" id="astring-stubs_8cpp_html_a252e4787d2e315cb28693ef2d9862e78"><div class="ttname"><a href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a></div><div class="ttdeci">int const wchar_t size_t MLIBC_STUB_BODY int const wchar_t size_t size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/string-stubs_8cpp_source.html#l00287">string-stubs.cpp:287</a></div></div>
<div class="ttc" id="awi__stuff_8c_html_a5f53dec9fe800012c2be6ab5167d2cfd"><div class="ttname"><a href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a></div><div class="ttdeci">static patch_t * p[MAXPLAYERS]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d23/wi__stuff_8c_source.html#l00386">wi_stuff.c:386</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga4835fe140973dbc5e1aafd9c33acf6d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4835fe140973dbc5e1aafd9c33acf6d4">&#9670;&nbsp;</a></span>free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>() free </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>

<p>The standard function. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00561">561</a> of file <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html">liballoc_1_1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;{</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *min;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d6/db9/structliballoc__major">liballoc_major</a> *maj;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">if</span> (ptr == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2d9b708c1e8825a6bb6612661bc4bdbd">l_warningCount</a> += 1;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: WARNING: PREFIX(free)( NULL ) called from %lx\n&quot;</span>,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;               __builtin_return_address(0));</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a1c35d927b46457b91f58e659890008c1">UNALIGN</a>(ptr);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga8b5670e4594b0b6f8be78fe17f0c3b53">liballoc_lock</a>(); <span class="comment">// lockit</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    min = (<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)ptr - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>));</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> != <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af83e911f592858658db8dba2a74f5772">l_errorCount</a> += 1;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="comment">// Check for overrun errors. For all bytes of LIBALLOC_MAGIC</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            ((min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> &amp; 0xFFFFFF) == (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a> &amp; 0xFFFFFF)) ||</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            ((min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> &amp; 0xFFFF) == (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a> &amp; 0xFFFF)) ||</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            ((min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> &amp; 0xFF) == (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a> &amp; 0xFF)))</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a48c2c6cb4bd97dd911ef24ff2a42ca5d">l_possibleOverruns</a> += 1;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: ERROR: Possible 1-3 byte overrun for magic %lx != %lx\n&quot;</span>,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                   min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a>,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                   <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> == <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aae1f702e677fee87387d8086e751f8b3">LIBALLOC_DEAD</a>)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: ERROR: multiple PREFIX(free)() attempt on %lx from %lx.\n&quot;</span>,</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                   ptr,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                   __builtin_return_address(0));</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: ERROR: Bad PREFIX(free)( %lx ) called from %lx\n&quot;</span>,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                   ptr,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                   __builtin_return_address(0));</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">// being lied to...</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: %lx PREFIX(free)( %lx ): &quot;</span>,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;           __builtin_return_address(0),</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;           ptr);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    maj = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#aff17c469cb0dcbc1f8320b8342075b1d">block</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2ce5de2eb7b8595f398caf844a033cb1">l_inuse</a> -= min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a> -= (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>));</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aae1f702e677fee87387d8086e751f8b3">LIBALLOC_DEAD</a>; <span class="comment">// No mojo.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a> = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// Might empty the block. This was the first</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// minor.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">// We need to clean up after the majors now....</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>) <span class="comment">// Block completely unused.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a> == maj)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a> = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a> == maj)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a> = <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac04a8297d249fe04b86ac22d9f4db11e">prev</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac04a8297d249fe04b86ac22d9f4db11e">prev</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac04a8297d249fe04b86ac22d9f4db11e">prev</a> = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac04a8297d249fe04b86ac22d9f4db11e">prev</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ab0e0c20055b59102841b90dc4ec55610">l_allocated</a> -= maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a94315a9fd8d95755437248f20450e9ba">size</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga8d5be3c85e157d771a44c48509b43c42">liballoc_free</a>(maj, maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac355949c287ae38eefdfa97dc2abfc93">pages</a>);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="keywordtype">int</span> bestSize = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a94315a9fd8d95755437248f20450e9ba">size</a> - <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordtype">int</span> majSize = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a94315a9fd8d95755437248f20450e9ba">size</a> - maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">if</span> (majSize &gt; bestSize)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a> = maj;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;OK\n&quot;</span>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a1c35d927b46457b91f58e659890008c1"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a1c35d927b46457b91f58e659890008c1">UNALIGN</a></div><div class="ttdeci">#define UNALIGN(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00033">liballoc_1_1.c:33</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a2ce5de2eb7b8595f398caf844a033cb1"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2ce5de2eb7b8595f398caf844a033cb1">l_inuse</a></div><div class="ttdeci">static unsigned long long l_inuse</div><div class="ttdoc">Running total of used memory.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00094">liballoc_1_1.c:94</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a2d9b708c1e8825a6bb6612661bc4bdbd"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2d9b708c1e8825a6bb6612661bc4bdbd">l_warningCount</a></div><div class="ttdeci">static long long l_warningCount</div><div class="ttdoc">Number of warnings encountered.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00096">liballoc_1_1.c:96</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a48c2c6cb4bd97dd911ef24ff2a42ca5d"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a48c2c6cb4bd97dd911ef24ff2a42ca5d">l_possibleOverruns</a></div><div class="ttdeci">static long long l_possibleOverruns</div><div class="ttdoc">Number of possible overruns.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00098">liballoc_1_1.c:98</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a650715799a325fedc4d7b07a181378d9"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a></div><div class="ttdeci">static struct liballoc_major * l_memRoot</div><div class="ttdoc">The root memory block acquired from the system.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00088">liballoc_1_1.c:88</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_aa564d1a8832090131b83d62eae1f07d7"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a></div><div class="ttdeci">static struct liballoc_major * l_bestBet</div><div class="ttdoc">The major with the most free memory.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00089">liballoc_1_1.c:89</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_aae1f702e677fee87387d8086e751f8b3"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aae1f702e677fee87387d8086e751f8b3">LIBALLOC_DEAD</a></div><div class="ttdeci">#define LIBALLOC_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00044">liballoc_1_1.c:44</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_ab0e0c20055b59102841b90dc4ec55610"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ab0e0c20055b59102841b90dc4ec55610">l_allocated</a></div><div class="ttdeci">static unsigned long long l_allocated</div><div class="ttdoc">Running total of allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00093">liballoc_1_1.c:93</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_ad7ca11d555f526a6c553f150b898c0d8"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a></div><div class="ttdeci">#define FLUSH()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00055">liballoc_1_1.c:55</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_ae34a762828cbff7cce62bda6571b2bc0"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a></div><div class="ttdeci">#define printf(m,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00057">liballoc_1_1.c:57</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_af6b1d459ffa3c81e2456acf8d4268330"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a></div><div class="ttdeci">#define LIBALLOC_MAGIC</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00043">liballoc_1_1.c:43</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_af83e911f592858658db8dba2a74f5772"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af83e911f592858658db8dba2a74f5772">l_errorCount</a></div><div class="ttdeci">static long long l_errorCount</div><div class="ttdoc">Number of actual errors.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00097">liballoc_1_1.c:97</a></div></div>
<div class="ttc" id="aKernel_2include_2types_8h_html_a4788399d1d0b37ccf098a7da82254808"><div class="ttname"><a href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a></div><div class="ttdeci">__UINTPTR_TYPE__ uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/Kernel_2include_2types_8h_source.html#l00143">types.h:143</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a138f5528e084fb73761b9a23e106fb4a"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">liballoc_minor::size</a></div><div class="ttdeci">unsigned int size</div><div class="ttdoc">The size of the memory allocated. Could be 1 byte or more.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00084">liballoc_1_1.c:84</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a2a521ac1721a7b39baf53f995e0fcccf"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">liballoc_minor::magic</a></div><div class="ttdeci">unsigned int magic</div><div class="ttdoc">A magic number to idenfity correctness.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00083">liballoc_1_1.c:83</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a4a147f5e1587d20f79184a9ec731e7cf"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">liballoc_major::next</a></div><div class="ttdeci">struct liballoc_major * next</div><div class="ttdoc">Linked list information.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00067">liballoc_1_1.c:67</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a8bb10f7f3cf052b617c718367bf0a095"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">liballoc_minor::next</a></div><div class="ttdeci">struct liballoc_minor * next</div><div class="ttdoc">Linked list information.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00081">liballoc_1_1.c:81</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a8db150d09474fa68d04b5454eb21ab28"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">liballoc_major::first</a></div><div class="ttdeci">struct liballoc_minor * first</div><div class="ttdoc">A pointer to the first allocated memory in the block.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00071">liballoc_1_1.c:71</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a94315a9fd8d95755437248f20450e9ba"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a94315a9fd8d95755437248f20450e9ba">liballoc_major::size</a></div><div class="ttdeci">unsigned int size</div><div class="ttdoc">The number of pages in the block.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00069">liballoc_1_1.c:69</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a9b88d3a051111df81ecdd3147f4386d9"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">liballoc_minor::prev</a></div><div class="ttdeci">struct liballoc_minor * prev</div><div class="ttdoc">Linked list information.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00080">liballoc_1_1.c:80</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_ab4d9c00c552e0ddd4997a91966bfc4f4"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">liballoc_major::usage</a></div><div class="ttdeci">unsigned int usage</div><div class="ttdoc">The number of bytes used in the block.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00070">liballoc_1_1.c:70</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_ac04a8297d249fe04b86ac22d9f4db11e"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac04a8297d249fe04b86ac22d9f4db11e">liballoc_major::prev</a></div><div class="ttdeci">struct liballoc_major * prev</div><div class="ttdoc">Linked list information.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00066">liballoc_1_1.c:66</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_ac355949c287ae38eefdfa97dc2abfc93"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac355949c287ae38eefdfa97dc2abfc93">liballoc_major::pages</a></div><div class="ttdeci">unsigned int pages</div><div class="ttdoc">The number of pages in the block.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00068">liballoc_1_1.c:68</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_aff17c469cb0dcbc1f8320b8342075b1d"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#aff17c469cb0dcbc1f8320b8342075b1d">liballoc_minor::block</a></div><div class="ttdeci">struct liballoc_major * block</div><div class="ttdoc">The owning block. A pointer to the major structure.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00082">liballoc_1_1.c:82</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_d6/db9/structliballoc__major"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d6/db9/structliballoc__major">liballoc_major</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00064">liballoc_1_1.c:65</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_d7/d3e/structliballoc__minor"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00078">liballoc_1_1.c:79</a></div></div>
<div class="ttc" id="agroup__ALLOCHOOKS_html_ga8b5670e4594b0b6f8be78fe17f0c3b53"><div class="ttname"><a href="../../d8/dc8/group__ALLOCHOOKS.html#ga8b5670e4594b0b6f8be78fe17f0c3b53">liballoc_lock</a></div><div class="ttdeci">int liballoc_lock()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc5/liballocimpl_8cpp_source.html#l00007">liballocimpl.cpp:7</a></div></div>
<div class="ttc" id="agroup__ALLOCHOOKS_html_ga8d5be3c85e157d771a44c48509b43c42"><div class="ttname"><a href="../../d8/dc8/group__ALLOCHOOKS.html#ga8d5be3c85e157d771a44c48509b43c42">liballoc_free</a></div><div class="ttdeci">int liballoc_free(void *, size_t)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc5/liballocimpl_8cpp_source.html#l00010">liballocimpl.cpp:10</a></div></div>
<div class="ttc" id="agroup__ALLOCHOOKS_html_gaedc23f198b2882d41d0caa316453967b"><div class="ttname"><a href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a></div><div class="ttdeci">int liballoc_unlock()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc5/liballocimpl_8cpp_source.html#l00008">liballocimpl.cpp:8</a></div></div>
<div class="ttc" id="astdlib-stubs_8cpp_html_a9578bf94fd913a1b19c44c1213156cf2"><div class="ttname"><a href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a></div><div class="ttdeci">NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc7/stdlib-stubs_8cpp_source.html#l00060">stdlib-stubs.cpp:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga2da84788fc4ab3f487214d24a3e55af4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2da84788fc4ab3f487214d24a3e55af4">&#9670;&nbsp;</a></span>liballoc_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * liballoc_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>&#160;</td>
          <td class="paramname"><em>Pages</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>
<p>This is the hook into the local system which allocates pages. It accepts an integer parameter which is the number of pages required. The page size was set up in the liballoc_init function.</p>
<dl class="section return"><dt>Returns</dt><dd>NULL if the pages were not allocated. </dd>
<dd>
A pointer to the allocated memory. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html#l00009">9</a> of file <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html">liballocimpl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="../../d2/d12/Kernel_2Core_2Memory_2Memory_8cpp.html#ad0bbf7b6012cd16abb06c03dd26ffbaf">KernelAllocator</a>.RequestPages(Pages); }</div>
<div class="ttc" id="aKernel_2Core_2Memory_2Memory_8cpp_html_ad0bbf7b6012cd16abb06c03dd26ffbaf"><div class="ttname"><a href="../../d2/d12/Kernel_2Core_2Memory_2Memory_8cpp.html#ad0bbf7b6012cd16abb06c03dd26ffbaf">KernelAllocator</a></div><div class="ttdeci">Physical KernelAllocator</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/Kernel_2Core_2Memory_2Memory_8cpp_source.html#l00032">Memory.cpp:32</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d6e/syscalls_8h_source.html#l00028">_RequestPages</a>, <a class="el" href="../../d2/d12/Kernel_2Core_2Memory_2Memory_8cpp_source.html#l00032">KernelAllocator</a>, and <a class="el" href="../../d2/d6e/syscalls_8h_source.html#l00223">syscall1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00177">allocate_new_page()</a>.</p>

</div>
</div>
<a id="ga8d5be3c85e157d771a44c48509b43c42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d5be3c85e157d771a44c48509b43c42">&#9670;&nbsp;</a></span>liballoc_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a> liballoc_free </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>&#160;</td>
          <td class="paramname"><em>Pages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>
<p>This frees previously allocated memory. The void* parameter passed to the function is the exact same value returned from a previous liballoc_alloc call.</p>
<p>The integer value is the number of pages to free.</p>
<dl class="section return"><dt>Returns</dt><dd>0 if the memory was successfully freed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html#l00010">10</a> of file <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html">liballocimpl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="../../d2/d12/Kernel_2Core_2Memory_2Memory_8cpp.html#ad0bbf7b6012cd16abb06c03dd26ffbaf">KernelAllocator</a>.FreePages(<a class="code" href="../../d1/d90/acpi_8hpp.html#aca1b23fd721c8d8dc70a8227e336b6e8">Address</a>, Pages);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;}</div>
<div class="ttc" id="aacpi_8hpp_html_aca1b23fd721c8d8dc70a8227e336b6e8"><div class="ttname"><a href="../../d1/d90/acpi_8hpp.html#aca1b23fd721c8d8dc70a8227e336b6e8">Address</a></div><div class="ttdeci">uint64_t Address</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d90/acpi_8hpp_source.html#l00004">acpi.hpp:4</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d6e/syscalls_8h_source.html#l00034">_FreePages</a>, <a class="el" href="../../d1/d90/acpi_8hpp_source.html#l00004">Address</a>, <a class="el" href="../../d2/d12/Kernel_2Core_2Memory_2Memory_8cpp_source.html#l00032">KernelAllocator</a>, and <a class="el" href="../../d2/d6e/syscalls_8h_source.html#l00233">syscall2()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00561">free()</a>.</p>

</div>
</div>
<a id="ga8b5670e4594b0b6f8be78fe17f0c3b53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b5670e4594b0b6f8be78fe17f0c3b53">&#9670;&nbsp;</a></span>liballoc_lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a> liballoc_lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>
<p>This function is supposed to lock the memory data structures. It could be as simple as disabling interrupts or acquiring a spinlock. It's up to you to decide.</p>
<dl class="section return"><dt>Returns</dt><dd>0 if the lock was acquired successfully. Anything else is failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html#l00007">7</a> of file <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html">liballocimpl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;{ <span class="keywordflow">return</span> liballocLock.Lock(__FUNCTION__); }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00561">free()</a>, <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00228">malloc()</a>, and <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00700">realloc()</a>.</p>

</div>
</div>
<a id="gaedc23f198b2882d41d0caa316453967b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaedc23f198b2882d41d0caa316453967b">&#9670;&nbsp;</a></span>liballoc_unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a> liballoc_unlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>
<p>This function unlocks what was previously locked by the liballoc_lock function. If it disabled interrupts, it enables interrupts. If it had acquiried a spinlock, it releases the spinlock. etc.</p>
<dl class="section return"><dt>Returns</dt><dd>0 if the lock was successfully released. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html#l00008">8</a> of file <a class="el" href="../../d2/dc5/liballocimpl_8cpp_source.html">liballocimpl.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{ <span class="keywordflow">return</span> liballocLock.Unlock(); }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00561">free()</a>, <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00228">malloc()</a>, and <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00700">realloc()</a>.</p>

</div>
</div>
<a id="ga5223b5fb1255b5179f53b0595fe9251c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5223b5fb1255b5179f53b0595fe9251c">&#9670;&nbsp;</a></span>malloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* <a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>() malloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>&#160;</td>
          <td class="paramname"><em>req_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>

<p>The standard function. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00228">228</a> of file <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html">liballoc_1_1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;{</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">int</span> startedBet = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> bestSize = 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a> = <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> diff;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d6/db9/structliballoc__major">liballoc_major</a> *maj;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *min;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *new_min;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> = <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// For alignment, we adjust size so there&#39;s enough space to align.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a450f9d8af07bfe2f313dbe3a78738a5e">ALIGNMENT</a> &gt; 1)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> += <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a450f9d8af07bfe2f313dbe3a78738a5e">ALIGNMENT</a> + <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a794344346279e2c33cdf963b440693fc">ALIGN_INFO</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// So, ideally, we really want an alignment of 0 or 1 in order</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// to save space.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga8b5670e4594b0b6f8be78fe17f0c3b53">liballoc_lock</a>();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> == 0)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2d9b708c1e8825a6bb6612661bc4bdbd">l_warningCount</a> += 1;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: WARNING: alloc( 0 ) called from %lx\n&quot;</span>,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;               __builtin_return_address(0));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(<a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga5223b5fb1255b5179f53b0595fe9251c">malloc</a>)(1);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: initialization of liballoc &quot;</span> <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a> <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a3f8e43468fdf43b724aa3e47f0d65243">atexit</a>(<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a3a68c0bf75f35813ab63a469d63e34e5">liballoc_dump</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// This is the first time we are being used.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2d00f44b620b913bc15fc92d44dd7c89">allocate_new_page</a>(<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: initial l_memRoot initialization failed\n&quot;</span>, <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: set up first memory major %lx\n&quot;</span>, <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: %lx PREFIX(malloc)( %i ): &quot;</span>,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;           __builtin_return_address(0),</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;           <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Now we need to bounce through every major and find enough space....</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    maj = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    startedBet = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// Start at the best bet....</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        bestSize = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a94315a9fd8d95755437248f20450e9ba">size</a> - <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span> (bestSize &gt; (<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>)))</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            maj = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            startedBet = 1;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">while</span> (maj != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        diff = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a94315a9fd8d95755437248f20450e9ba">size</a> - maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">// free memory in the block</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">if</span> (bestSize &lt; diff)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="comment">// Hmm.. this one has more memory then our bestBet. Remember!</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aa564d1a8832090131b83d62eae1f07d7">l_bestBet</a> = maj;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            bestSize = diff;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#ifdef USE_CASE1</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">// CASE 1:  There is not enough space in this major block.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> (diff &lt; (<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>)))</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;CASE 1: Insufficient space in block %lx\n&quot;</span>, maj);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="comment">// Another major block next to this one?</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                maj = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>; <span class="comment">// Hop to that one.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">if</span> (startedBet == 1) <span class="comment">// If we started at the best bet,</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            {                    <span class="comment">// let&#39;s start all over again.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                maj = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                startedBet = 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="comment">// Create a new major block next to this one and...</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2d00f44b620b913bc15fc92d44dd7c89">allocate_new_page</a>(<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>); <span class="comment">// next one will be okay.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">break</span>; <span class="comment">// no more memory.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac04a8297d249fe04b86ac22d9f4db11e">prev</a> = maj;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            maj = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="comment">// .. fall through to CASE 2 ..</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#ifdef USE_CASE2</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// CASE 2: It&#39;s a brand new block.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a> = (<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)maj + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d6/db9/structliballoc__major">liballoc_major</a>));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> = <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> = <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#aff17c469cb0dcbc1f8320b8342075b1d">block</a> = maj;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a> = <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a> = req_size;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2ce5de2eb7b8595f398caf844a033cb1">l_inuse</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a> = (<span class="keywordtype">void</span> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)(maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>) + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a4d3a4d8ba3325af096e123278cffec04">ALIGN</a>(<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;CASE 2: returning %lx\n&quot;</span>, <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">#ifdef USE_CASE3</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// CASE 3: Block in use and enough space at the start of the block.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        diff = (<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)(maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        diff -= (<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)maj;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        diff -= <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d6/db9/structliballoc__major">liballoc_major</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">if</span> (diff &gt;= (<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>)))</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="comment">// Yes, space in front. Squeeze in.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> = (<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)maj + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d6/db9/structliballoc__major">liballoc_major</a>));</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a> = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> = <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#aff17c469cb0dcbc1f8320b8342075b1d">block</a> = maj;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a> = <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a> = req_size;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2ce5de2eb7b8595f398caf844a033cb1">l_inuse</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a> = (<span class="keywordtype">void</span> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)(maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>) + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>));</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a4d3a4d8ba3325af096e123278cffec04">ALIGN</a>(<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;CASE 3: returning %lx\n&quot;</span>, <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#ifdef USE_CASE4</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">// CASE 4: There is enough space in this block. But is it contiguous?</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        min = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8db150d09474fa68d04b5454eb21ab28">first</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">// Looping within the block now...</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">while</span> (min != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="comment">// CASE 4.1: End of minors in a block. Space from last and end?</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="comment">// the rest of this block is free...  is it big enough?</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                diff = (<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)(maj) + maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a94315a9fd8d95755437248f20450e9ba">size</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                diff -= (<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)min;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                diff -= <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                diff -= min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="comment">// minus already existing usage..</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">if</span> (diff &gt;= (<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>)))</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    <span class="comment">// yay....</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> = (<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)min + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>) + min-&gt;<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> = min;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    min = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> = <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#aff17c469cb0dcbc1f8320b8342075b1d">block</a> = maj;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a> = <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a> = <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2ce5de2eb7b8595f398caf844a033cb1">l_inuse</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a> = (<span class="keywordtype">void</span> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)min + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>));</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a4d3a4d8ba3325af096e123278cffec04">ALIGN</a>(<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;CASE 4.1: returning %lx\n&quot;</span>, <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="comment">// CASE 4.2: Is there space between two minors?</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> != <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="comment">// is the difference between here and next big enough?</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                diff = (<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)(min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                diff -= (<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)min;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                diff -= <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                diff -= min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="comment">// minus our existing usage.</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keywordflow">if</span> (diff &gt;= (<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>)))</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="comment">// yay......</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    new_min = (<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)min + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>) + min-&gt;<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    new_min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    new_min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    new_min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> = min;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    new_min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a138f5528e084fb73761b9a23e106fb4a">size</a> = <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    new_min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a> = <a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    new_min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#aff17c469cb0dcbc1f8320b8342075b1d">block</a> = maj;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a9b88d3a051111df81ecdd3147f4386d9">prev</a> = new_min;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a> = new_min;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ab4d9c00c552e0ddd4997a91966bfc4f4">usage</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2ce5de2eb7b8595f398caf844a033cb1">l_inuse</a> += <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a> = (<span class="keywordtype">void</span> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)new_min + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>));</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a4d3a4d8ba3325af096e123278cffec04">ALIGN</a>(<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;CASE 4.2: returning %lx\n&quot;</span>, <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            } <span class="comment">// min-&gt;next != NULL</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            min = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a8bb10f7f3cf052b617c718367bf0a095">next</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        } <span class="comment">// while min != NULL ...</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#ifdef USE_CASE5</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">// CASE 5: Block full! Ensure next block and loop.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;CASE 5: block full\n&quot;</span>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordflow">if</span> (startedBet == 1)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                maj = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a650715799a325fedc4d7b07a181378d9">l_memRoot</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                startedBet = 0;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="comment">// we&#39;ve run out. we need more...</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> = <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2d00f44b620b913bc15fc92d44dd7c89">allocate_new_page</a>(<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>); <span class="comment">// next one guaranteed to be okay</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">if</span> (maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="keywordflow">break</span>; <span class="comment">//  uh oh,  no more memory.....</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#ac04a8297d249fe04b86ac22d9f4db11e">prev</a> = maj;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        maj = maj-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a4a147f5e1587d20f79184a9ec731e7cf">next</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    } <span class="comment">// while (maj != NULL)</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#ifdef LIBALLOCDEBUG</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;All cases exhausted. No memory available.\n&quot;</span>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: WARNING: PREFIX(malloc)( %i ) returning NULL.\n&quot;</span>, <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a3a68c0bf75f35813ab63a469d63e34e5">liballoc_dump</a>();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a1c6d5de492ac61ad29aec7aa9a436bbf"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a></div><div class="ttdeci">#define VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00005">liballoc_1_1.c:5</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a2d00f44b620b913bc15fc92d44dd7c89"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a2d00f44b620b913bc15fc92d44dd7c89">allocate_new_page</a></div><div class="ttdeci">static struct liballoc_major * allocate_new_page(unsigned int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00177">liballoc_1_1.c:177</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a3a68c0bf75f35813ab63a469d63e34e5"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a3a68c0bf75f35813ab63a469d63e34e5">liballoc_dump</a></div><div class="ttdeci">static void liballoc_dump()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00136">liballoc_1_1.c:136</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a3f8e43468fdf43b724aa3e47f0d65243"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a3f8e43468fdf43b724aa3e47f0d65243">atexit</a></div><div class="ttdeci">#define atexit(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00056">liballoc_1_1.c:56</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a450f9d8af07bfe2f313dbe3a78738a5e"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a450f9d8af07bfe2f313dbe3a78738a5e">ALIGNMENT</a></div><div class="ttdeci">#define ALIGNMENT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00006">liballoc_1_1.c:6</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a4d3a4d8ba3325af096e123278cffec04"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a4d3a4d8ba3325af096e123278cffec04">ALIGN</a></div><div class="ttdeci">#define ALIGN(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00018">liballoc_1_1.c:18</a></div></div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a794344346279e2c33cdf963b440693fc"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a794344346279e2c33cdf963b440693fc">ALIGN_INFO</a></div><div class="ttdeci">#define ALIGN_INFO</div><div class="ttdoc">Alignment information is stored right before the pointer. This is the number of bytes of information ...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00009">liballoc_1_1.c:9</a></div></div>
<div class="ttc" id="aUserspace_2libc_2src_2mem_2liballoc__1__1_8c_html_a0e798303ee8177899564e567fea41d3f"><div class="ttname"><a href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">liballoc_minor::req_size</a></div><div class="ttdeci">unsigned int req_size</div><div class="ttdoc">The size of memory requested.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00085">liballoc_1_1.c:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gadc710223dc26577d1e49cac212d7d083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadc710223dc26577d1e49cac212d7d083">&#9670;&nbsp;</a></span>realloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* <a class="el" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>() realloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/df4/Kernel_2include_2types_8h.html#a1ea04414b0c81c2aef4d8da70f264aad">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="../../d8/d54/Kernel_2Library_2liballoc__1__1_8h.html">Kernel/Library/liballoc_1_1.h</a>&gt;</code></p>

<p>The standard function. </p>

<p class="definition">Definition at line <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00700">700</a> of file <a class="el" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html">liballoc_1_1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">void</span> *ptr;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *min;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> real_size;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">// Honour the case of size == 0 =&gt; free old and return NULL</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a> == 0)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(<a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga4835fe140973dbc5e1aafd9c33acf6d4">free</a>)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        (<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// In the case of a NULL pointer, return a simple malloc.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a> == <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(<a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga5223b5fb1255b5179f53b0595fe9251c">malloc</a>)(<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">// Unalign the pointer if required.</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    ptr = <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a1c35d927b46457b91f58e659890008c1">UNALIGN</a>(ptr);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga8b5670e4594b0b6f8be78fe17f0c3b53">liballoc_lock</a>(); <span class="comment">// lockit</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    min = (<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a> *)((<a class="code" href="../../d0/df4/Kernel_2include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)ptr - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#d7/d3e/structliballoc__minor">liballoc_minor</a>));</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">// Ensure it is a valid structure.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> != <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af83e911f592858658db8dba2a74f5772">l_errorCount</a> += 1;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="comment">// Check for overrun errors. For all bytes of LIBALLOC_MAGIC</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            ((min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> &amp; 0xFFFFFF) == (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a> &amp; 0xFFFFFF)) ||</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            ((min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> &amp; 0xFFFF) == (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a> &amp; 0xFFFF)) ||</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            ((min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> &amp; 0xFF) == (<a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a> &amp; 0xFF)))</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a48c2c6cb4bd97dd911ef24ff2a42ca5d">l_possibleOverruns</a> += 1;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: ERROR: Possible 1-3 byte overrun for magic %lx != %lx\n&quot;</span>,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                   min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a>,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                   <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#af6b1d459ffa3c81e2456acf8d4268330">LIBALLOC_MAGIC</a>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">if</span> (min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a2a521ac1721a7b39baf53f995e0fcccf">magic</a> == <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#aae1f702e677fee87387d8086e751f8b3">LIBALLOC_DEAD</a>)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: ERROR: multiple PREFIX(free)() attempt on %lx from %lx.\n&quot;</span>,</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                   ptr,</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                   __builtin_return_address(0));</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">#if defined LIBALLOCDEBUG || defined LIBALLOCINFO</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ae34a762828cbff7cce62bda6571b2bc0">printf</a>(<span class="stringliteral">&quot;liballoc: ERROR: Bad PREFIX(free)( %lx ) called from %lx\n&quot;</span>,</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                   ptr,</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                   __builtin_return_address(0));</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#ad7ca11d555f526a6c553f150b898c0d8">FLUSH</a>();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="comment">// being lied to...</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>(); <span class="comment">// release the lock</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/dc7/stdlib-stubs_8cpp.html#a9578bf94fd913a1b19c44c1213156cf2">NULL</a>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">// Definitely a memory block.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    real_size = min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (real_size &gt;= <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        min-&gt;<a class="code" href="../../dc/db6/Userspace_2libc_2src_2mem_2liballoc__1__1_8c.html#a0e798303ee8177899564e567fea41d3f">req_size</a> = <a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>();</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#gaedc23f198b2882d41d0caa316453967b">liballoc_unlock</a>();</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// If we got here then we&#39;re reallocating to a block bigger than us.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    ptr = <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(<a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga5223b5fb1255b5179f53b0595fe9251c">malloc</a>)(<a class="code" href="../../d4/d6d/string-stubs_8cpp.html#a252e4787d2e315cb28693ef2d9862e78">size</a>); <span class="comment">// We need to allocate new memory</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a58b3101a659b6a2f7e2ca290bef6bfb4">liballoc_memcpy</a>(ptr, <a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>, real_size);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga397816ee230d64fe081f93d31bf5a534">PREFIX</a>(<a class="code" href="../../d8/dc8/group__ALLOCHOOKS.html#ga4835fe140973dbc5e1aafd9c33acf6d4">free</a>)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    (<a class="code" href="../../d6/d23/wi__stuff_8c.html#a5f53dec9fe800012c2be6ab5167d2cfd">p</a>);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">return</span> ptr;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div>
<div class="ttc" id="aKernel_2Library_2liballoc__1__1_8c_html_a58b3101a659b6a2f7e2ca290bef6bfb4"><div class="ttname"><a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c.html#a58b3101a659b6a2f7e2ca290bef6bfb4">liballoc_memcpy</a></div><div class="ttdeci">static void * liballoc_memcpy(void *s1, const void *s2, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00110">liballoc_1_1.c:110</a></div></div>
<div class="ttc" id="agroup__ALLOCHOOKS_html_ga4835fe140973dbc5e1aafd9c33acf6d4"><div class="ttname"><a href="../../d8/dc8/group__ALLOCHOOKS.html#ga4835fe140973dbc5e1aafd9c33acf6d4">free</a></div><div class="ttdeci">void PREFIX() free(void *ptr)</div><div class="ttdoc">The standard function.</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbc/Kernel_2Library_2liballoc__1__1_8c_source.html#l00561">liballoc_1_1.c:561</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
