<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fennix: mlibc is a C standard library</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fennix
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Opeating System from scratch made in C and C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d4a/md_Userspace_mlibc_README.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">mlibc is a C standard library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><img src="https://github.com/managarm/mlibc/workflows/Continuous%20Integration/badge.svg" alt="Continuous Integration" style="pointer-events: none;" class="inline"/></p>
<p><b>Official Discord server:</b> <a href="https://discord.gg/7WB6Ur3">https://discord.gg/7WB6Ur3</a></p>
<p><b>AUR package</b> (provides <code>mlibc-gcc</code>): <a href="https://aur.archlinux.org/packages/mlibc">https://aur.archlinux.org/packages/mlibc</a></p>
<h1><a class="anchor" id="autotoc_md45"></a>
Design of the library</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Directory   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>options/</code>   </td><td class="markdownTableBodyNone">(More or less) OS-independent headers and code.<br  />
<code>options/</code> is divided into subdirectories that can be enabled or disabled by ports.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>sysdeps/</code>   </td><td class="markdownTableBodyNone">OS-specific headers and code.<br  />
<code>sysdeps/</code> is divded into per-port subdirectories. Exactly one of those subdirectories is enabled in each build.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>abis/</code>   </td><td class="markdownTableBodyNone">OS-specific interface headers ("ABI headers"). Those contain the constants and structs of the OS interface. For example, the numerical values of <code>SEEK_SET</code> or <code>O_CREAT</code> live here, as well as structs like <code>struct stat</code>. ABI headers are <em>only</em> allowed to contain constants, structs and unions but <em>no</em> function declarations or logic.<br  />
<code>abis/</code> is divided into per-OS subdirectories but this division is for organizational purposes only. Ports can still mix headers from different <code>abis/</code> subdirectories.   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md46"></a>
Porting mlibc to a new OS</h1>
<p>Ports to new OSes are welcome. To port mlibc to another OS, the following changes need to be made:</p><ol type="1">
<li>Add new <code>sysdeps/</code> subdirectory <code>sysdeps/some-new-os/</code> and a <code>meson.build</code> to compile it. Integreate <code>sysdeps/some-new-os/meson.build</code> into the toplevel <code>meson.build</code>.</li>
<li>Create ABI headers in <code>abis/some-new-os/</code>. Add symlinks in <code>sysdeps/some-new-os/include/abi-bits</code> to your ABI headers. Look at existing ports to figure out the ABI headers required for the options enabled by <code>sysdeps/some-new-os/meson.build</code>.</li>
<li>In <code>sysdeps/some-new-os/</code>, add code to implement (a subset of) the functions from <code><a class="el" href="../../de/d49/internal-sysdeps_8hpp.html">options/internal/include/mlibc/internal-sysdeps.hpp</a></code>. Which subset you need depends on the options that <code>sysdeps/some-new-os/meson.build</code> enables.</li>
</ol>
<p>We recommend that new ports do not build from <code>master</code> as we occasionally make internal changes that cause out-of-tree sysdeps to break. Instead we recommend you pin a specific release (or commit), or to upstream your changes to this repository so that we can build them on our CI and thus any breakages will be fixed by us in-tree.</p>
<h1><a class="anchor" id="autotoc_md48"></a>
Build Configuration</h1>
<p>The following custom meson options are accepted, in addition to the <a href="https://mesonbuild.com/Builtin-options.html">built-in options</a>. The options below are booleans which default to false (see <code>meson_options.txt</code>).</p>
<ul>
<li><code>headers_only</code>: Only install headers; don't build <code>libc.so</code> or <code>ld.so</code>.</li>
<li><code>mlibc_no_headers</code>: Don't install headers; only build <code>libc.so</code> and <code>ld.so</code>.</li>
<li><code>build_tests</code>: Build the test suite (see below).</li>
<li><code>disable_x_option</code>: Disable <code>x</code> component of mlibc functionality. See <code>meson_options.txt</code> for a full list of possible values for <code>x</code>. This may be used to e.g disable POSIX and glibc extensions.</li>
</ul>
<p>The type of library to be built (static, shared, or both) is controlled by meson's <code>default_library</code> option. Passing <code>-Ddefault_library=static</code> effectively disables the dynamic linker.</p>
<p>We also support building with <code>-Db_sanitize=undefined</code> to use UBSan inside mlibc. Note that this does not enable UBSan for external applications which link against <code>libc.so</code>, but it can be useful during development to detect internal bugs (e.g when adding new sysdeps).</p>
<h1><a class="anchor" id="autotoc_md49"></a>
Running Tests</h1>
<p>The <code>mlibc</code> test suite can be run under a Linux host. To do this, first run from the project root: </p><div class="fragment"><div class="line">meson -Dbuild_tests=true build</div>
</div><!-- fragment --><p> This will create a <code>build</code> directory. Then, <code>cd build</code> and run the tests (showing output) with: </p><div class="fragment"><div class="line">meson test -v</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
