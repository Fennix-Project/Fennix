<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fennix: anonymous_namespace{pthread-stubs.cpp} Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fennix
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Opeating System from scratch made in C and C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">anonymous_namespace{pthread-stubs.cpp} Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6b/structanonymous__namespace_02pthread-stubs_8cpp_03_1_1key__global__info.html">key_global_info</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8c9eedd2f66fe2c679478b74396ead50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html#a8c9eedd2f66fe2c679478b74396ead50">sigcancel_handler</a> (<a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a> <a class="el" href="../../d2/d71/mlibc_2options_2ansi_2include_2signal_8h.html#ad7d09f2a17db29d8e4c08e92abcf0860">signal</a>, <a class="el" href="../../d9/df5/mlibc_2sysdeps_2managarm_2include_2abi-bits_2signal_8h.html#dc/dbc/structsiginfo__t">siginfo_t</a> *<a class="el" href="../../db/d16/debug_8h.html#aaef030dcfb502de87e0f47669c58c755">info</a>, void *ucontext)</td></tr>
<tr class="separator:a8c9eedd2f66fe2c679478b74396ead50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e4decb7c706031cf02303fc2c27148c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html#a3e4decb7c706031cf02303fc2c27148c">rwlock_m_lock</a> (<a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#aebf354859b412e164c6aa1a83c602e4a">pthread_rwlock_t</a> *rw, <a class="el" href="../../dd/dfa/Userspace_2libc_2include_2stddef_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> excl)</td></tr>
<tr class="separator:a3e4decb7c706031cf02303fc2c27148c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a86e6499f1a40aa95a7f329b168ffcb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html#a2a86e6499f1a40aa95a7f329b168ffcb">rwlock_m_trylock</a> (<a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#aebf354859b412e164c6aa1a83c602e4a">pthread_rwlock_t</a> *rw, <a class="el" href="../../dd/dfa/Userspace_2libc_2include_2stddef_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> excl)</td></tr>
<tr class="separator:a2a86e6499f1a40aa95a7f329b168ffcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a609e27bd0d638db8928a7c1e8b6738d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html#a609e27bd0d638db8928a7c1e8b6738d1">rwlock_m_unlock</a> (<a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#aebf354859b412e164c6aa1a83c602e4a">pthread_rwlock_t</a> *rw)</td></tr>
<tr class="separator:a609e27bd0d638db8928a7c1e8b6738d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab77384df8bf1451945274a8ee88152bc"><td class="memItemLeft" align="right" valign="top">constinit frg::array&lt; <a class="el" href="../../d0/d6b/structanonymous__namespace_02pthread-stubs_8cpp_03_1_1key__global__info.html">key_global_info</a>, <a class="el" href="../../d4/de2/Userspace_2mlibc_2options_2ansi_2include_2limits_8h.html#a0a23e66e087bcf5c253b9b2746f19a64">PTHREAD_KEYS_MAX</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html#ab77384df8bf1451945274a8ee88152bc">key_globals_</a> {}</td></tr>
<tr class="separator:ab77384df8bf1451945274a8ee88152bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12e23b8b052b5420ad2bd67ffb134ee4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d51/Userspace_2mlibc_2options_2internal_2include_2mlibc_2lock_8hpp.html#a9100eaf38f23188528979126221f4fc1">FutexLock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html#a12e23b8b052b5420ad2bd67ffb134ee4">key_mutex_</a></td></tr>
<tr class="separator:a12e23b8b052b5420ad2bd67ffb134ee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3e4decb7c706031cf02303fc2c27148c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e4decb7c706031cf02303fc2c27148c">&#9670;&nbsp;</a></span>rwlock_m_lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void anonymous_namespace{pthread-stubs.cpp}::rwlock_m_lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#aebf354859b412e164c6aa1a83c602e4a">pthread_rwlock_t</a> *&#160;</td>
          <td class="paramname"><em>rw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dfa/Userspace_2libc_2include_2stddef_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>excl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01431">1431</a> of file <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html">pthread-stubs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                                        {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_expected = __atomic_load_n(&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>, __ATOMIC_RELAXED);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <span class="keywordflow">if</span>(m_expected) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                <a class="code" href="../../dc/dc5/ensure_8h.html#a5e2c6c11947e5c706f6557c5195d90be">__ensure</a>(m_expected &amp; <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#a43f8bea1ae9054e9964fe56916e8ee48">mutex_owner_mask</a>);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                <span class="comment">// Try to set the waiters bit.</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                <span class="keywordflow">if</span>(!(m_expected &amp; <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#ab1955d8fd8a479547f6f5ab63b8d523d">mutex_waiters_bit</a>)) {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> desired = m_expected | <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#ab1955d8fd8a479547f6f5ab63b8d523d">mutex_waiters_bit</a>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                    <span class="keywordflow">if</span>(!__atomic_compare_exchange_n(&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>,</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                            &amp;m_expected, desired, <span class="keyword">false</span>, __ATOMIC_RELAXED, __ATOMIC_RELAXED))</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                <span class="comment">// Wait on the futex.</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                <a class="code" href="../../d0/d9a/namespacemlibc.html#af106c0e80a14f396c3e23de3b88bf484">mlibc::sys_futex_wait</a>((<span class="keywordtype">int</span> *)&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>, m_expected | <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#ab1955d8fd8a479547f6f5ab63b8d523d">mutex_waiters_bit</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                <span class="comment">// Opportunistically try to take the lock after we wake up.</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                m_expected = 0;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                <span class="comment">// Try to lock the mutex.</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> desired = 1;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                <span class="keywordflow">if</span>(excl)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                    desired |= <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#a6dd04ec187bfc7e0582c91dccd2648eb">mutex_excl_bit</a>;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                <span class="keywordflow">if</span>(__atomic_compare_exchange_n(&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                        &amp;m_expected, desired, <span class="keyword">false</span>, __ATOMIC_ACQUIRE, __ATOMIC_RELAXED))</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    }</div>
<div class="ttc" id="aUserspace_2mlibc_2options_2posix_2include_2pthread_8h_html_a4eb4442d36d6e35ab5784ab970852892"><div class="ttname"><a href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_fair_rwlock::__mlibc_m</a></div><div class="ttdeci">unsigned int __mlibc_m</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h_source.html#l00149">pthread.h:149</a></div></div>
<div class="ttc" id="aensure_8h_html_a5e2c6c11947e5c706f6557c5195d90be"><div class="ttname"><a href="../../dc/dc5/ensure_8h.html#a5e2c6c11947e5c706f6557c5195d90be">__ensure</a></div><div class="ttdeci">#define __ensure(assertion)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc5/ensure_8h_source.html#l00019">ensure.h:19</a></div></div>
<div class="ttc" id="anamespacemlibc_html_af106c0e80a14f396c3e23de3b88bf484"><div class="ttname"><a href="../../d0/d9a/namespacemlibc.html#af106c0e80a14f396c3e23de3b88bf484">mlibc::sys_futex_wait</a></div><div class="ttdeci">int sys_futex_wait(int *pointer, int expected, const struct timespec *time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dab/aero_8cpp_source.html#l00075">aero.cpp:75</a></div></div>
<div class="ttc" id="apthread-stubs_8cpp_html_a43f8bea1ae9054e9964fe56916e8ee48"><div class="ttname"><a href="../../df/d80/pthread-stubs_8cpp.html#a43f8bea1ae9054e9964fe56916e8ee48">mutex_owner_mask</a></div><div class="ttdeci">static constexpr unsigned int mutex_owner_mask</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d80/pthread-stubs_8cpp_source.html#l00052">pthread-stubs.cpp:52</a></div></div>
<div class="ttc" id="apthread-stubs_8cpp_html_a6dd04ec187bfc7e0582c91dccd2648eb"><div class="ttname"><a href="../../df/d80/pthread-stubs_8cpp.html#a6dd04ec187bfc7e0582c91dccd2648eb">mutex_excl_bit</a></div><div class="ttdeci">static constexpr unsigned int mutex_excl_bit</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d80/pthread-stubs_8cpp_source.html#l00056">pthread-stubs.cpp:56</a></div></div>
<div class="ttc" id="apthread-stubs_8cpp_html_ab1955d8fd8a479547f6f5ab63b8d523d"><div class="ttname"><a href="../../df/d80/pthread-stubs_8cpp.html#ab1955d8fd8a479547f6f5ab63b8d523d">mutex_waiters_bit</a></div><div class="ttdeci">static constexpr unsigned int mutex_waiters_bit</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d80/pthread-stubs_8cpp_source.html#l00053">pthread-stubs.cpp:53</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/dc5/ensure_8h_source.html#l00019">__ensure</a>, <a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h_source.html#l00149">__mlibc_fair_rwlock::__mlibc_m</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00056">mutex_excl_bit</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00052">mutex_owner_mask</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00053">mutex_waiters_bit</a>, and <a class="el" href="../../d5/dab/aero_8cpp_source.html#l00075">mlibc::sys_futex_wait()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01610">pthread_rwlock_rdlock()</a>, and <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01555">pthread_rwlock_wrlock()</a>.</p>

</div>
</div>
<a id="a2a86e6499f1a40aa95a7f329b168ffcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a86e6499f1a40aa95a7f329b168ffcb">&#9670;&nbsp;</a></span>rwlock_m_trylock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a> anonymous_namespace{pthread-stubs.cpp}::rwlock_m_trylock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#aebf354859b412e164c6aa1a83c602e4a">pthread_rwlock_t</a> *&#160;</td>
          <td class="paramname"><em>rw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dfa/Userspace_2libc_2include_2stddef_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>excl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01462">1462</a> of file <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html">pthread-stubs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                                          {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m_expected = __atomic_load_n(&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>, __ATOMIC_RELAXED);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keywordflow">if</span>(!m_expected) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            <span class="comment">// Try to lock the mutex.</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> desired = 1;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            <span class="keywordflow">if</span>(excl)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                desired |= <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#a6dd04ec187bfc7e0582c91dccd2648eb">mutex_excl_bit</a>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            <span class="keywordflow">if</span>(__atomic_compare_exchange_n(&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>,</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                    &amp;m_expected, desired, <span class="keyword">false</span>, __ATOMIC_ACQUIRE, __ATOMIC_RELAXED))</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <a class="code" href="../../dc/dc5/ensure_8h.html#a5e2c6c11947e5c706f6557c5195d90be">__ensure</a>(m_expected &amp; <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#a43f8bea1ae9054e9964fe56916e8ee48">mutex_owner_mask</a>);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="comment">// POSIX says that this function should never block but also that</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="comment">// readers should not be blocked by readers. We implement this by returning EAGAIN</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="comment">// (and not EBUSY) if a reader would block a reader.</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">if</span>(!excl &amp;&amp; !(m_expected &amp; <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#a6dd04ec187bfc7e0582c91dccd2648eb">mutex_excl_bit</a>))</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d0b/Kernel_2include__std_2errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d0b/Kernel_2include__std_2errno_8h.html#a8368025077a0385849d6817b2007c095">EBUSY</a>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    }</div>
<div class="ttc" id="aKernel_2include__std_2errno_8h_html_a8368025077a0385849d6817b2007c095"><div class="ttname"><a href="../../db/d0b/Kernel_2include__std_2errno_8h.html#a8368025077a0385849d6817b2007c095">EBUSY</a></div><div class="ttdeci">#define EBUSY</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d0b/Kernel_2include__std_2errno_8h_source.html#l00036">errno.h:36</a></div></div>
<div class="ttc" id="aKernel_2include__std_2errno_8h_html_af0fac1cea1165b4debec7f686edf3313"><div class="ttname"><a href="../../db/d0b/Kernel_2include__std_2errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a></div><div class="ttdeci">#define EAGAIN</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d0b/Kernel_2include__std_2errno_8h_source.html#l00031">errno.h:31</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/dc5/ensure_8h_source.html#l00019">__ensure</a>, <a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h_source.html#l00149">__mlibc_fair_rwlock::__mlibc_m</a>, <a class="el" href="../../db/d0b/Kernel_2include__std_2errno_8h_source.html#l00031">EAGAIN</a>, <a class="el" href="../../db/d0b/Kernel_2include__std_2errno_8h_source.html#l00036">EBUSY</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00056">mutex_excl_bit</a>, and <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00052">mutex_owner_mask</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01593">pthread_rwlock_tryrdlock()</a>, and <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01532">pthread_rwlock_trywrlock()</a>.</p>

</div>
</div>
<a id="a609e27bd0d638db8928a7c1e8b6738d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a609e27bd0d638db8928a7c1e8b6738d1">&#9670;&nbsp;</a></span>rwlock_m_unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void anonymous_namespace{pthread-stubs.cpp}::rwlock_m_unlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#aebf354859b412e164c6aa1a83c602e4a">pthread_rwlock_t</a> *&#160;</td>
          <td class="paramname"><em>rw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01485">1485</a> of file <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html">pthread-stubs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                                               {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keyword">auto</span> m = __atomic_exchange_n(&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>, 0, __ATOMIC_RELEASE);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keywordflow">if</span>(m &amp; <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#ab1955d8fd8a479547f6f5ab63b8d523d">mutex_waiters_bit</a>)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            <a class="code" href="../../d0/d9a/namespacemlibc.html#a63eca38570144ebc2a0621130e56edff">mlibc::sys_futex_wake</a>((<span class="keywordtype">int</span> *)&amp;rw-&gt;<a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a4eb4442d36d6e35ab5784ab970852892">__mlibc_m</a>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }</div>
<div class="ttc" id="anamespacemlibc_html_a63eca38570144ebc2a0621130e56edff"><div class="ttname"><a href="../../d0/d9a/namespacemlibc.html#a63eca38570144ebc2a0621130e56edff">mlibc::sys_futex_wake</a></div><div class="ttdeci">int sys_futex_wake(int *pointer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dab/aero_8cpp_source.html#l00085">aero.cpp:85</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h_source.html#l00149">__mlibc_fair_rwlock::__mlibc_m</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00053">mutex_waiters_bit</a>, and <a class="el" href="../../d5/dab/aero_8cpp_source.html#l00085">mlibc::sys_futex_wake()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01610">pthread_rwlock_rdlock()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01593">pthread_rwlock_tryrdlock()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01532">pthread_rwlock_trywrlock()</a>, and <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l01626">pthread_rwlock_unlock()</a>.</p>

</div>
</div>
<a id="a8c9eedd2f66fe2c679478b74396ead50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c9eedd2f66fe2c679478b74396ead50">&#9670;&nbsp;</a></span>sigcancel_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void anonymous_namespace{pthread-stubs.cpp}::sigcancel_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dc0/stdio-stubs_8cpp.html#aaa75541e343d22996cdea3175072626b">int</a>&#160;</td>
          <td class="paramname"><em>signal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/df5/mlibc_2sysdeps_2managarm_2include_2abi-bits_2signal_8h.html#dc/dbc/structsiginfo__t">siginfo_t</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ucontext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00557">557</a> of file <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html">pthread-stubs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                                        {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        ucontext_t *uctx = <span class="keyword">static_cast&lt;</span>ucontext_t*<span class="keyword">&gt;</span>(ucontext);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="comment">// The function could be called from other signals, or from another</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// process, in which case we should do nothing.</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../de/d45/signal-stubs_8cpp.html#a109dbb7ab6f71bc59aafe3b467815daf">signal</a> != <a class="code" href="../../d3/d36/mlibc_2abis_2linux_2signal_8h.html#ad34ee8c0ffb034a8b28d25b8844b85f7">SIGCANCEL</a> || <a class="code" href="../../db/d16/debug_8h.html#aaef030dcfb502de87e0f47669c58c755">info</a>-&gt;si_pid != <a class="code" href="../../dd/d08/unistd-stubs_8cpp.html#ac61b207337ca21b3b309593fd1a0cb82">getpid</a>() ||</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#aaef030dcfb502de87e0f47669c58c755">info</a>-&gt;si_code != <a class="code" href="../../d3/d36/mlibc_2abis_2linux_2signal_8h.html#a125a3cab75965acdf3ec03578a47ddf0">SI_TKILL</a>)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keyword">auto</span> tcb = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="../../d7/d1e/tcb_8hpp.html#d5/d87/structTcb">Tcb</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../d0/d9a/namespacemlibc.html#a565bc126d9b32c133207ad49c9598f4d">mlibc::get_current_tcb</a>());</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordtype">int</span> old_value = tcb-&gt;<a class="code" href="../../d7/d1e/tcb_8hpp.html#aa4c7f94cb9d9dccbcd636fb97c08dd76">cancelBits</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">         * When a thread is marked with deferred cancellation and performs a blocking syscall,</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">         * the spec mandates that the syscall can get interrupted before it has caused any side</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">         * effects (e.g. before a read() has read any bytes from disk). If the syscall has</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">         * already caused side effects it should return its partial work, and set the program</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">         * counter just after the syscall. If the syscall hasn&#39;t caused any side effects, it</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">         * should fail with EINTR and set the program counter to the syscall instruction.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">         *  cancellable_syscall:</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">         *      test whether_a_cancel_is_queued</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">         *      je cancel</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">         *      syscall</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">         *  end_cancellable_syscall</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">         * The mlibc::sys_before_cancellable_syscall sysdep should return 1 when the</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">         * program counter is between the &#39;canellable_syscall&#39; and &#39;end_cancellable_syscall&#39; label.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">if</span> (!(old_value &amp; <a class="code" href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#a6fdf046377e5d40d1be2fe67bec67ed3">tcbCancelAsyncBit</a>) &amp;&amp;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <a class="code" href="../../d0/d9a/namespacemlibc.html#a3e8a6e973778afe8098abbafa4b1c9e3">mlibc::sys_before_cancellable_syscall</a> &amp;&amp; !<a class="code" href="../../d0/d9a/namespacemlibc.html#a3e8a6e973778afe8098abbafa4b1c9e3">mlibc::sys_before_cancellable_syscall</a>(uctx))</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordtype">int</span> bitmask = <a class="code" href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#a7e1333c0737dea9bce72563ee2e53340">tcbCancelTriggerBit</a> | <a class="code" href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#a60c9f5818208c3f001a5950d12928e6b">tcbCancelingBit</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordtype">int</span> new_value = old_value | bitmask;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="comment">// Check if we are already cancelled or exiting</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">if</span> (old_value == new_value || old_value &amp; <a class="code" href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#ab2f619df7025325ec473225a2c6d9db0">tcbExitingBit</a>)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordtype">int</span> current_value = old_value;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keywordflow">if</span> (__atomic_compare_exchange_n(&amp;tcb-&gt;cancelBits, &amp;current_value,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                        new_value, <span class="keyword">true</span>,__ATOMIC_RELAXED, __ATOMIC_RELAXED)) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                tcb-&gt;returnValue = <a class="code" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a17ddda04a6c1ee32116c49c85e2ac4ae">PTHREAD_CANCELED</a>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <span class="comment">// Perform cancellation</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                <a class="code" href="../../df/d80/pthread-stubs_8cpp.html#af0b97a581dab04b417e8463f78f41c0c">__mlibc_do_cancel</a>();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            old_value = current_value;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="ttc" id="aUserspace_2mlibc_2options_2posix_2include_2pthread_8h_html_a17ddda04a6c1ee32116c49c85e2ac4ae"><div class="ttname"><a href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h.html#a17ddda04a6c1ee32116c49c85e2ac4ae">PTHREAD_CANCELED</a></div><div class="ttdeci">#define PTHREAD_CANCELED</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h_source.html#l00066">pthread.h:66</a></div></div>
<div class="ttc" id="adebug_8h_html_aaef030dcfb502de87e0f47669c58c755"><div class="ttname"><a href="../../db/d16/debug_8h.html#aaef030dcfb502de87e0f47669c58c755">info</a></div><div class="ttdeci">#define info(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00088">debug.h:88</a></div></div>
<div class="ttc" id="amlibc_2abis_2linux_2signal_8h_html_a125a3cab75965acdf3ec03578a47ddf0"><div class="ttname"><a href="../../d3/d36/mlibc_2abis_2linux_2signal_8h.html#a125a3cab75965acdf3ec03578a47ddf0">SI_TKILL</a></div><div class="ttdeci">#define SI_TKILL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d36/mlibc_2abis_2linux_2signal_8h_source.html#l00189">signal.h:189</a></div></div>
<div class="ttc" id="amlibc_2abis_2linux_2signal_8h_html_ad34ee8c0ffb034a8b28d25b8844b85f7"><div class="ttname"><a href="../../d3/d36/mlibc_2abis_2linux_2signal_8h.html#ad34ee8c0ffb034a8b28d25b8844b85f7">SIGCANCEL</a></div><div class="ttdeci">#define SIGCANCEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d36/mlibc_2abis_2linux_2signal_8h_source.html#l00149">signal.h:149</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02tcb_8hpp_03_html_a60c9f5818208c3f001a5950d12928e6b"><div class="ttname"><a href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#a60c9f5818208c3f001a5950d12928e6b">anonymous_namespace{tcb.hpp}::tcbCancelingBit</a></div><div class="ttdeci">constexpr unsigned int tcbCancelingBit</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1e/tcb_8hpp_source.html#l00042">tcb.hpp:42</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02tcb_8hpp_03_html_a6fdf046377e5d40d1be2fe67bec67ed3"><div class="ttname"><a href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#a6fdf046377e5d40d1be2fe67bec67ed3">anonymous_namespace{tcb.hpp}::tcbCancelAsyncBit</a></div><div class="ttdeci">constexpr unsigned int tcbCancelAsyncBit</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1e/tcb_8hpp_source.html#l00038">tcb.hpp:38</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02tcb_8hpp_03_html_a7e1333c0737dea9bce72563ee2e53340"><div class="ttname"><a href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#a7e1333c0737dea9bce72563ee2e53340">anonymous_namespace{tcb.hpp}::tcbCancelTriggerBit</a></div><div class="ttdeci">constexpr unsigned int tcbCancelTriggerBit</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1e/tcb_8hpp_source.html#l00040">tcb.hpp:40</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02tcb_8hpp_03_html_ab2f619df7025325ec473225a2c6d9db0"><div class="ttname"><a href="../../d2/deb/namespaceanonymous__namespace_02tcb_8hpp_03.html#ab2f619df7025325ec473225a2c6d9db0">anonymous_namespace{tcb.hpp}::tcbExitingBit</a></div><div class="ttdeci">constexpr unsigned int tcbExitingBit</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1e/tcb_8hpp_source.html#l00044">tcb.hpp:44</a></div></div>
<div class="ttc" id="anamespacemlibc_html_a3e8a6e973778afe8098abbafa4b1c9e3"><div class="ttname"><a href="../../d0/d9a/namespacemlibc.html#a3e8a6e973778afe8098abbafa4b1c9e3">mlibc::sys_before_cancellable_syscall</a></div><div class="ttdeci">int sys_before_cancellable_syscall(ucontext_t *uctx)</div></div>
<div class="ttc" id="anamespacemlibc_html_a565bc126d9b32c133207ad49c9598f4d"><div class="ttname"><a href="../../d0/d9a/namespacemlibc.html#a565bc126d9b32c133207ad49c9598f4d">mlibc::get_current_tcb</a></div><div class="ttdeci">Tcb * get_current_tcb()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d65/aarch64-include_2mlibc_2thread_8hpp_source.html#l00008">thread.hpp:8</a></div></div>
<div class="ttc" id="apthread-stubs_8cpp_html_af0b97a581dab04b417e8463f78f41c0c"><div class="ttname"><a href="../../df/d80/pthread-stubs_8cpp.html#af0b97a581dab04b417e8463f78f41c0c">__mlibc_do_cancel</a></div><div class="ttdeci">void __mlibc_do_cancel()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d80/pthread-stubs_8cpp_source.html#l00550">pthread-stubs.cpp:550</a></div></div>
<div class="ttc" id="asignal-stubs_8cpp_html_a109dbb7ab6f71bc59aafe3b467815daf"><div class="ttname"><a href="../../de/d45/signal-stubs_8cpp.html#a109dbb7ab6f71bc59aafe3b467815daf">signal</a></div><div class="ttdeci">__sighandler signal(int sn, __sighandler handler)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d45/signal-stubs_8cpp_source.html#l00009">signal-stubs.cpp:9</a></div></div>
<div class="ttc" id="atcb_8hpp_html_aa4c7f94cb9d9dccbcd636fb97c08dd76"><div class="ttname"><a href="../../d7/d1e/tcb_8hpp.html#aa4c7f94cb9d9dccbcd636fb97c08dd76">Tcb::cancelBits</a></div><div class="ttdeci">int cancelBits</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1e/tcb_8hpp_source.html#l00090">tcb.hpp:90</a></div></div>
<div class="ttc" id="atcb_8hpp_html_d5/d87/structTcb"><div class="ttname"><a href="../../d7/d1e/tcb_8hpp.html#d5/d87/structTcb">Tcb</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1e/tcb_8hpp_source.html#l00082">tcb.hpp:82</a></div></div>
<div class="ttc" id="aunistd-stubs_8cpp_html_ac61b207337ca21b3b309593fd1a0cb82"><div class="ttname"><a href="../../dd/d08/unistd-stubs_8cpp.html#ac61b207337ca21b3b309593fd1a0cb82">getpid</a></div><div class="ttdeci">pid_t getpid(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/unistd-stubs_8cpp_source.html#l01067">unistd-stubs.cpp:1067</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00550">__mlibc_do_cancel()</a>, <a class="el" href="../../d7/d1e/tcb_8hpp_source.html#l00090">Tcb::cancelBits</a>, <a class="el" href="../../de/d65/aarch64-include_2mlibc_2thread_8hpp_source.html#l00008">mlibc::get_current_tcb()</a>, <a class="el" href="../../dd/d08/unistd-stubs_8cpp_source.html#l01067">getpid()</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00088">info</a>, <a class="el" href="../../dd/d8b/Userspace_2mlibc_2options_2posix_2include_2pthread_8h_source.html#l00066">PTHREAD_CANCELED</a>, <a class="el" href="../../d3/d36/mlibc_2abis_2linux_2signal_8h_source.html#l00189">SI_TKILL</a>, <a class="el" href="../../d3/d36/mlibc_2abis_2linux_2signal_8h_source.html#l00149">SIGCANCEL</a>, <a class="el" href="../../de/d45/signal-stubs_8cpp_source.html#l00009">signal()</a>, <a class="el" href="../../d0/d9a/namespacemlibc.html#a3e8a6e973778afe8098abbafa4b1c9e3">mlibc::sys_before_cancellable_syscall()</a>, <a class="el" href="../../d7/d1e/tcb_8hpp_source.html#l00038">anonymous_namespace{tcb.hpp}::tcbCancelAsyncBit</a>, <a class="el" href="../../d7/d1e/tcb_8hpp_source.html#l00042">anonymous_namespace{tcb.hpp}::tcbCancelingBit</a>, <a class="el" href="../../d7/d1e/tcb_8hpp_source.html#l00040">anonymous_namespace{tcb.hpp}::tcbCancelTriggerBit</a>, and <a class="el" href="../../d7/d1e/tcb_8hpp_source.html#l00044">anonymous_namespace{tcb.hpp}::tcbExitingBit</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00617">mlibc::anonymous_namespace{pthread-stubs.cpp}::PthreadSignalInstaller::PthreadSignalInstaller()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab77384df8bf1451945274a8ee88152bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab77384df8bf1451945274a8ee88152bc">&#9670;&nbsp;</a></span>key_globals_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constinit frg::array&lt; <a class="el" href="../../d0/d6b/structanonymous__namespace_02pthread-stubs_8cpp_03_1_1key__global__info.html">key_global_info</a>, <a class="el" href="../../d4/de2/Userspace_2mlibc_2options_2ansi_2include_2limits_8h.html#a0a23e66e087bcf5c253b9b2746f19a64">PTHREAD_KEYS_MAX</a> &gt; anonymous_namespace{pthread-stubs.cpp}::key_globals_ {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00392">392</a> of file <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html">pthread-stubs.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00397">pthread_exit()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00834">pthread_getspecific()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00795">pthread_key_create()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00819">pthread_key_delete()</a>, and <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00851">pthread_setspecific()</a>.</p>

</div>
</div>
<a id="a12e23b8b052b5420ad2bd67ffb134ee4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12e23b8b052b5420ad2bd67ffb134ee4">&#9670;&nbsp;</a></span>key_mutex_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d51/Userspace_2mlibc_2options_2internal_2include_2mlibc_2lock_8hpp.html#a9100eaf38f23188528979126221f4fc1">FutexLock</a> anonymous_namespace{pthread-stubs.cpp}::key_mutex_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00394">394</a> of file <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html">pthread-stubs.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00397">pthread_exit()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00834">pthread_getspecific()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00795">pthread_key_create()</a>, <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00819">pthread_key_delete()</a>, and <a class="el" href="../../df/d80/pthread-stubs_8cpp_source.html#l00851">pthread_setspecific()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d6/dba/namespaceanonymous__namespace_02pthread-stubs_8cpp_03.html">anonymous_namespace{pthread-stubs.cpp}</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
