<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fennix Kernel: Kernel/syscalls/native.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fennix Kernel
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Opeating System from scratch made in C and C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('db/d9b/native_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">native.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="../../d0/d35/syscalls_8hpp_source.html">syscalls.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../da/d3e/memory_8hpp_source.html">memory.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d0/d44/lock_8hpp_source.html">lock.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d2/d83/exec_8hpp_source.html">exec.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d8/dc2/errno_8h_source.html">errno.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../db/d16/debug_8h_source.html">debug.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d6e/syscalls_8h_source.html">../syscalls.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/daa/kernel_8h_source.html">../kernel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d24/ipc_8h_source.html">../ipc.h</a>&quot;</code><br />
</div>
<p><a href="../../db/d9b/native_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:d9/df1/structSyscallData"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#d9/df1/structSyscallData">SyscallData</a></td></tr>
<tr class="separator:d9/df1/structSyscallData"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa07f2f09156b7539a5c1bb0a7334ddeb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a>&#160;&#160;&#160;<a class="el" href="../../d0/d35/syscalls_8hpp.html#d3/d19/structSyscallsFrame">SyscallsFrame</a></td></tr>
<tr class="separator:aa07f2f09156b7539a5c1bb0a7334ddeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6846f41615da17d2822b4b3f3681d9f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a6846f41615da17d2822b4b3f3681d9f8">sys_exit</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, int status)</td></tr>
<tr class="separator:a6846f41615da17d2822b4b3f3681d9f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58034984a45861a08ce4bb47c7a08bc4"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a58034984a45861a08ce4bb47c7a08bc4">sys_mmap</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, void *<a class="el" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>, <a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a> <a class="el" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>, int prot, int flags, int fildes, off_t off)</td></tr>
<tr class="separator:a58034984a45861a08ce4bb47c7a08bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eecd781ac5acf16e8e86924330f7f70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a2eecd781ac5acf16e8e86924330f7f70">sys_munmap</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, void *<a class="el" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>, <a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a> <a class="el" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>)</td></tr>
<tr class="separator:a2eecd781ac5acf16e8e86924330f7f70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff752f52722a3727d1aee511528b3763"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#aff752f52722a3727d1aee511528b3763">sys_mprotect</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, void *<a class="el" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>, <a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a> <a class="el" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>, int prot)</td></tr>
<tr class="separator:aff752f52722a3727d1aee511528b3763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6632640eb1e66820fa37e8219837c416"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a6632640eb1e66820fa37e8219837c416">sys_open</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, const char *path, int oflag, mode_t mode)</td></tr>
<tr class="separator:a6632640eb1e66820fa37e8219837c416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f8e5386a39dd1ecdc195c524ac54440"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a7f8e5386a39dd1ecdc195c524ac54440">sys_close</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, int fildes)</td></tr>
<tr class="separator:a7f8e5386a39dd1ecdc195c524ac54440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45f77fe8dfff12944b7ef34337aea91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/de6/include_2types_8h.html#af10f4c58d91a6fa30ccc8a19d0ecbf48">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#ad45f77fe8dfff12944b7ef34337aea91">sys_read</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, int fildes, void *buf, <a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a> nbyte)</td></tr>
<tr class="separator:ad45f77fe8dfff12944b7ef34337aea91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4a3608f72457813a7c58a2bd1218ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/de6/include_2types_8h.html#af10f4c58d91a6fa30ccc8a19d0ecbf48">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a2f4a3608f72457813a7c58a2bd1218ef">sys_write</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, int fildes, const void *buf, <a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a> nbyte)</td></tr>
<tr class="separator:a2f4a3608f72457813a7c58a2bd1218ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41eb960b68f3028de8e945c3a0229b4"><td class="memItemLeft" align="right" valign="top">off_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#aa41eb960b68f3028de8e945c3a0229b4">sys_lseek</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, int fildes, off_t offset, int whence)</td></tr>
<tr class="separator:aa41eb960b68f3028de8e945c3a0229b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22db9f9fb39908fcf90c3e881e4aaffa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a22db9f9fb39908fcf90c3e881e4aaffa">sys_fork</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *Frame)</td></tr>
<tr class="separator:a22db9f9fb39908fcf90c3e881e4aaffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a938b5ce7b58a561df89fdd87f6b8ac52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a938b5ce7b58a561df89fdd87f6b8ac52">HandleNativeSyscalls</a> (<a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *Frame)</td></tr>
<tr class="separator:a938b5ce7b58a561df89fdd87f6b8ac52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a73cb68c5a3b86c353d7eb8eb1cca8d91"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../db/d9b/native_8cpp.html#d9/df1/structSyscallData">SyscallData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/native_8cpp.html#a73cb68c5a3b86c353d7eb8eb1cca8d91">NativeSyscallsTable</a> [<a class="el" href="../../d2/d6e/syscalls_8h.html#a7646da588c70d4a6c38c0e3cef328fceaaa242cd5082bf1fb09de8900c75f6c1b">sc_MaxSyscall</a>]</td></tr>
<tr class="separator:a73cb68c5a3b86c353d7eb8eb1cca8d91"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="d9/df1/structSyscallData" id="d9/df1/structSyscallData"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d9/df1/structSyscallData">&#9670;&nbsp;</a></span>SyscallData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SyscallData</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d1/dd4/linux_8cpp_source.html#l00026">26</a> of file <a class="el" href="../../d1/dd4/linux_8cpp_source.html">linux.cpp</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a7e7f056a3d1194a6cf2b7e8d706fedbe"></a>void *</td>
<td class="fieldname">
Handler</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a78ba64e0086364f774ae6a0b5a76768d"></a>const char *</td>
<td class="fieldname">
Name</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8fb161011abf5426e3073021c59ce44d"></a>int</td>
<td class="fieldname">
RequiredID</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa07f2f09156b7539a5c1bb0a7334ddeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa07f2f09156b7539a5c1bb0a7334ddeb">&#9670;&nbsp;</a></span>SysFrm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SysFrm&#160;&#160;&#160;<a class="el" href="../../d0/d35/syscalls_8hpp.html#d3/d19/structSyscallsFrame">SyscallsFrame</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d9b/native_8cpp_source.html#l00045">45</a> of file <a class="el" href="../../db/d9b/native_8cpp_source.html">native.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a938b5ce7b58a561df89fdd87f6b8ac52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a938b5ce7b58a561df89fdd87f6b8ac52">&#9670;&nbsp;</a></span>HandleNativeSyscalls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> HandleNativeSyscalls </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname"><em>Frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d9b/native_8cpp_source.html#l00139">139</a> of file <a class="el" href="../../db/d9b/native_8cpp_source.html">native.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#if defined(a64)</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(Frame-&gt;rax &gt; <a class="code" href="../../d2/d6e/syscalls_8h.html#a7646da588c70d4a6c38c0e3cef328fceaaa242cd5082bf1fb09de8900c75f6c1b">sc_MaxSyscall</a>))</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;Syscall %ld not implemented.&quot;</span>, Frame-&gt;rax);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../db/d9b/native_8cpp.html#d9/df1/structSyscallData">SyscallData</a> Syscall = <a class="code" href="../../db/d9b/native_8cpp.html#a73cb68c5a3b86c353d7eb8eb1cca8d91">NativeSyscallsTable</a>[Frame-&gt;rax];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> (*call)(<a class="code" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>, ...) =</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        r_cst(<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(*)(<a class="code" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>, ...),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;              Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a7e7f056a3d1194a6cf2b7e8d706fedbe">Handler</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(!call))</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Syscall %s(%d) not implemented.&quot;</span>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;              Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>, Frame-&gt;rax);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">int</span> euid = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;Security.Effective.UserID;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">int</span> egid = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;Security.Effective.GroupID;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">int</span> reqID = Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a8fb161011abf5426e3073021c59ce44d">RequiredID</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (euid &gt; reqID || egid &gt; reqID)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a1d297376472cc7f4ad7c70327efa7b55">warn</a>(<span class="stringliteral">&quot;Process %s(%d) tried to access a system call \&quot;%s\&quot; with insufficient privileges.&quot;</span>,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;             <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;Name, <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;ID, Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Required: %d; Effective u:%d, g:%d&quot;</span>, reqID, euid, egid);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#add669d31505a077f769cff8e66c780b3">EPERM</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;&gt; [%d:\&quot;%s\&quot;]( %#lx  %#lx  %#lx  %#lx  %#lx  %#lx )&quot;</span>,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          Frame-&gt;rax, Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          Frame-&gt;rdi, Frame-&gt;rsi, Frame-&gt;rdx,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          Frame-&gt;r10, Frame-&gt;r8, Frame-&gt;r9);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">long</span> sc_ret = call(Frame,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                       Frame-&gt;rdi, Frame-&gt;rsi, Frame-&gt;rdx,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                       Frame-&gt;r10, Frame-&gt;r8, Frame-&gt;r9);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;&lt; [%d:\&quot;%s\&quot;] = %d&quot;</span>,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          Frame-&gt;rax, Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>, sc_ret);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> sc_ret;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(Frame-&gt;eax &gt; <a class="code" href="../../d2/d6e/syscalls_8h.html#a7646da588c70d4a6c38c0e3cef328fceaaa242cd5082bf1fb09de8900c75f6c1b">sc_MaxSyscall</a>))</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;Syscall %ld not implemented.&quot;</span>, Frame-&gt;eax);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="../../db/d9b/native_8cpp.html#d9/df1/structSyscallData">SyscallData</a> Syscall = <a class="code" href="../../db/d9b/native_8cpp.html#a73cb68c5a3b86c353d7eb8eb1cca8d91">NativeSyscallsTable</a>[Frame-&gt;eax];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> (*call)(<a class="code" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>, ...) =</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        r_cst(<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(*)(<a class="code" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *, <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>, ...),</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;              Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a7e7f056a3d1194a6cf2b7e8d706fedbe">Handler</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(!call))</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Syscall %s(%d) not implemented.&quot;</span>,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;              Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>, Frame-&gt;eax);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">int</span> euid = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;Security.Effective.UserID;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">int</span> egid = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;Security.Effective.GroupID;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">int</span> reqID = Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a8fb161011abf5426e3073021c59ce44d">RequiredID</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (euid &gt; reqID || egid &gt; reqID)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a1d297376472cc7f4ad7c70327efa7b55">warn</a>(<span class="stringliteral">&quot;Process %s(%d) tried to access a system call \&quot;%s\&quot; with insufficient privileges.&quot;</span>,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;             <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;Name, <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>-&gt;ID, Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Required: %d; Effective u:%d, g:%d&quot;</span>, reqID, euid, egid);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#add669d31505a077f769cff8e66c780b3">EPERM</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;&gt; [%d:\&quot;%s\&quot;]( %#x  %#x  %#x  %#x  %#x  %#x )&quot;</span>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          Frame-&gt;eax, Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          Frame-&gt;ebx, Frame-&gt;ecx, Frame-&gt;edx,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          Frame-&gt;esi, Frame-&gt;edi, Frame-&gt;ebp);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">int</span> sc_ret = call(Frame,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                      Frame-&gt;ebx, Frame-&gt;ecx, Frame-&gt;edx,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                      Frame-&gt;esi, Frame-&gt;edi, Frame-&gt;ebp);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;&lt; [%d:\&quot;%s\&quot;] = %d&quot;</span>,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          Frame-&gt;eax, Syscall.<a class="code" href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">Name</a>, sc_ret);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> sc_ret;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">#elif defined(aa64)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="ttc" id="adebug_8h_html_a1d297376472cc7f4ad7c70327efa7b55"><div class="ttname"><a href="../../db/d16/debug_8h.html#a1d297376472cc7f4ad7c70327efa7b55">warn</a></div><div class="ttdeci">#define warn(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00087">debug.h:87</a></div></div>
<div class="ttc" id="adebug_8h_html_a31e7d5c5946947277dce12f2584e7a43"><div class="ttname"><a href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a></div><div class="ttdeci">#define debug(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00094">debug.h:94</a></div></div>
<div class="ttc" id="adebug_8h_html_a65f6c7faf3bfe3937629a7a365e06574"><div class="ttname"><a href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a></div><div class="ttdeci">#define error(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00086">debug.h:86</a></div></div>
<div class="ttc" id="adebug_8h_html_abd4acaf7c67bd126aefd672fbbd5747f"><div class="ttname"><a href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a></div><div class="ttdeci">#define fixme(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00099">debug.h:99</a></div></div>
<div class="ttc" id="aerrno_8h_html_a43785b9969e0bd1af532dbde06c5540b"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a></div><div class="ttdeci">#define ENOSYS</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00133">errno.h:133</a></div></div>
<div class="ttc" id="aerrno_8h_html_add669d31505a077f769cff8e66c780b3"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#add669d31505a077f769cff8e66c780b3">EPERM</a></div><div class="ttdeci">#define EPERM</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00022">errno.h:22</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_a4788399d1d0b37ccf098a7da82254808"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a></div><div class="ttdeci">__UINTPTR_TYPE__ uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00186">types.h:186</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00405">types.h:405</a></div></div>
<div class="ttc" id="anative_8cpp_html_a73cb68c5a3b86c353d7eb8eb1cca8d91"><div class="ttname"><a href="../../db/d9b/native_8cpp.html#a73cb68c5a3b86c353d7eb8eb1cca8d91">NativeSyscallsTable</a></div><div class="ttdeci">static SyscallData NativeSyscallsTable[sc_MaxSyscall]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9b/native_8cpp_source.html#l00086">native.cpp:86</a></div></div>
<div class="ttc" id="anative_8cpp_html_a78ba64e0086364f774ae6a0b5a76768d"><div class="ttname"><a href="../../db/d9b/native_8cpp.html#a78ba64e0086364f774ae6a0b5a76768d">SyscallData::Name</a></div><div class="ttdeci">const char * Name</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd4/linux_8cpp_source.html#l00028">linux.cpp:28</a></div></div>
<div class="ttc" id="anative_8cpp_html_a7e7f056a3d1194a6cf2b7e8d706fedbe"><div class="ttname"><a href="../../db/d9b/native_8cpp.html#a7e7f056a3d1194a6cf2b7e8d706fedbe">SyscallData::Handler</a></div><div class="ttdeci">void * Handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd4/linux_8cpp_source.html#l00029">linux.cpp:29</a></div></div>
<div class="ttc" id="anative_8cpp_html_a8fb161011abf5426e3073021c59ce44d"><div class="ttname"><a href="../../db/d9b/native_8cpp.html#a8fb161011abf5426e3073021c59ce44d">SyscallData::RequiredID</a></div><div class="ttdeci">int RequiredID</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9b/native_8cpp_source.html#l00034">native.cpp:34</a></div></div>
<div class="ttc" id="anative_8cpp_html_aa07f2f09156b7539a5c1bb0a7334ddeb"><div class="ttname"><a href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a></div><div class="ttdeci">#define SysFrm</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9b/native_8cpp_source.html#l00045">native.cpp:45</a></div></div>
<div class="ttc" id="anative_8cpp_html_d9/df1/structSyscallData"><div class="ttname"><a href="../../db/d9b/native_8cpp.html#d9/df1/structSyscallData">SyscallData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd4/linux_8cpp_source.html#l00026">linux.cpp:27</a></div></div>
<div class="ttc" id="asyscalls_8h_html_a7646da588c70d4a6c38c0e3cef328fceaaa242cd5082bf1fb09de8900c75f6c1b"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#a7646da588c70d4a6c38c0e3cef328fceaaa242cd5082bf1fb09de8900c75f6c1b">sc_MaxSyscall</a></div><div class="ttdeci">@ sc_MaxSyscall</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00139">syscalls.h:138</a></div></div>
<div class="ttc" id="atask_8hpp_html_abcc2c2d29a284c2304deb5d0778c59c8"><div class="ttname"><a href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a></div><div class="ttdeci">#define thisProcess</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00618">task.hpp:618</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d16/debug_8h_source.html#l00094">debug</a>, <a class="el" href="../../d8/dc2/errno_8h_source.html#l00133">ENOSYS</a>, <a class="el" href="../../d8/dc2/errno_8h_source.html#l00022">EPERM</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00086">error</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00099">fixme</a>, <a class="el" href="../../d1/dd4/linux_8cpp_source.html#l00029">SyscallData::Handler</a>, <a class="el" href="../../d1/dd4/linux_8cpp_source.html#l00028">SyscallData::Name</a>, <a class="el" href="../../db/d9b/native_8cpp_source.html#l00086">NativeSyscallsTable</a>, <a class="el" href="../../db/d9b/native_8cpp_source.html#l00034">SyscallData::RequiredID</a>, <a class="el" href="../../d2/d6e/syscalls_8h_source.html#l00138">sc_MaxSyscall</a>, <a class="el" href="../../db/d9b/native_8cpp_source.html#l00045">SysFrm</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00618">thisProcess</a>, <a class="el" href="../../d6/de6/include_2types_8h_source.html#l00405">unlikely</a>, and <a class="el" href="../../db/d16/debug_8h_source.html#l00087">warn</a>.</p>

</div>
</div>
<a id="a7f8e5386a39dd1ecdc195c524ac54440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f8e5386a39dd1ecdc195c524ac54440">&#9670;&nbsp;</a></span>sys_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fildes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d31/close_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../db/d31/close_8cpp_source.html">close.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">function</span>(<span class="stringliteral">&quot;%d&quot;</span>, fildes);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a> *fdt = pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">FileDescriptors</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">return</span> fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a388d1525d6ab8f7681f69ae39e4483bc">_close</a>(fildes);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="aclassTasking_1_1PCB_html"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00331">task.hpp:332</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_aaf2f4c22bc6ba11ae549a3331d493d80"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">Tasking::PCB::FileDescriptors</a></div><div class="ttdeci">FileDescriptorTable * FileDescriptors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00379">task.hpp:379</a></div></div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00308">filesystem.hpp:309</a></div></div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html_a388d1525d6ab8f7681f69ae39e4483bc"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a388d1525d6ab8f7681f69ae39e4483bc">vfs::FileDescriptorTable::_close</a></div><div class="ttdeci">int _close(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/file__descriptor_8cpp_source.html#l00367">file_descriptor.cpp:367</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6846f41615da17d2822b4b3f3681d9f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6846f41615da17d2822b4b3f3681d9f8">&#9670;&nbsp;</a></span>sys_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sys_exit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d36/syscalls_2native_2exit_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d8/d36/syscalls_2native_2exit_8cpp_source.html">exit.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="../../da/daf/classTasking_1_1TCB.html">TCB</a> *t = <a class="code" href="../../d8/da1/task_8hpp.html#a1cf492bc489f4879fe6f67325e8f8dc7">thisThread</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a8666d232022b928a87f7fdf6de29d616">trace</a>(<span class="stringliteral">&quot;Userspace thread %s(%d) exited with code %d (%#x)&quot;</span>,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          t-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#aedede7d8d3c42d330b86d08a4ecb5ac9">Name</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          t-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#ac9c92137d88ac3b7ac0a88f042a05e9b">ID</a>, status,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          status &lt; 0 ? -status : status);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    t-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#aab475917d6b07f97eb5f90fa729b0025">ExitCode</a> = status;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    t-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a066ede1360169217c73ed7162b42024a">KeepTime</a> = <a class="code" href="../../dd/d24/kernel_8cpp.html#ad5fb15538e6988f0db36d754a4a7d08d">TimeManager</a>-&gt;<a class="code" href="../../dd/d8d/classTime_1_1time.html#a9359bb42e35516bd19f02e8855c6200a">CalculateTarget</a>(10, <a class="code" href="../../d3/d56/namespaceTime.html#abf085dea646562954f331d46d9712ed1a040adf802521b00a87d0826c581c62b1">Time::Seconds</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    t-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a11cb00f7e83521706ca00237b73fac67">State</a> = <a class="code" href="../../d9/d3e/namespaceTasking.html#abbba64463e2df2b5f909cc6fe9cfbd74a773f96280709f0b4ee36122b01357f51">Terminated</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        t-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a93dab82205d4cb609fcd7b5524871308">GetContext</a>()-&gt;<a class="code" href="../../dc/dc5/classTasking_1_1Task.html#af6e841b2fdb40756718f9842d97fb6c1">Yield</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    __builtin_unreachable();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="ttc" id="aclassTasking_1_1TCB_html"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html">Tasking::TCB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00220">task.hpp:221</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a066ede1360169217c73ed7162b42024a"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a066ede1360169217c73ed7162b42024a">Tasking::TCB::KeepTime</a></div><div class="ttdeci">std::atomic_size_t KeepTime</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00262">task.hpp:262</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a11cb00f7e83521706ca00237b73fac67"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a11cb00f7e83521706ca00237b73fac67">Tasking::TCB::State</a></div><div class="ttdeci">std::atomic&lt; TaskState &gt; State</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00260">task.hpp:260</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a93dab82205d4cb609fcd7b5524871308"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a93dab82205d4cb609fcd7b5524871308">Tasking::TCB::GetContext</a></div><div class="ttdeci">class Task * GetContext()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00250">task.hpp:250</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_aab475917d6b07f97eb5f90fa729b0025"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#aab475917d6b07f97eb5f90fa729b0025">Tasking::TCB::ExitCode</a></div><div class="ttdeci">std::atomic_int ExitCode</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00259">task.hpp:259</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_ac9c92137d88ac3b7ac0a88f042a05e9b"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#ac9c92137d88ac3b7ac0a88f042a05e9b">Tasking::TCB::ID</a></div><div class="ttdeci">TID ID</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00253">task.hpp:253</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_aedede7d8d3c42d330b86d08a4ecb5ac9"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#aedede7d8d3c42d330b86d08a4ecb5ac9">Tasking::TCB::Name</a></div><div class="ttdeci">const char * Name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00254">task.hpp:254</a></div></div>
<div class="ttc" id="aclassTasking_1_1Task_html_af6e841b2fdb40756718f9842d97fb6c1"><div class="ttname"><a href="../../dc/dc5/classTasking_1_1Task.html#af6e841b2fdb40756718f9842d97fb6c1">Tasking::Task::Yield</a></div><div class="ttdeci">__always_inline void Yield()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00521">task.hpp:521</a></div></div>
<div class="ttc" id="aclassTime_1_1time_html_a9359bb42e35516bd19f02e8855c6200a"><div class="ttname"><a href="../../dd/d8d/classTime_1_1time.html#a9359bb42e35516bd19f02e8855c6200a">Time::time::CalculateTarget</a></div><div class="ttdeci">uint64_t CalculateTarget(uint64_t Target, Units Unit)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de5/timer_8cpp_source.html#l00088">timer.cpp:88</a></div></div>
<div class="ttc" id="adebug_8h_html_a8666d232022b928a87f7fdf6de29d616"><div class="ttname"><a href="../../db/d16/debug_8h.html#a8666d232022b928a87f7fdf6de29d616">trace</a></div><div class="ttdeci">#define trace(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00098">debug.h:98</a></div></div>
<div class="ttc" id="akernel_8cpp_html_ad5fb15538e6988f0db36d754a4a7d08d"><div class="ttname"><a href="../../dd/d24/kernel_8cpp.html#ad5fb15538e6988f0db36d754a4a7d08d">TimeManager</a></div><div class="ttdeci">Time::time * TimeManager</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d24/kernel_8cpp_source.html#l00062">kernel.cpp:62</a></div></div>
<div class="ttc" id="anamespaceTasking_html_abbba64463e2df2b5f909cc6fe9cfbd74a773f96280709f0b4ee36122b01357f51"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#abbba64463e2df2b5f909cc6fe9cfbd74a773f96280709f0b4ee36122b01357f51">Tasking::Terminated</a></div><div class="ttdeci">@ Terminated</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00145">task.hpp:145</a></div></div>
<div class="ttc" id="anamespaceTime_html_abf085dea646562954f331d46d9712ed1a040adf802521b00a87d0826c581c62b1"><div class="ttname"><a href="../../d3/d56/namespaceTime.html#abf085dea646562954f331d46d9712ed1a040adf802521b00a87d0826c581c62b1">Time::Seconds</a></div><div class="ttdeci">@ Seconds</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d99/time_8hpp_source.html#l00042">time.hpp:42</a></div></div>
<div class="ttc" id="atask_8hpp_html_a1cf492bc489f4879fe6f67325e8f8dc7"><div class="ttname"><a href="../../d8/da1/task_8hpp.html#a1cf492bc489f4879fe6f67325e8f8dc7">thisThread</a></div><div class="ttdeci">#define thisThread</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00619">task.hpp:619</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a22db9f9fb39908fcf90c3e881e4aaffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22db9f9fb39908fcf90c3e881e4aaffa">&#9670;&nbsp;</a></span>sys_fork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_fork </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname"><em>Frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d28/fork_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../db/d28/fork_8cpp_source.html">fork.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="../../dc/da7/assert_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(Frame != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifdef a32</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">PCB</a> *Parent = <a class="code" href="../../d8/da1/task_8hpp.html#a1cf492bc489f4879fe6f67325e8f8dc7">thisThread</a>-&gt;Parent;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../da/daf/classTasking_1_1TCB.html">TCB</a> *Thread = <a class="code" href="../../d8/da1/task_8hpp.html#a1cf492bc489f4879fe6f67325e8f8dc7">thisThread</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">void</span> *ProcSymTable = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (Parent-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a8eb92f8788f988c3adc1926aaecd8aef">ELFSymbolTable</a>)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        ProcSymTable = Parent-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a8eb92f8788f988c3adc1926aaecd8aef">ELFSymbolTable</a>-&gt;<a class="code" href="../../d0/dcc/classSymbolResolver_1_1Symbols.html#a2ba7f8a0866432abf64c000db7091009">GetImage</a>();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">PCB</a> *NewProcess =</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="../../dd/d24/kernel_8cpp.html#a5a8d7736911609823f0ff8f3c8f51df2">TaskManager</a>-&gt;<a class="code" href="../../dc/dc5/classTasking_1_1Task.html#a32111fbbb04dfee771995a26712763f8">CreateProcess</a>(Parent,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                   Parent-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a3471bd96877a52ae53906382f16ad7ad">Name</a>,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                   Parent-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a4357c742aa8fb786da90f39db4688c8a">Security</a>.ExecutionMode,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                   ProcSymTable);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (!NewProcess)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Failed to create process for fork&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    NewProcess-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a9b9523ac2d94690834db9de8e5e137bc">IPC</a>-&gt;<a class="code" href="../../df/d7e/classInterProcessCommunication_1_1IPC.html#a312c5514d82f9b015fcece8f7ed8ce27">Fork</a>(Parent-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a9b9523ac2d94690834db9de8e5e137bc">IPC</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="../../da/daf/classTasking_1_1TCB.html">TCB</a> *NewThread =</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="../../dd/d24/kernel_8cpp.html#a5a8d7736911609823f0ff8f3c8f51df2">TaskManager</a>-&gt;<a class="code" href="../../dc/dc5/classTasking_1_1Task.html#aa1ffdb4c6acbdfd1dbd9afb4914c2656">CreateThread</a>(NewProcess,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                  0,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                  <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                  <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                  std::vector&lt;AuxiliaryVector&gt;(),</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                  Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a6d93f54301130195f0d3d109ce72a404">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#aabb3382fec35b68c33599188dd204e70">Architecture</a>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                  Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a6d93f54301130195f0d3d109ce72a404">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#a32ac6d7d295b6f35ec060e1fe50cf0f8">Compatibility</a>,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                  <span class="keyword">true</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#aadb59636003b7f7601250abe65a19ae6">Rename</a>(Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#aedede7d8d3c42d330b86d08a4ecb5ac9">Name</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (!NewThread)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Failed to create thread for fork&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="../../dd/d24/kernel_8cpp.html#a5a8d7736911609823f0ff8f3c8f51df2">TaskManager</a>-&gt;<a class="code" href="../../dc/dc5/classTasking_1_1Task.html#a326590548b079bb9648ffe5ca46e54d7">UpdateFrame</a>();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">/* This if statement will overwrite</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">        most of the registers except rcx</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">        and r8-r15 */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da1/task_8hpp.html#a1cf492bc489f4879fe6f67325e8f8dc7">thisThread</a>-&gt;ID == NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#ac9c92137d88ac3b7ac0a88f042a05e9b">ID</a>)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">/* We can&#39;t just return 0; because the</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">            gsTCB-&gt;SyscallStack is no</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">            longer valid */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#if defined(a64)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;movq $0, %rax\n&quot;</span>);  <span class="comment">/* Return 0 */</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;movq %r8, %rsp\n&quot;</span>); <span class="comment">/* Restore stack pointer */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;movq %r8, %rbp\n&quot;</span>); <span class="comment">/* Restore base pointer */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;swapgs\n&quot;</span>);         <span class="comment">/* Swap GS back to the user GS */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;sti\n&quot;</span>);            <span class="comment">/* Enable interrupts */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;sysretq\n&quot;</span>);        <span class="comment">/* Return to rcx address in user mode */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#warning &quot;sys_fork not implemented for i386&quot;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        __builtin_unreachable();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="../../d3/d68/convert_8cpp.html#a0c94a56e02776859c0f510bd6f7354c6">memcpy</a>(&amp;NewThread-&gt;FPU, &amp;Thread-&gt;FPU, <span class="keyword">sizeof</span>(CPU::x64::FXState));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a400cfe1efe4e2a03d86245924bbd417f">Stack</a>-&gt;<a class="code" href="../../dc/dbe/classMemory_1_1StackGuard.html#ac01b93512cc7b65f46569f928f98a1e9">Fork</a>(Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a400cfe1efe4e2a03d86245924bbd417f">Stack</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a6d93f54301130195f0d3d109ce72a404">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#aabb3382fec35b68c33599188dd204e70">Architecture</a> = Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a6d93f54301130195f0d3d109ce72a404">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#aabb3382fec35b68c33599188dd204e70">Architecture</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a6d93f54301130195f0d3d109ce72a404">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#a32ac6d7d295b6f35ec060e1fe50cf0f8">Compatibility</a> = Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a6d93f54301130195f0d3d109ce72a404">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#a32ac6d7d295b6f35ec060e1fe50cf0f8">Compatibility</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    NewThread-&gt;Registers = Thread-&gt;Registers;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#if defined(a64)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">/* For sysretq */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    NewThread-&gt;Registers.rcx = Frame-&gt;ReturnAddress;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    NewThread-&gt;Registers.r8 = Frame-&gt;StackPointer;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a8b932fcec28d49859c37704e73d66b74">Security</a>.IsCritical)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a421fc4b87573abd0194625680c485864">SetCritical</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#ifdef a86</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    NewThread-&gt;GSBase = NewThread-&gt;ShadowGSBase;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    NewThread-&gt;ShadowGSBase = Thread-&gt;ShadowGSBase;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    NewThread-&gt;FSBase = Thread-&gt;FSBase;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Forked thread \&quot;%s\&quot;(%d) to \&quot;%s\&quot;(%d)&quot;</span>,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#aedede7d8d3c42d330b86d08a4ecb5ac9">Name</a>, Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#ac9c92137d88ac3b7ac0a88f042a05e9b">ID</a>,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#aedede7d8d3c42d330b86d08a4ecb5ac9">Name</a>, NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#ac9c92137d88ac3b7ac0a88f042a05e9b">ID</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    NewThread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a11cb00f7e83521706ca00237b73fac67">State</a> = <a class="code" href="../../d9/d3e/namespaceTasking.html#abbba64463e2df2b5f909cc6fe9cfbd74ad63d08060d63334012f68b23d130f56e">Ready</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)NewProcess-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a3bb6d884a387f44fa6e6b0bd79f5b24c">ID</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="ttc" id="aassert_8h_html_af576bf8ffa22a44e53018c67095ffbf0"><div class="ttname"><a href="../../dc/da7/assert_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a></div><div class="ttdeci">#define assert(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da7/assert_8h_source.html#l00023">assert.h:23</a></div></div>
<div class="ttc" id="aclassInterProcessCommunication_1_1IPC_html_a312c5514d82f9b015fcece8f7ed8ce27"><div class="ttname"><a href="../../df/d7e/classInterProcessCommunication_1_1IPC.html#a312c5514d82f9b015fcece8f7ed8ce27">InterProcessCommunication::IPC::Fork</a></div><div class="ttdeci">void Fork(IPC *Parent)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dab/ipc_8cpp_source.html#l00027">ipc.cpp:27</a></div></div>
<div class="ttc" id="aclassMemory_1_1StackGuard_html_ac01b93512cc7b65f46569f928f98a1e9"><div class="ttname"><a href="../../dc/dbe/classMemory_1_1StackGuard.html#ac01b93512cc7b65f46569f928f98a1e9">Memory::StackGuard::Fork</a></div><div class="ttdeci">void Fork(StackGuard *Parent)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d26/stack__guard_8cpp_source.html#l00070">stack_guard.cpp:70</a></div></div>
<div class="ttc" id="aclassSymbolResolver_1_1Symbols_html_a2ba7f8a0866432abf64c000db7091009"><div class="ttname"><a href="../../d0/dcc/classSymbolResolver_1_1Symbols.html#a2ba7f8a0866432abf64c000db7091009">SymbolResolver::Symbols::GetImage</a></div><div class="ttdeci">void * GetImage()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d94/symbols_8hpp_source.html#l00039">symbols.hpp:39</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a3471bd96877a52ae53906382f16ad7ad"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a3471bd96877a52ae53906382f16ad7ad">Tasking::PCB::Name</a></div><div class="ttdeci">const char * Name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00352">task.hpp:352</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a3bb6d884a387f44fa6e6b0bd79f5b24c"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a3bb6d884a387f44fa6e6b0bd79f5b24c">Tasking::PCB::ID</a></div><div class="ttdeci">PID ID</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00351">task.hpp:351</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a4357c742aa8fb786da90f39db4688c8a"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a4357c742aa8fb786da90f39db4688c8a">Tasking::PCB::Security</a></div><div class="ttdeci">struct Tasking::PCB::@797 Security</div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a8eb92f8788f988c3adc1926aaecd8aef"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a8eb92f8788f988c3adc1926aaecd8aef">Tasking::PCB::ELFSymbolTable</a></div><div class="ttdeci">SymbolResolver::Symbols * ELFSymbolTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00388">task.hpp:388</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a9b9523ac2d94690834db9de8e5e137bc"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a9b9523ac2d94690834db9de8e5e137bc">Tasking::PCB::IPC</a></div><div class="ttdeci">InterProcessCommunication::IPC * IPC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00387">task.hpp:387</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a400cfe1efe4e2a03d86245924bbd417f"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a400cfe1efe4e2a03d86245924bbd417f">Tasking::TCB::Stack</a></div><div class="ttdeci">Memory::StackGuard * Stack</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00267">task.hpp:267</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a421fc4b87573abd0194625680c485864"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a421fc4b87573abd0194625680c485864">Tasking::TCB::SetCritical</a></div><div class="ttdeci">void SetCritical(bool Critical)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d35/thread_8cpp_source.html#l00095">thread.cpp:95</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a6d93f54301130195f0d3d109ce72a404"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a6d93f54301130195f0d3d109ce72a404">Tasking::TCB::Info</a></div><div class="ttdeci">TaskInfo Info</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00290">task.hpp:290</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a8b932fcec28d49859c37704e73d66b74"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a8b932fcec28d49859c37704e73d66b74">Tasking::TCB::Security</a></div><div class="ttdeci">__aligned(16) CPU struct Tasking::TCB::@795 Security</div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_aadb59636003b7f7601250abe65a19ae6"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#aadb59636003b7f7601250abe65a19ae6">Tasking::TCB::Rename</a></div><div class="ttdeci">void Rename(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d35/thread_8cpp_source.html#l00065">thread.cpp:65</a></div></div>
<div class="ttc" id="aclassTasking_1_1Task_html_a32111fbbb04dfee771995a26712763f8"><div class="ttname"><a href="../../dc/dc5/classTasking_1_1Task.html#a32111fbbb04dfee771995a26712763f8">Tasking::Task::CreateProcess</a></div><div class="ttdeci">PCB * CreateProcess(PCB *Parent, const char *Name, TaskExecutionMode TrustLevel, void *Image=nullptr, bool DoNotCreatePageTable=false, uint16_t UserID=UINT16_MAX, uint16_t GroupID=UINT16_MAX)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9c/task_8cpp_source.html#l00324">task.cpp:324</a></div></div>
<div class="ttc" id="aclassTasking_1_1Task_html_a326590548b079bb9648ffe5ca46e54d7"><div class="ttname"><a href="../../dc/dc5/classTasking_1_1Task.html#a326590548b079bb9648ffe5ca46e54d7">Tasking::Task::UpdateFrame</a></div><div class="ttdeci">__always_inline void UpdateFrame()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00537">task.hpp:537</a></div></div>
<div class="ttc" id="aclassTasking_1_1Task_html_aa1ffdb4c6acbdfd1dbd9afb4914c2656"><div class="ttname"><a href="../../dc/dc5/classTasking_1_1Task.html#aa1ffdb4c6acbdfd1dbd9afb4914c2656">Tasking::Task::CreateThread</a></div><div class="ttdeci">TCB * CreateThread(PCB *Parent, IP EntryPoint, const char **argv=nullptr, const char **envp=nullptr, const std::vector&lt; AuxiliaryVector &gt; &amp;auxv=std::vector&lt; AuxiliaryVector &gt;(), TaskArchitecture Architecture=TaskArchitecture::x64, TaskCompatibility Compatibility=TaskCompatibility::Native, bool ThreadNotReady=false)</div></div>
<div class="ttc" id="aconvert_8cpp_html_a0c94a56e02776859c0f510bd6f7354c6"><div class="ttname"><a href="../../d3/d68/convert_8cpp.html#a0c94a56e02776859c0f510bd6f7354c6">memcpy</a></div><div class="ttdeci">EXTERNC __no_stack_protector void * memcpy(void *dest, const void *src, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d68/convert_8cpp_source.html#l01060">convert.cpp:1060</a></div></div>
<div class="ttc" id="aerrno_8h_html_af0fac1cea1165b4debec7f686edf3313"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#af0fac1cea1165b4debec7f686edf3313">EAGAIN</a></div><div class="ttdeci">#define EAGAIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00052">errno.h:52</a></div></div>
<div class="ttc" id="akernel_8cpp_html_a5a8d7736911609823f0ff8f3c8f51df2"><div class="ttname"><a href="../../dd/d24/kernel_8cpp.html#a5a8d7736911609823f0ff8f3c8f51df2">TaskManager</a></div><div class="ttdeci">Tasking::Task * TaskManager</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d24/kernel_8cpp_source.html#l00069">kernel.cpp:69</a></div></div>
<div class="ttc" id="amb__64bit__map_8cpp_html_ab17ab6407b8950c89ba3ff3b4919200b"><div class="ttname"><a href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a></div><div class="ttdeci">asmv(&quot;invlpg (%0)&quot; ::&quot;r&quot;(VirtualAddress) :&quot;memory&quot;)</div></div>
<div class="ttc" id="anamespaceTasking_html_a32ac6d7d295b6f35ec060e1fe50cf0f8"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a32ac6d7d295b6f35ec060e1fe50cf0f8">Tasking::TaskInfo::Compatibility</a></div><div class="ttdeci">TaskCompatibility Compatibility</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00187">task.hpp:187</a></div></div>
<div class="ttc" id="anamespaceTasking_html_aabb3382fec35b68c33599188dd204e70"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#aabb3382fec35b68c33599188dd204e70">Tasking::TaskInfo::Architecture</a></div><div class="ttdeci">TaskArchitecture Architecture</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00186">task.hpp:186</a></div></div>
<div class="ttc" id="anamespaceTasking_html_abbba64463e2df2b5f909cc6fe9cfbd74ad63d08060d63334012f68b23d130f56e"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#abbba64463e2df2b5f909cc6fe9cfbd74ad63d08060d63334012f68b23d130f56e">Tasking::Ready</a></div><div class="ttdeci">@ Ready</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00087">task.hpp:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa41eb960b68f3028de8e945c3a0229b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa41eb960b68f3028de8e945c3a0229b4">&#9670;&nbsp;</a></span>sys_lseek()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">off_t sys_lseek </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fildes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/dc6/lseek_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d5/dc6/lseek_8cpp_source.html">lseek.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">function</span>(<span class="stringliteral">&quot;%d, %d, %d&quot;</span>, fildes, offset, whence);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a> *fdt = pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">FileDescriptors</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">return</span> fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a0e1f14ff1d575a665b613ff613ac05d3">_lseek</a>(fildes, offset, whence);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html_a0e1f14ff1d575a665b613ff613ac05d3"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a0e1f14ff1d575a665b613ff613ac05d3">vfs::FileDescriptorTable::_lseek</a></div><div class="ttdeci">off_t _lseek(int fd, off_t offset, int whence)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/file__descriptor_8cpp_source.html#l00417">file_descriptor.cpp:417</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a58034984a45861a08ce4bb47c7a08bc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58034984a45861a08ce4bb47c7a08bc4">&#9670;&nbsp;</a></span>sys_mmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* sys_mmap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fildes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d45/mmap_8cpp_source.html#l00046">46</a> of file <a class="el" href="../../d3/d45/mmap_8cpp_source.html">mmap.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> == 0)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)-<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (fildes != -1)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)-<a class="code" href="../../d8/dc2/errno_8h.html#a43785b9969e0bd1af532dbde06c5540b">ENOSYS</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">bool</span> p_None = prot &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#a12e75efb705069409e61b1dc6671d908">sc_PROT_NONE</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">bool</span> p_Read = prot &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#a246cb3864e068103d2b2f1b9a3a92a35">sc_PROT_READ</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">bool</span> p_Write = prot &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#aa20e0caf5eac4259ee13286bb661c131">sc_PROT_WRITE</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">bool</span> p_Exec = prot &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#abfc0d94d8cdfa54bf9e794636d798e0c">sc_PROT_EXEC</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">bool</span> m_Shared = flags &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#aa82622778664d160da46f7f212ec1d03">sc_MAP_SHARED</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">bool</span> m_Private = flags &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#abea2388d1465d319b993ff5b7ab4ee2d">sc_MAP_PRIVATE</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">bool</span> m_Fixed = flags &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#a496082b108a934216d67ee0dc8d64aaf">sc_MAP_FIXED</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">bool</span> m_Anon = flags &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#a2b05f7284b7526bcf9c062bc037d8ed5">sc_MAP_ANONYMOUS</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../d6/de6/include_2types_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(p_None);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="../../d6/de6/include_2types_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(m_Anon);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;N:%d R:%d W:%d E:%d&quot;</span>,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          p_None, p_Read, p_Write,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          p_Exec);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;S:%d P:%d F:%d A:%d&quot;</span>,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          m_Shared, m_Private,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          m_Fixed, m_Anon);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">int</span> UnknownFlags = flags &amp; ~(<a class="code" href="../../d2/d6e/syscalls_8h.html#aa82622778664d160da46f7f212ec1d03">sc_MAP_SHARED</a> |</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                 <a class="code" href="../../d2/d6e/syscalls_8h.html#abea2388d1465d319b993ff5b7ab4ee2d">sc_MAP_PRIVATE</a> |</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                 <a class="code" href="../../d2/d6e/syscalls_8h.html#a496082b108a934216d67ee0dc8d64aaf">sc_MAP_FIXED</a> |</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                 <a class="code" href="../../d2/d6e/syscalls_8h.html#a2b05f7284b7526bcf9c062bc037d8ed5">sc_MAP_ANONYMOUS</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (UnknownFlags)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Unknown flags: %x&quot;</span>, UnknownFlags);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)-<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> &gt; <a class="code" href="../../d4/dc3/macro_8hpp.html#aa741a36fad372fa52b7d026afc5781c6">PAGE_SIZE_2M</a>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;large page 2 MiB (requested %d)&quot;</span>,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;              <a class="code" href="../../d4/dc3/macro_8hpp.html#a5a247c5849cc161f5a98ef2400998f2a">TO_MiB</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> &gt; <a class="code" href="../../d4/dc3/macro_8hpp.html#a689ba4829262c30029918a9ff311f7ca">PAGE_SIZE_1G</a>)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;huge page 1 GiB (requested %d)&quot;</span>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;              <a class="code" href="../../d4/dc3/macro_8hpp.html#a50081d8d4b033010d4e2e147690b8695">TO_GiB</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>));</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (off % <a class="code" href="../../d4/dc3/macro_8hpp.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)-<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>) % <a class="code" href="../../d4/dc3/macro_8hpp.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> &amp;&amp; m_Fixed)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)-<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> ((m_Shared &amp;&amp; m_Private) ||</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        (!m_Shared &amp;&amp; !m_Private))</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)-<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="../../d5/d49/classMemory_1_1VirtualMemoryArea.html">Memory::VirtualMemoryArea</a> *vma = pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a411daae850caf3bb702d2ebbb69318d8">vma</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="../../d6/de6/include_2types_8h.html#a0bd5dec00e345e69027427f8621d6a6c">intptr_t</a> ret = (<a class="code" href="../../d6/de6/include_2types_8h.html#a0bd5dec00e345e69027427f8621d6a6c">intptr_t</a>)vma-&gt;<a class="code" href="../../d5/d49/classMemory_1_1VirtualMemoryArea.html#a71481647119f67eb5cc8da30ea8a06d2">CreateCoWRegion</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>, <a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                                  p_Read, p_Write, p_Exec,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                                  m_Fixed, m_Shared);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)ret;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
<div class="ttc" id="aclassMemory_1_1VirtualMemoryArea_html"><div class="ttname"><a href="../../d5/d49/classMemory_1_1VirtualMemoryArea.html">Memory::VirtualMemoryArea</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd1/vma_8hpp_source.html#l00031">vma.hpp:32</a></div></div>
<div class="ttc" id="aclassMemory_1_1VirtualMemoryArea_html_a71481647119f67eb5cc8da30ea8a06d2"><div class="ttname"><a href="../../d5/d49/classMemory_1_1VirtualMemoryArea.html#a71481647119f67eb5cc8da30ea8a06d2">Memory::VirtualMemoryArea::CreateCoWRegion</a></div><div class="ttdeci">void * CreateCoWRegion(void *Address, size_t Length, bool Read, bool Write, bool Exec, bool Fixed, bool Shared)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ded/vma_8cpp_source.html#l00191">vma.cpp:191</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a411daae850caf3bb702d2ebbb69318d8"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a411daae850caf3bb702d2ebbb69318d8">Tasking::PCB::vma</a></div><div class="ttdeci">Memory::VirtualMemoryArea * vma</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00383">task.hpp:383</a></div></div>
<div class="ttc" id="aerrno_8h_html_a2d1678d5a7cc8ce499643f3b8957def4"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a></div><div class="ttdeci">#define EINVAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00085">errno.h:85</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_a0bd5dec00e345e69027427f8621d6a6c"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#a0bd5dec00e345e69027427f8621d6a6c">intptr_t</a></div><div class="ttdeci">__INTPTR_TYPE__ intptr_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00185">types.h:185</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_a86d500a34c624c2cae56bc25a31b12f3"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a></div><div class="ttdeci">#define UNUSED(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00064">types.h:64</a></div></div>
<div class="ttc" id="amacro_8hpp_html_a50081d8d4b033010d4e2e147690b8695"><div class="ttname"><a href="../../d4/dc3/macro_8hpp.html#a50081d8d4b033010d4e2e147690b8695">TO_GiB</a></div><div class="ttdeci">#define TO_GiB(d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc3/macro_8hpp_source.html#l00028">macro.hpp:28</a></div></div>
<div class="ttc" id="amacro_8hpp_html_a5a247c5849cc161f5a98ef2400998f2a"><div class="ttname"><a href="../../d4/dc3/macro_8hpp.html#a5a247c5849cc161f5a98ef2400998f2a">TO_MiB</a></div><div class="ttdeci">#define TO_MiB(d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc3/macro_8hpp_source.html#l00026">macro.hpp:26</a></div></div>
<div class="ttc" id="amacro_8hpp_html_a689ba4829262c30029918a9ff311f7ca"><div class="ttname"><a href="../../d4/dc3/macro_8hpp.html#a689ba4829262c30029918a9ff311f7ca">PAGE_SIZE_1G</a></div><div class="ttdeci">#define PAGE_SIZE_1G</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc3/macro_8hpp_source.html#l00040">macro.hpp:40</a></div></div>
<div class="ttc" id="amacro_8hpp_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="../../d4/dc3/macro_8hpp.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc3/macro_8hpp_source.html#l00036">macro.hpp:36</a></div></div>
<div class="ttc" id="amacro_8hpp_html_aa741a36fad372fa52b7d026afc5781c6"><div class="ttname"><a href="../../d4/dc3/macro_8hpp.html#aa741a36fad372fa52b7d026afc5781c6">PAGE_SIZE_2M</a></div><div class="ttdeci">#define PAGE_SIZE_2M</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc3/macro_8hpp_source.html#l00038">macro.hpp:38</a></div></div>
<div class="ttc" id="amultiboot_8h_html_a6de3a6d27a7e07942958b912d39792e6"><div class="ttname"><a href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a></div><div class="ttdeci">multiboot_uint64_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc0/multiboot_8h_source.html#l00002">multiboot.h:2</a></div></div>
<div class="ttc" id="amultiboot_8h_html_a8286ae6db03c34c4bb161accbfbfbbcd"><div class="ttname"><a href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a></div><div class="ttdeci">multiboot_uint64_t addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc0/multiboot_8h_source.html#l00001">multiboot.h:1</a></div></div>
<div class="ttc" id="asyscalls_8h_html_a12e75efb705069409e61b1dc6671d908"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#a12e75efb705069409e61b1dc6671d908">sc_PROT_NONE</a></div><div class="ttdeci">#define sc_PROT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00038">syscalls.h:38</a></div></div>
<div class="ttc" id="asyscalls_8h_html_a246cb3864e068103d2b2f1b9a3a92a35"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#a246cb3864e068103d2b2f1b9a3a92a35">sc_PROT_READ</a></div><div class="ttdeci">#define sc_PROT_READ</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00039">syscalls.h:39</a></div></div>
<div class="ttc" id="asyscalls_8h_html_a2b05f7284b7526bcf9c062bc037d8ed5"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#a2b05f7284b7526bcf9c062bc037d8ed5">sc_MAP_ANONYMOUS</a></div><div class="ttdeci">#define sc_MAP_ANONYMOUS</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00046">syscalls.h:46</a></div></div>
<div class="ttc" id="asyscalls_8h_html_a496082b108a934216d67ee0dc8d64aaf"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#a496082b108a934216d67ee0dc8d64aaf">sc_MAP_FIXED</a></div><div class="ttdeci">#define sc_MAP_FIXED</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00045">syscalls.h:45</a></div></div>
<div class="ttc" id="asyscalls_8h_html_aa20e0caf5eac4259ee13286bb661c131"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#aa20e0caf5eac4259ee13286bb661c131">sc_PROT_WRITE</a></div><div class="ttdeci">#define sc_PROT_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00040">syscalls.h:40</a></div></div>
<div class="ttc" id="asyscalls_8h_html_aa82622778664d160da46f7f212ec1d03"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#aa82622778664d160da46f7f212ec1d03">sc_MAP_SHARED</a></div><div class="ttdeci">#define sc_MAP_SHARED</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00043">syscalls.h:43</a></div></div>
<div class="ttc" id="asyscalls_8h_html_abea2388d1465d319b993ff5b7ab4ee2d"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#abea2388d1465d319b993ff5b7ab4ee2d">sc_MAP_PRIVATE</a></div><div class="ttdeci">#define sc_MAP_PRIVATE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00044">syscalls.h:44</a></div></div>
<div class="ttc" id="asyscalls_8h_html_abfc0d94d8cdfa54bf9e794636d798e0c"><div class="ttname"><a href="../../d2/d6e/syscalls_8h.html#abfc0d94d8cdfa54bf9e794636d798e0c">sc_PROT_EXEC</a></div><div class="ttdeci">#define sc_PROT_EXEC</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/syscalls_8h_source.html#l00041">syscalls.h:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff752f52722a3727d1aee511528b3763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff752f52722a3727d1aee511528b3763">&#9670;&nbsp;</a></span>sys_mprotect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_mprotect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/ddf/mprotect_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../de/ddf/mprotect_8cpp_source.html">mprotect.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> == 0)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>) % <a class="code" href="../../d4/dc3/macro_8hpp.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">bool</span> p_None = prot &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#a12e75efb705069409e61b1dc6671d908">sc_PROT_NONE</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">bool</span> p_Read = prot &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#a246cb3864e068103d2b2f1b9a3a92a35">sc_PROT_READ</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">bool</span> p_Write = prot &amp; <a class="code" href="../../d2/d6e/syscalls_8h.html#aa20e0caf5eac4259ee13286bb661c131">sc_PROT_WRITE</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// bool p_Exec = prot &amp; sc_PROT_EXEC;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="../../db/d82/classMemory_1_1Virtual.html">Memory::Virtual</a> vmm = <a class="code" href="../../db/d82/classMemory_1_1Virtual.html">Memory::Virtual</a>(pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">PageTable</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> i = <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         i &lt; <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>) + <a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         i += <a class="code" href="../../d4/dc3/macro_8hpp.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(!vmm.<a class="code" href="../../db/d82/classMemory_1_1Virtual.html#a6675d97c91771f3929ef657b295df42e">Check</a>((<span class="keywordtype">void</span> *)i, <a class="code" href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2af974f8b521f68af69f46dc38e8085fd6">Memory::G</a>)))</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="../../dd/d44/unionMemory_1_1PageTableEntry.html">Memory::PageTableEntry</a> *pte = vmm.<a class="code" href="../../db/d82/classMemory_1_1Virtual.html#abc95ab992f2389590be9c1089f8a51c7">GetPTE</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (!pte-&gt;Present ||</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                (!pte-&gt;UserSupervisor &amp;&amp; p_Read) ||</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                (!pte-&gt;ReadWrite &amp;&amp; p_Write))</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Page %p is not mapped with the correct permissions&quot;</span>,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                      (<span class="keywordtype">void</span> *)i);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#ac2a2e9fa555401f94478f74e01868032">EACCES</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            pte-&gt;Present = p_None;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            pte-&gt;UserSupervisor = p_Read;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            pte-&gt;ReadWrite = p_Write;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="comment">// pte-&gt;ExecuteDisable = p_Exec;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#if defined(a64)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <a class="code" href="../../de/d52/namespacex32.html#aa5ab3109baaf98f4eb8a8ef2415bd7f6">CPU::x64::invlpg</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <a class="code" href="../../de/d52/namespacex32.html#aa5ab3109baaf98f4eb8a8ef2415bd7f6">CPU::x32::invlpg</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#elif defined(aa64)</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;dsb sy&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;tlbi vae1is, %0&quot;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                 :</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                 : <span class="stringliteral">&quot;r&quot;</span>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                 : <span class="stringliteral">&quot;memory&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;dsb sy&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="../../d9/def/mb__64bit__map_8cpp.html#ab17ab6407b8950c89ba3ff3b4919200b">asmv</a>(<span class="stringliteral">&quot;isb&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a1d297376472cc7f4ad7c70327efa7b55">warn</a>(<span class="stringliteral">&quot;%p is a global page&quot;</span>, (<span class="keywordtype">void</span> *)i);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
<div class="ttc" id="aclassMemory_1_1Virtual_html"><div class="ttname"><a href="../../db/d82/classMemory_1_1Virtual.html">Memory::Virtual</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dff/virtual_8hpp_source.html#l00029">virtual.hpp:30</a></div></div>
<div class="ttc" id="aclassMemory_1_1Virtual_html_a6675d97c91771f3929ef657b295df42e"><div class="ttname"><a href="../../db/d82/classMemory_1_1Virtual.html#a6675d97c91771f3929ef657b295df42e">Memory::Virtual::Check</a></div><div class="ttdeci">bool Check(void *VirtualAddress, PTFlag Flag=PTFlag::P, MapType Type=MapType::FourKiB)</div><div class="ttdoc">Check if page has the specified flag.</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6c/arch_2aarch64_2memory_2vmm_8cpp_source.html#l00025">vmm.cpp:25</a></div></div>
<div class="ttc" id="aclassMemory_1_1Virtual_html_abc95ab992f2389590be9c1089f8a51c7"><div class="ttname"><a href="../../db/d82/classMemory_1_1Virtual.html#abc95ab992f2389590be9c1089f8a51c7">Memory::Virtual::GetPTE</a></div><div class="ttdeci">PageTableEntry * GetPTE(void *VirtualAddress, MapType Type=MapType::FourKiB)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/db6/arch_2amd64_2memory_2vmm_8cpp_source.html#l00222">vmm.cpp:222</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a26a0d1882e42b835ba923b400dadaeb8"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">Tasking::PCB::PageTable</a></div><div class="ttdeci">Memory::PageTable * PageTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00382">task.hpp:382</a></div></div>
<div class="ttc" id="aerrno_8h_html_a6a05c923dad0c1208043e9c20a58c8e5"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#a6a05c923dad0c1208043e9c20a58c8e5">ENOMEM</a></div><div class="ttdeci">#define ENOMEM</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00055">errno.h:55</a></div></div>
<div class="ttc" id="aerrno_8h_html_ac2a2e9fa555401f94478f74e01868032"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#ac2a2e9fa555401f94478f74e01868032">EACCES</a></div><div class="ttdeci">#define EACCES</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00058">errno.h:58</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_a217a0bd562b98ae8c2ffce44935351e1"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a></div><div class="ttdeci">#define likely(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00404">types.h:404</a></div></div>
<div class="ttc" id="anamespaceMemory_html_a0e8df7832e7ea87aa8937798d28472b2af974f8b521f68af69f46dc38e8085fd6"><div class="ttname"><a href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2af974f8b521f68af69f46dc38e8085fd6">Memory::G</a></div><div class="ttdeci">@ G</div><div class="ttdoc">Global.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2d/table_8hpp_source.html#l00056">table.hpp:56</a></div></div>
<div class="ttc" id="anamespacex32_html_aa5ab3109baaf98f4eb8a8ef2415bd7f6"><div class="ttname"><a href="../../de/d52/namespacex32.html#aa5ab3109baaf98f4eb8a8ef2415bd7f6">x32::invlpg</a></div><div class="ttdeci">static SafeFunction void invlpg(void *Address)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbe/cpu_8hpp_source.html#l00477">cpu.hpp:477</a></div></div>
<div class="ttc" id="aunionMemory_1_1PageTableEntry_html"><div class="ttname"><a href="../../dd/d44/unionMemory_1_1PageTableEntry.html">Memory::PageTableEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2d/table_8hpp_source.html#l00107">table.hpp:108</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2eecd781ac5acf16e8e86924330f7f70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eecd781ac5acf16e8e86924330f7f70">&#9670;&nbsp;</a></span>sys_munmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_munmap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d60/munmap_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../db/d60/munmap_8cpp_source.html">munmap.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>) % <a class="code" href="../../d4/dc3/macro_8hpp.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> == 0)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a2d1678d5a7cc8ce499643f3b8957def4">EINVAL</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../d5/d49/classMemory_1_1VirtualMemoryArea.html">Memory::VirtualMemoryArea</a> *vma = pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a411daae850caf3bb702d2ebbb69318d8">vma</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="../../db/d82/classMemory_1_1Virtual.html">Memory::Virtual</a> vmm = <a class="code" href="../../db/d82/classMemory_1_1Virtual.html">Memory::Virtual</a>(pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">PageTable</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> i = <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         i &lt; <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>) + <a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         i += <a class="code" href="../../d4/dc3/macro_8hpp.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a217a0bd562b98ae8c2ffce44935351e1">likely</a>(!vmm.<a class="code" href="../../db/d82/classMemory_1_1Virtual.html#a6675d97c91771f3929ef657b295df42e">Check</a>((<span class="keywordtype">void</span> *)i, <a class="code" href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2af974f8b521f68af69f46dc38e8085fd6">Memory::G</a>)))</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            vmm.<a class="code" href="../../db/d82/classMemory_1_1Virtual.html#a47de63ab7a7389317dae8c618cf7d943">Remap</a>((<span class="keywordtype">void</span> *)i, (<span class="keywordtype">void</span> *)i, <a class="code" href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2a2125f893386d8c165e3cbab119d564a1">Memory::P</a> | <a class="code" href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2a2e2cbfec756dc2799e930bcb018f3da0">Memory::RW</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a1d297376472cc7f4ad7c70327efa7b55">warn</a>(<span class="stringliteral">&quot;%p is a global page&quot;</span>, (<span class="keywordtype">void</span> *)i);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">/* TODO: Check if the page is allocated</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">                and not only mapped */</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    vma-&gt;<a class="code" href="../../d5/d49/classMemory_1_1VirtualMemoryArea.html#af0ea755b06dea2605ecce60504b84322">FreePages</a>((<span class="keywordtype">void</span> *)<a class="code" href="../../d1/dc0/multiboot_8h.html#a8286ae6db03c34c4bb161accbfbfbbcd">addr</a>, <a class="code" href="../../d4/dc3/macro_8hpp.html#a10029add9db6f0340d9bd2be9b2d1048">TO_PAGES</a>(<a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>) + 1);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="ttc" id="aclassMemory_1_1VirtualMemoryArea_html_af0ea755b06dea2605ecce60504b84322"><div class="ttname"><a href="../../d5/d49/classMemory_1_1VirtualMemoryArea.html#af0ea755b06dea2605ecce60504b84322">Memory::VirtualMemoryArea::FreePages</a></div><div class="ttdeci">void FreePages(void *Address, size_t Count)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ded/vma_8cpp_source.html#l00144">vma.cpp:144</a></div></div>
<div class="ttc" id="aclassMemory_1_1Virtual_html_a47de63ab7a7389317dae8c618cf7d943"><div class="ttname"><a href="../../db/d82/classMemory_1_1Virtual.html#a47de63ab7a7389317dae8c618cf7d943">Memory::Virtual::Remap</a></div><div class="ttdeci">__always_inline void Remap(void *VirtualAddress, void *PhysicalAddress, uint64_t Flags, MapType Type=MapType::FourKiB)</div><div class="ttdoc">Remap page.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dff/virtual_8hpp_source.html#l00271">virtual.hpp:271</a></div></div>
<div class="ttc" id="amacro_8hpp_html_a10029add9db6f0340d9bd2be9b2d1048"><div class="ttname"><a href="../../d4/dc3/macro_8hpp.html#a10029add9db6f0340d9bd2be9b2d1048">TO_PAGES</a></div><div class="ttdeci">#define TO_PAGES(d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc3/macro_8hpp_source.html#l00046">macro.hpp:46</a></div></div>
<div class="ttc" id="anamespaceMemory_html_a0e8df7832e7ea87aa8937798d28472b2a2125f893386d8c165e3cbab119d564a1"><div class="ttname"><a href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2a2125f893386d8c165e3cbab119d564a1">Memory::P</a></div><div class="ttdeci">@ P</div><div class="ttdoc">Present.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2d/table_8hpp_source.html#l00032">table.hpp:32</a></div></div>
<div class="ttc" id="anamespaceMemory_html_a0e8df7832e7ea87aa8937798d28472b2a2e2cbfec756dc2799e930bcb018f3da0"><div class="ttname"><a href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2a2e2cbfec756dc2799e930bcb018f3da0">Memory::RW</a></div><div class="ttdeci">@ RW</div><div class="ttdoc">Read/Write.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2d/table_8hpp_source.html#l00035">table.hpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6632640eb1e66820fa37e8219837c416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6632640eb1e66820fa37e8219837c416">&#9670;&nbsp;</a></span>sys_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>oflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/dce/open_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d2/dce/open_8cpp_source.html">open.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *safe_path = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html">Memory::SmartHeap</a> sh(512, pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a411daae850caf3bb702d2ebbb69318d8">vma</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    safe_path = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)sh.Get();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="../../d9/dc0/classMemory_1_1SwapPT.html">Memory::SwapPT</a> <a class="code" href="../../d3/d82/convert_8h.html#a5caa2956a259c15d67de63fcddff3e57">swap</a>(pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">PageTable</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a> = <a class="code" href="../../d3/d82/convert_8h.html#a7dcc610f4b04a8ee418f03a6d9256629">strlen</a>(path);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="../../d3/d68/convert_8cpp.html#a0c94a56e02776859c0f510bd6f7354c6">memcpy</a>((<span class="keywordtype">void</span> *)safe_path, path, <a class="code" href="../../d1/dc0/multiboot_8h.html#a6de3a6d27a7e07942958b912d39792e6">len</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">function</span>(<span class="stringliteral">&quot;%s, %d, %d&quot;</span>, safe_path, oflag, mode);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a> *fdt = pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">FileDescriptors</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">return</span> fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aad35936ac452cc80e3b56675e686f5a4">_open</a>(safe_path, oflag, mode);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
<div class="ttc" id="aclassMemory_1_1SmartHeap_html"><div class="ttname"><a href="../../d5/ddc/classMemory_1_1SmartHeap.html">Memory::SmartHeap</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/smart__heap_8hpp_source.html#l00028">smart_heap.hpp:29</a></div></div>
<div class="ttc" id="aclassMemory_1_1SwapPT_html"><div class="ttname"><a href="../../d9/dc0/classMemory_1_1SwapPT.html">Memory::SwapPT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d9a/swap__pt_8hpp_source.html#l00029">swap_pt.hpp:30</a></div></div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html_aad35936ac452cc80e3b56675e686f5a4"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aad35936ac452cc80e3b56675e686f5a4">vfs::FileDescriptorTable::_open</a></div><div class="ttdeci">int _open(const char *pathname, int flags, mode_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/file__descriptor_8cpp_source.html#l00314">file_descriptor.cpp:314</a></div></div>
<div class="ttc" id="aconvert_8h_html_a5caa2956a259c15d67de63fcddff3e57"><div class="ttname"><a href="../../d3/d82/convert_8h.html#a5caa2956a259c15d67de63fcddff3e57">swap</a></div><div class="ttdeci">void swap(char *x, char *y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d68/convert_8cpp_source.html#l00341">convert.cpp:341</a></div></div>
<div class="ttc" id="aconvert_8h_html_a7dcc610f4b04a8ee418f03a6d9256629"><div class="ttname"><a href="../../d3/d82/convert_8h.html#a7dcc610f4b04a8ee418f03a6d9256629">strlen</a></div><div class="ttdeci">long unsigned strlen(const char s[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d68/convert_8cpp_source.html#l00064">convert.cpp:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad45f77fe8dfff12944b7ef34337aea91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad45f77fe8dfff12944b7ef34337aea91">&#9670;&nbsp;</a></span>sys_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/de6/include_2types_8h.html#af10f4c58d91a6fa30ccc8a19d0ecbf48">ssize_t</a> sys_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fildes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a>&#160;</td>
          <td class="paramname"><em>nbyte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d1c/read_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d4/d1c/read_8cpp_source.html">read.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">void</span> *safe_buf = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html">Memory::SmartHeap</a> sh(nbyte, pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a411daae850caf3bb702d2ebbb69318d8">vma</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    safe_buf = sh.Get();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">function</span>(<span class="stringliteral">&quot;%d, %p, %d&quot;</span>, fildes, buf, nbyte);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a> *fdt = pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">FileDescriptors</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../d6/de6/include_2types_8h.html#af10f4c58d91a6fa30ccc8a19d0ecbf48">ssize_t</a> ret = fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aa5e9c30c4a3d57cccd5068578322231b">_read</a>(fildes, safe_buf, nbyte);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (ret &gt;= 0)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a0e1f14ff1d575a665b613ff613ac05d3">_lseek</a>(fildes, ret, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="../../d9/dc0/classMemory_1_1SwapPT.html">Memory::SwapPT</a> <a class="code" href="../../d3/d82/convert_8h.html#a5caa2956a259c15d67de63fcddff3e57">swap</a>(pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">PageTable</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="../../d3/d68/convert_8cpp.html#a0c94a56e02776859c0f510bd6f7354c6">memcpy</a>(buf, safe_buf, nbyte);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html_aa5e9c30c4a3d57cccd5068578322231b"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aa5e9c30c4a3d57cccd5068578322231b">vfs::FileDescriptorTable::_read</a></div><div class="ttdeci">ssize_t _read(int fd, void *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/file__descriptor_8cpp_source.html#l00328">file_descriptor.cpp:328</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_a4c8d0b76b470ba65a43ca46a88320f39"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a></div><div class="ttdeci">#define SEEK_CUR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00031">filesystem.hpp:31</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_af10f4c58d91a6fa30ccc8a19d0ecbf48"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#af10f4c58d91a6fa30ccc8a19d0ecbf48">ssize_t</a></div><div class="ttdeci">intptr_t ssize_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00199">types.h:199</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f4a3608f72457813a7c58a2bd1218ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f4a3608f72457813a7c58a2bd1218ef">&#9670;&nbsp;</a></span>sys_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/de6/include_2types_8h.html#af10f4c58d91a6fa30ccc8a19d0ecbf48">ssize_t</a> sys_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9b/native_8cpp.html#aa07f2f09156b7539a5c1bb0a7334ddeb">SysFrm</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fildes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a>&#160;</td>
          <td class="paramname"><em>nbyte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d12/write_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d2/d12/write_8cpp_source.html">write.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">void</span> *safe_buf = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *pcb = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html">Memory::SmartHeap</a> sh(nbyte, pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a411daae850caf3bb702d2ebbb69318d8">vma</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    safe_buf = sh.Get();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="../../d9/dc0/classMemory_1_1SwapPT.html">Memory::SwapPT</a> <a class="code" href="../../d3/d82/convert_8h.html#a5caa2956a259c15d67de63fcddff3e57">swap</a>(pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">PageTable</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="../../d3/d68/convert_8cpp.html#a0c94a56e02776859c0f510bd6f7354c6">memcpy</a>((<span class="keywordtype">void</span> *)safe_buf, buf, nbyte);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">function</span>(<span class="stringliteral">&quot;%d, %p, %d&quot;</span>, fildes, buf, nbyte);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a> *fdt = pcb-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">FileDescriptors</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../d6/de6/include_2types_8h.html#af10f4c58d91a6fa30ccc8a19d0ecbf48">ssize_t</a> ret = fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a983a17cbba0eaab35393a2f0655b1522">_write</a>(fildes, safe_buf, nbyte);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a0e1f14ff1d575a665b613ff613ac05d3">_lseek</a>(fildes, ret, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html_a983a17cbba0eaab35393a2f0655b1522"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html#a983a17cbba0eaab35393a2f0655b1522">vfs::FileDescriptorTable::_write</a></div><div class="ttdeci">ssize_t _write(int fd, const void *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/file__descriptor_8cpp_source.html#l00347">file_descriptor.cpp:347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a73cb68c5a3b86c353d7eb8eb1cca8d91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73cb68c5a3b86c353d7eb8eb1cca8d91">&#9670;&nbsp;</a></span>NativeSyscallsTable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d9b/native_8cpp.html#d9/df1/structSyscallData">SyscallData</a> NativeSyscallsTable[<a class="el" href="../../d2/d6e/syscalls_8h.html#a7646da588c70d4a6c38c0e3cef328fceaaa242cd5082bf1fb09de8900c75f6c1b">sc_MaxSyscall</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d9b/native_8cpp_source.html#l00086">86</a> of file <a class="el" href="../../db/d9b/native_8cpp_source.html">native.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d9b/native_8cpp_source.html#l00139">HandleNativeSyscalls()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_52bed8acfaac088d5968cb2c84d7645d.html">Kernel</a></li><li class="navelem"><a class="el" href="../../dir_7d0bb72586de14915603f0910b6f0241.html">syscalls</a></li><li class="navelem"><a class="el" href="../../db/d9b/native_8cpp.html">native.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
