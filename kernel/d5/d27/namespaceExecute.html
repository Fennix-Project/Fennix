<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fennix Kernel: Execute Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fennix Kernel
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Opeating System from scratch made in C and C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d27/namespaceExecute.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Execute Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:d0/d45/structExecute_1_1SharedLibrary"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#d0/d45/structExecute_1_1SharedLibrary">SharedLibrary</a></td></tr>
<tr class="separator:d0/d45/structExecute_1_1SharedLibrary"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dd/dcb/structExecute_1_1MmImage"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#dd/dcb/structExecute_1_1MmImage">MmImage</a></td></tr>
<tr class="separator:dd/dcb/structExecute_1_1MmImage"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dc8/classExecute_1_1ELFObject.html">ELFObject</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:af4e1abcc5b1e4823d6a344e90bd6dfef"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfef">BinaryType</a> : int { <br />
&#160;&#160;<a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefae36f6938ddfbfbfe38fa6cf384fb6d19">BinTypeInvalid</a>
, <a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa4d86e9673c01f19bd31f096c363cf976">BinTypeFex</a>
, <a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa6928c465385d0a26e049a88b34a524f4">BinTypeELF</a>
, <a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefad046408a5647cdbf181157853f1ed4f1">BinTypePE</a>
, <br />
&#160;&#160;<a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa7b9fe36e6e4a575b5550167eab17a9c8">BinTypeNE</a>
, <a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa5a4c06cd75836ac8ec916a8341a18366">BinTypeMZ</a>
, <a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefafc199be97ad89f843f5914678a8285d4">BinTypeUnknown</a>
<br />
 }</td></tr>
<tr class="separator:af4e1abcc5b1e4823d6a344e90bd6dfef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7660dbbcb09b7326abe3631cd98fc2ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfef">BinaryType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a7660dbbcb09b7326abe3631cd98fc2ca">GetBinaryType</a> (const char *Path)</td></tr>
<tr class="separator:a7660dbbcb09b7326abe3631cd98fc2ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcdddb68a114a95cf29792bfca2b274a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/de6/include_2types_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#afcdddb68a114a95cf29792bfca2b274a">ELFIs64</a> (void *Header)</td></tr>
<tr class="separator:afcdddb68a114a95cf29792bfca2b274a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31dfd87b6fa1ef7beaa37ed956b34097"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d9e/elf_8h.html#ae1c4a562108c5d4dbccc19966145a77f">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a31dfd87b6fa1ef7beaa37ed956b34097">GetELFSheader</a> (<a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *Header)</td></tr>
<tr class="separator:a31dfd87b6fa1ef7beaa37ed956b34097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4527c193949a102a6793a17f1e2fb45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d9e/elf_8h.html#ae1c4a562108c5d4dbccc19966145a77f">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a> (<a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *Header, <a class="el" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> Index)</td></tr>
<tr class="separator:ad4527c193949a102a6793a17f1e2fb45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d3d0d454ea84db99c805b1ed826f8d8"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a4d3d0d454ea84db99c805b1ed826f8d8">GetELFStringTable</a> (<a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *Header)</td></tr>
<tr class="separator:a4d3d0d454ea84db99c805b1ed826f8d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7894a544dca4203177ce939296a1e59f"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a7894a544dca4203177ce939296a1e59f">ELFLookupString</a> (<a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *Header, <a class="el" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> Offset)</td></tr>
<tr class="separator:a7894a544dca4203177ce939296a1e59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660cd5854fd95bf599775f39f0f99966"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a660cd5854fd95bf599775f39f0f99966">ELFLookupSymbol</a> (<a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *Header, const char *Name)</td></tr>
<tr class="separator:a660cd5854fd95bf599775f39f0f99966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208160ff41b6dcf8a704c735933f9c1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a208160ff41b6dcf8a704c735933f9c1a">ELFLookupSymbol</a> (int fd, const char *Name)</td></tr>
<tr class="separator:a208160ff41b6dcf8a704c735933f9c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab90293c663674036e5f1f8f7bfdb5624"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#ab90293c663674036e5f1f8f7bfdb5624">ELFGetSymbolValue</a> (<a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *Header, <a class="el" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> Table, <a class="el" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> Index)</td></tr>
<tr class="separator:ab90293c663674036e5f1f8f7bfdb5624"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc56188d442f797eefb8ab970127f6c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#afc56188d442f797eefb8ab970127f6c4">ELFLoadRel</a> (void *BaseImage, const char *Name, <a class="el" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *Process)</td></tr>
<tr class="separator:afc56188d442f797eefb8ab970127f6c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3768aa3117473a27cd3b34932c9b50"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#dd/d27/structElf64__Dyn">Elf64_Dyn</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a1e3768aa3117473a27cd3b34932c9b50">ELFGetDynamicTag_x86_64</a> (int fd, <a class="el" href="../../d1/d9e/elf_8h.html#a370bb33de42069f09315e96d5f8053bb">DynamicArrayTags</a> Tag)</td></tr>
<tr class="separator:a1e3768aa3117473a27cd3b34932c9b50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb0cc2a0a8fff9c841f68b0adb33674a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#ae1c4a562108c5d4dbccc19966145a77f">Elf64_Shdr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#afb0cc2a0a8fff9c841f68b0adb33674a">ELFGetSections_x86_64</a> (int fd, const char *SectionName)</td></tr>
<tr class="separator:afb0cc2a0a8fff9c841f68b0adb33674a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f4667b7d5f0a5dea5a52b5fe6a1da90"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#d3/d7b/structElf64__Phdr">Elf64_Phdr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a7f4667b7d5f0a5dea5a52b5fe6a1da90">ELFGetSymbolType_x86_64</a> (int fd, <a class="el" href="../../d1/d9e/elf_8h.html#ac07037baa575afc7b34fa782e6a49be2">SegmentTypes</a> Tag)</td></tr>
<tr class="separator:a7f4667b7d5f0a5dea5a52b5fe6a1da90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b3cfddf6a8ff694736f944c401c5ee0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#a3b3cfddf6a8ff694736f944c401c5ee0">Spawn</a> (char *Path, const char **argv, const char **envp, <a class="el" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *Parent, <a class="el" href="../../d9/d3e/namespaceTasking.html#acdb977b9f386c7a7662877c8b0532d48">Tasking::TaskCompatibility</a> Compatibility, <a class="el" href="../../d6/de6/include_2types_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> Critical)</td></tr>
<tr class="separator:a3b3cfddf6a8ff694736f944c401c5ee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6807243e7ff27eb5ee0dd8c2532fca3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#d9/db8/structElf32__Phdr">Elf32_Phdr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#aa6807243e7ff27eb5ee0dd8c2532fca3">ELFGetSymbolType_x86_32</a> (int fd, <a class="el" href="../../d1/d9e/elf_8h.html#ac07037baa575afc7b34fa782e6a49be2">SegmentTypes</a> Tag)</td></tr>
<tr class="separator:aa6807243e7ff27eb5ee0dd8c2532fca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2deca9cfa6ce516cadd90b839edf8cd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#a683980a91a52f547398a21c27d7ca30b">Elf32_Shdr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#aa2deca9cfa6ce516cadd90b839edf8cd">ELFGetSections_x86_32</a> (int fd, const char *SectionName)</td></tr>
<tr class="separator:aa2deca9cfa6ce516cadd90b839edf8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6dfdf20413def138c79e0b13b06c95e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#d8/d23/structElf32__Dyn">Elf32_Dyn</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d27/namespaceExecute.html#af6dfdf20413def138c79e0b13b06c95e">ELFGetDynamicTag_x86_32</a> (int fd, <a class="el" href="../../d1/d9e/elf_8h.html#a370bb33de42069f09315e96d5f8053bb">DynamicArrayTags</a> Tag)</td></tr>
<tr class="separator:af6dfdf20413def138c79e0b13b06c95e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="d0/d45/structExecute_1_1SharedLibrary" id="d0/d45/structExecute_1_1SharedLibrary"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d0/d45/structExecute_1_1SharedLibrary">&#9670;&nbsp;</a></span>Execute::SharedLibrary</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Execute::SharedLibrary</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00043">43</a> of file <a class="el" href="../../d2/d83/exec_8hpp_source.html">exec.hpp</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="aeda13ffe10957e09f2dbaeec5d73fde7"></a>char</td>
<td class="fieldname">
Identifier[64]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a942a8b59ef44bd06b7f9917ec4dcde13"></a><a class="el" href="../../d6/de6/include_2types_8h.html#aa9d55e2f20e580b7445617d0d12fff6e">size_t</a></td>
<td class="fieldname">
Length</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9cd8dc3e8bfadd5810c39de698b3fb18"></a><a class="el" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a></td>
<td class="fieldname">
MemoryImage</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac241dc0bb0393da1ccc285e9840b52a9"></a>char</td>
<td class="fieldname">
Path[256]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0abb1623640dedc6c8e01d4698d81ed5"></a>int</td>
<td class="fieldname">
RefCount</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a704445fc3634a75bf0cfc19e63289b6e"></a><a class="el" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a></td>
<td class="fieldname">
Timeout</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="dd/dcb/structExecute_1_1MmImage" id="dd/dcb/structExecute_1_1MmImage"></a>
<h2 class="memtitle"><span class="permalink"><a href="#dd/dcb/structExecute_1_1MmImage">&#9670;&nbsp;</a></span>Execute::MmImage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Execute::MmImage</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00054">54</a> of file <a class="el" href="../../d2/d83/exec_8hpp_source.html">exec.hpp</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a7ffe596809872ac9f63c21f8a6dcfefc"></a>void *</td>
<td class="fieldname">
Physical</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab374da346ca4c834191b71f594bd2598"></a>void *</td>
<td class="fieldname">
Virtual</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="af4e1abcc5b1e4823d6a344e90bd6dfef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4e1abcc5b1e4823d6a344e90bd6dfef">&#9670;&nbsp;</a></span>BinaryType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfef">Execute::BinaryType</a> : int</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="af4e1abcc5b1e4823d6a344e90bd6dfefae36f6938ddfbfbfe38fa6cf384fb6d19"></a>BinTypeInvalid&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af4e1abcc5b1e4823d6a344e90bd6dfefa4d86e9673c01f19bd31f096c363cf976"></a>BinTypeFex&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af4e1abcc5b1e4823d6a344e90bd6dfefa6928c465385d0a26e049a88b34a524f4"></a>BinTypeELF&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af4e1abcc5b1e4823d6a344e90bd6dfefad046408a5647cdbf181157853f1ed4f1"></a>BinTypePE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af4e1abcc5b1e4823d6a344e90bd6dfefa7b9fe36e6e4a575b5550167eab17a9c8"></a>BinTypeNE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af4e1abcc5b1e4823d6a344e90bd6dfefa5a4c06cd75836ac8ec916a8341a18366"></a>BinTypeMZ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="af4e1abcc5b1e4823d6a344e90bd6dfefafc199be97ad89f843f5914678a8285d4"></a>BinTypeUnknown&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00032">32</a> of file <a class="el" href="../../d2/d83/exec_8hpp_source.html">exec.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefae36f6938ddfbfbfe38fa6cf384fb6d19">BinTypeInvalid</a>,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa4d86e9673c01f19bd31f096c363cf976">BinTypeFex</a>,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa6928c465385d0a26e049a88b34a524f4">BinTypeELF</a>,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefad046408a5647cdbf181157853f1ed4f1">BinTypePE</a>,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa7b9fe36e6e4a575b5550167eab17a9c8">BinTypeNE</a>,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa5a4c06cd75836ac8ec916a8341a18366">BinTypeMZ</a>,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefafc199be97ad89f843f5914678a8285d4">BinTypeUnknown</a></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    };</div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfefa4d86e9673c01f19bd31f096c363cf976"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa4d86e9673c01f19bd31f096c363cf976">Execute::BinTypeFex</a></div><div class="ttdeci">@ BinTypeFex</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00035">exec.hpp:35</a></div></div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfefa5a4c06cd75836ac8ec916a8341a18366"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa5a4c06cd75836ac8ec916a8341a18366">Execute::BinTypeMZ</a></div><div class="ttdeci">@ BinTypeMZ</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00039">exec.hpp:39</a></div></div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfefa6928c465385d0a26e049a88b34a524f4"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa6928c465385d0a26e049a88b34a524f4">Execute::BinTypeELF</a></div><div class="ttdeci">@ BinTypeELF</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00036">exec.hpp:36</a></div></div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfefa7b9fe36e6e4a575b5550167eab17a9c8"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa7b9fe36e6e4a575b5550167eab17a9c8">Execute::BinTypeNE</a></div><div class="ttdeci">@ BinTypeNE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00038">exec.hpp:38</a></div></div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfefad046408a5647cdbf181157853f1ed4f1"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefad046408a5647cdbf181157853f1ed4f1">Execute::BinTypePE</a></div><div class="ttdeci">@ BinTypePE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00037">exec.hpp:37</a></div></div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfefae36f6938ddfbfbfe38fa6cf384fb6d19"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefae36f6938ddfbfbfe38fa6cf384fb6d19">Execute::BinTypeInvalid</a></div><div class="ttdeci">@ BinTypeInvalid</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00034">exec.hpp:34</a></div></div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfefafc199be97ad89f843f5914678a8285d4"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefafc199be97ad89f843f5914678a8285d4">Execute::BinTypeUnknown</a></div><div class="ttdeci">@ BinTypeUnknown</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00041">exec.hpp:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="af6dfdf20413def138c79e0b13b06c95e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6dfdf20413def138c79e0b13b06c95e">&#9670;&nbsp;</a></span>ELFGetDynamicTag_x86_32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../d1/d9e/elf_8h.html#d8/d23/structElf32__Dyn">Elf32_Dyn</a>&gt; Execute::ELFGetDynamicTag_x86_32 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#a370bb33de42069f09315e96d5f8053bb">DynamicArrayTags</a>&#160;</td>
          <td class="paramname"><em>Tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e3768aa3117473a27cd3b34932c9b50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3768aa3117473a27cd3b34932c9b50">&#9670;&nbsp;</a></span>ELFGetDynamicTag_x86_64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#dd/d27/structElf64__Dyn">Elf64_Dyn</a> &gt; Execute::ELFGetDynamicTag_x86_64 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#a370bb33de42069f09315e96d5f8053bb">DynamicArrayTags</a>&#160;</td>
          <td class="paramname"><em>Tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d8c/elf__get__dynamic__tag_8cpp_source.html#l00024">24</a> of file <a class="el" href="../../dc/d8c/elf__get__dynamic__tag_8cpp_source.html">elf_get_dynamic_tag.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#if defined(a64) || defined(aa64)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        off_t OldOffset = <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        std::vector&lt;Elf64_Dyn&gt; Ret;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> ELFHeader;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;ELFHeader, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a>));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        std::vector&lt;Elf64_Phdr&gt; DYNAMICPhdrs = <a class="code" href="../../d5/d27/namespaceExecute.html#a7f4667b7d5f0a5dea5a52b5fe6a1da90">ELFGetSymbolType_x86_64</a>(fd, <a class="code" href="../../d1/d9e/elf_8h.html#ac07037baa575afc7b34fa782e6a49be2adb5972d68614ececce857a4a0e59eb73">PT_DYNAMIC</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">if</span> (DYNAMICPhdrs.size() &lt; 1)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;No dynamic phdrs found.&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <span class="keywordflow">return</span> Ret;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">foreach</span> (<span class="keyword">auto</span> Phdr <span class="keywordflow">in</span> DYNAMICPhdrs)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#dd/d27/structElf64__Dyn">Elf64_Dyn</a> Dynamic;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; Phdr.p_filesz / <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#dd/d27/structElf64__Dyn">Elf64_Dyn</a>); i++)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, Phdr.p_offset + (i * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#dd/d27/structElf64__Dyn">Elf64_Dyn</a>)), <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;Dynamic, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#dd/d27/structElf64__Dyn">Elf64_Dyn</a>));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <span class="keywordflow">if</span> (Dynamic.d_tag != Tag)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Found dynamic tag %d at %#lx [d_val: %#lx]&quot;</span>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                      Tag, &amp;Dynamic, Dynamic.d_un.d_val);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                Ret.push_back(Dynamic);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, OldOffset, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">return</span> Ret;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="ttc" id="adebug_8h_html_a31e7d5c5946947277dce12f2584e7a43"><div class="ttname"><a href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a></div><div class="ttdeci">#define debug(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00094">debug.h:94</a></div></div>
<div class="ttc" id="adebug_8h_html_a65f6c7faf3bfe3937629a7a365e06574"><div class="ttname"><a href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a></div><div class="ttdeci">#define error(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00086">debug.h:86</a></div></div>
<div class="ttc" id="aelf_8h_html_ac07037baa575afc7b34fa782e6a49be2adb5972d68614ececce857a4a0e59eb73"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ac07037baa575afc7b34fa782e6a49be2adb5972d68614ececce857a4a0e59eb73">PT_DYNAMIC</a></div><div class="ttdeci">@ PT_DYNAMIC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00222">elf.h:222</a></div></div>
<div class="ttc" id="aelf_8h_html_da/d7b/structelf64__hdr"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">elf64_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00597">elf.h:598</a></div></div>
<div class="ttc" id="aelf_8h_html_dd/d27/structElf64__Dyn"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#dd/d27/structElf64__Dyn">Elf64_Dyn</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00709">elf.h:710</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_a0d112bae8fd35be772185b6ec6bcbe64"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a></div><div class="ttdeci">#define SEEK_SET</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00030">filesystem.hpp:30</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_a4c8d0b76b470ba65a43ca46a88320f39"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a></div><div class="ttdeci">#define SEEK_CUR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00031">filesystem.hpp:31</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_a59e6d0024b412f266839f22638916254"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a></div><div class="ttdeci">ssize_t fread(int fd, void *buf, size_t count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5c/kernel__io_8cpp_source.html#l00055">kernel_io.cpp:55</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_a8bd74caed008a66808d92d57fa74d9f6"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a></div><div class="ttdeci">off_t lseek(int fd, off_t offset, int whence)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5c/kernel__io_8cpp_source.html#l00088">kernel_io.cpp:88</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_a3cb4a16b0e8d6af0af86d4fd6ba5fd9d"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a></div><div class="ttdeci">__UINT8_TYPE__ uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00160">types.h:160</a></div></div>
<div class="ttc" id="anamespaceExecute_html_a7f4667b7d5f0a5dea5a52b5fe6a1da90"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#a7f4667b7d5f0a5dea5a52b5fe6a1da90">Execute::ELFGetSymbolType_x86_64</a></div><div class="ttdeci">std::vector&lt; Elf64_Phdr &gt; ELFGetSymbolType_x86_64(int fd, SegmentTypes Tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dde/elf__get__symbol__type_8cpp_source.html#l00024">elf_get_symbol_type.cpp:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d16/debug_8h_source.html#l00094">debug</a>, <a class="el" href="../../d1/dde/elf__get__symbol__type_8cpp_source.html#l00024">ELFGetSymbolType_x86_64()</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00086">error</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00055">fread()</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00088">lseek()</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00222">PT_DYNAMIC</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00031">SEEK_CUR</a>, and <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00030">SEEK_SET</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d8e/elf__loader_8cpp_source.html#l00254">Execute::ELFObject::LoadDyn_x86_64()</a>.</p>

</div>
</div>
<a id="aa2deca9cfa6ce516cadd90b839edf8cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2deca9cfa6ce516cadd90b839edf8cd">&#9670;&nbsp;</a></span>ELFGetSections_x86_32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../d1/d9e/elf_8h.html#a683980a91a52f547398a21c27d7ca30b">Elf32_Shdr</a>&gt; Execute::ELFGetSections_x86_32 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>SectionName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afb0cc2a0a8fff9c841f68b0adb33674a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb0cc2a0a8fff9c841f68b0adb33674a">&#9670;&nbsp;</a></span>ELFGetSections_x86_64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#ae1c4a562108c5d4dbccc19966145a77f">Elf64_Shdr</a> &gt; Execute::ELFGetSections_x86_64 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>SectionName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/d11/elf__get__sections_8cpp_source.html#l00024">24</a> of file <a class="el" href="../../de/d11/elf__get__sections_8cpp_source.html">elf_get_sections.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#if defined(a64) || defined(aa64)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        off_t OldOffset = <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        std::vector&lt;Elf64_Shdr&gt; Ret;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> ELFHeader;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;ELFHeader, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a>));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *SectionHeaders = <span class="keyword">new</span> <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a>[ELFHeader.e_shnum];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, ELFHeader.e_shoff, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)SectionHeaders, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a>) * ELFHeader.e_shnum);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordtype">char</span> *SectionNames = <span class="keyword">new</span> <span class="keywordtype">char</span>[SectionHeaders[ELFHeader.e_shstrndx].sh_size];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, SectionHeaders[ELFHeader.e_shstrndx].sh_offset, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)SectionNames, SectionHeaders[ELFHeader.e_shstrndx].sh_size);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d9e/elf_8h.html#adb6a5584018b431da3472e7c6a7fd731">Elf64_Half</a> i = 0; i &lt; ELFHeader.e_shnum; ++i)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a> = SectionNames + SectionHeaders[i].sh_name;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/d82/convert_8h.html#a5206cb6f52495066146ae3a41d166eb7">strcmp</a>(<a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a>, SectionName) == 0)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                Ret.push_back(SectionHeaders[i]);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, OldOffset, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keyword">delete</span>[] SectionHeaders;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keyword">delete</span>[] SectionNames;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">return</span> Ret;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="ttc" id="aconvert_8h_html_a5206cb6f52495066146ae3a41d166eb7"><div class="ttname"><a href="../../d3/d82/convert_8h.html#a5206cb6f52495066146ae3a41d166eb7">strcmp</a></div><div class="ttdeci">int strcmp(const char *l, const char *r)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d68/convert_8cpp_source.html#l00123">convert.cpp:123</a></div></div>
<div class="ttc" id="aelf_8h_html_adb6a5584018b431da3472e7c6a7fd731"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#adb6a5584018b431da3472e7c6a7fd731">Elf64_Half</a></div><div class="ttdeci">uint16_t Elf64_Half</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00032">elf.h:32</a></div></div>
<div class="ttc" id="aelf_8h_html_d3/d22/structelf64__shdr"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">elf64_shdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00629">elf.h:630</a></div></div>
<div class="ttc" id="anamespaceCPU_html_aa2666633b57974db680ea4f94c98f510"><div class="ttname"><a href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">CPU::Name</a></div><div class="ttdeci">const char * Name()</div><div class="ttdoc">Get CPU name.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dfc/cpu_8cpp_source.html#l00062">cpu.cpp:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00611">elf64_hdr::e_shnum</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00605">elf64_hdr::e_shoff</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00612">elf64_hdr::e_shstrndx</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00055">fread()</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00088">lseek()</a>, <a class="el" href="../../d7/dfc/cpu_8cpp_source.html#l00062">CPU::Name()</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00031">SEEK_CUR</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00030">SEEK_SET</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00631">elf64_shdr::sh_name</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00635">elf64_shdr::sh_offset</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00636">elf64_shdr::sh_size</a>, and <a class="el" href="../../d3/d68/convert_8cpp_source.html#l00123">strcmp()</a>.</p>

</div>
</div>
<a id="aa6807243e7ff27eb5ee0dd8c2532fca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6807243e7ff27eb5ee0dd8c2532fca3">&#9670;&nbsp;</a></span>ELFGetSymbolType_x86_32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../d1/d9e/elf_8h.html#d9/db8/structElf32__Phdr">Elf32_Phdr</a>&gt; Execute::ELFGetSymbolType_x86_32 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#ac07037baa575afc7b34fa782e6a49be2">SegmentTypes</a>&#160;</td>
          <td class="paramname"><em>Tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7f4667b7d5f0a5dea5a52b5fe6a1da90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f4667b7d5f0a5dea5a52b5fe6a1da90">&#9670;&nbsp;</a></span>ELFGetSymbolType_x86_64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d1/d9e/elf_8h.html#d3/d7b/structElf64__Phdr">Elf64_Phdr</a> &gt; Execute::ELFGetSymbolType_x86_64 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#ac07037baa575afc7b34fa782e6a49be2">SegmentTypes</a>&#160;</td>
          <td class="paramname"><em>Tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/dde/elf__get__symbol__type_8cpp_source.html#l00024">24</a> of file <a class="el" href="../../d1/dde/elf__get__symbol__type_8cpp_source.html">elf_get_symbol_type.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#if defined(a64) || defined(aa64)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        off_t OldOffset = <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        std::vector&lt;Elf64_Phdr&gt; Ret;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> ELFHeader;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;ELFHeader, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a>));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d7b/structElf64__Phdr">Elf64_Phdr</a> ProgramHeaders;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, ELFHeader.e_phoff, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;ProgramHeaders, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d7b/structElf64__Phdr">Elf64_Phdr</a>));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d9e/elf_8h.html#adb6a5584018b431da3472e7c6a7fd731">Elf64_Half</a> i = 0; i &lt; ELFHeader.e_phnum; i++)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keywordflow">if</span> (ProgramHeaders.p_type == Tag)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                Ret.push_back(ProgramHeaders);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d7b/structElf64__Phdr">Elf64_Phdr</a>), <a class="code" href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;ProgramHeaders, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d7b/structElf64__Phdr">Elf64_Phdr</a>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, OldOffset, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">return</span> Ret;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="ttc" id="aelf_8h_html_d3/d7b/structElf64__Phdr"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#d3/d7b/structElf64__Phdr">Elf64_Phdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00655">elf.h:656</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00609">elf64_hdr::e_phnum</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00604">elf64_hdr::e_phoff</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00055">fread()</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00088">lseek()</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00657">Elf64_Phdr::p_type</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00031">SEEK_CUR</a>, and <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00030">SEEK_SET</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d8c/elf__get__dynamic__tag_8cpp_source.html#l00024">ELFGetDynamicTag_x86_64()</a>, <a class="el" href="../../d7/d8e/elf__loader_8cpp_source.html#l00254">Execute::ELFObject::LoadDyn_x86_64()</a>, and <a class="el" href="../../d7/d8e/elf__loader_8cpp_source.html#l00122">Execute::ELFObject::LoadExec_x86_64()</a>.</p>

</div>
</div>
<a id="ab90293c663674036e5f1f8f7bfdb5624"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab90293c663674036e5f1f8f7bfdb5624">&#9670;&nbsp;</a></span>ELFGetSymbolValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> Execute::ELFGetSymbolValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>Header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>&#160;</td>
          <td class="paramname"><em>Table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>&#160;</td>
          <td class="paramname"><em>Index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00160">160</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#if defined(a64)</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> (Table == <a class="code" href="../../d1/d9e/elf_8h.html#ab2f25695673c5f1c4ec723e595288411">SHN_UNDEF</a> || Index == <a class="code" href="../../d1/d9e/elf_8h.html#ab2f25695673c5f1c4ec723e595288411">SHN_UNDEF</a>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *SymbolTable = <a class="code" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a>(Header, Table);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> STEntries = SymbolTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a> / SymbolTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#af5edba2a1a4035c365feb3da2aa97757">sh_entsize</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> (Index &gt;= STEntries)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Symbol index out of range %d-%u.&quot;</span>, Table, Index);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">return</span> 0xdead;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> SymbolAddress = (<a class="code" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>)Header + SymbolTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">Elf64_Sym</a> *Symbol = &amp;((<a class="code" href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">Elf64_Sym</a> *)SymbolAddress)[Index];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (Symbol-&gt;st_shndx == <a class="code" href="../../d1/d9e/elf_8h.html#ab2f25695673c5f1c4ec723e595288411">SHN_UNDEF</a>)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *StringTable = <a class="code" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a>(Header, SymbolTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a301574a5d9476946ac3e6a2416a46a82">sh_link</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a> = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)Header + StringTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a> + Symbol-&gt;st_name;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordtype">void</span> *Target = (<span class="keywordtype">void</span> *)<a class="code" href="../../d5/d27/namespaceExecute.html#a208160ff41b6dcf8a704c735933f9c1a">ELFLookupSymbol</a>(Header, <a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a>)-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#ade472d8a7be87eb8feaba4b40ae31aee">st_value</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> (Target == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9e/elf_8h.html#a42a5357c8e88e59874be665f0f8bece6">ELF64_ST_BIND</a>(Symbol-&gt;st_info) &amp; <a class="code" href="../../d1/d9e/elf_8h.html#a6ee65fedf672f66264c8a891573bee5bab291fc9096183099d8de1b65e7d7ebd9">STB_WEAK</a>)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Undefined external symbol \&quot;%s\&quot;.&quot;</span>, <a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    <span class="keywordflow">return</span> 0xdead;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">return</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)Target;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Symbol-&gt;st_shndx == <a class="code" href="../../d1/d9e/elf_8h.html#a322030426afae1a37a8ba1ab86a39066">SHN_ABS</a>)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordflow">return</span> Symbol-&gt;st_value;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *Target = <a class="code" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a>(Header, Symbol-&gt;st_shndx);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)Header + Symbol-&gt;st_value + Target-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">return</span> 0xdead;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="ttc" id="aarithmetic__operations_8c_html_aaa5d1cd013383c889537491c3cfd9aad"><div class="ttname"><a href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a></div><div class="ttdeci">unsigned long long uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/ddd/arithmetic__operations_8c_source.html#l00294">arithmetic_operations.c:294</a></div></div>
<div class="ttc" id="aelf_8h_html_a1e9054001e3e7d1284d051ad1291e4a4"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">elf64_shdr::sh_size</a></div><div class="ttdeci">Elf64_Xword sh_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00636">elf.h:636</a></div></div>
<div class="ttc" id="aelf_8h_html_a301574a5d9476946ac3e6a2416a46a82"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a301574a5d9476946ac3e6a2416a46a82">elf64_shdr::sh_link</a></div><div class="ttdeci">Elf64_Word sh_link</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00637">elf.h:637</a></div></div>
<div class="ttc" id="aelf_8h_html_a322030426afae1a37a8ba1ab86a39066"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a322030426afae1a37a8ba1ab86a39066">SHN_ABS</a></div><div class="ttdeci">#define SHN_ABS</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00333">elf.h:333</a></div></div>
<div class="ttc" id="aelf_8h_html_a42a5357c8e88e59874be665f0f8bece6"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a42a5357c8e88e59874be665f0f8bece6">ELF64_ST_BIND</a></div><div class="ttdeci">#define ELF64_ST_BIND(info)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00310">elf.h:310</a></div></div>
<div class="ttc" id="aelf_8h_html_a6ee65fedf672f66264c8a891573bee5bab291fc9096183099d8de1b65e7d7ebd9"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a6ee65fedf672f66264c8a891573bee5bab291fc9096183099d8de1b65e7d7ebd9">STB_WEAK</a></div><div class="ttdeci">@ STB_WEAK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00196">elf.h:196</a></div></div>
<div class="ttc" id="aelf_8h_html_ab2f25695673c5f1c4ec723e595288411"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ab2f25695673c5f1c4ec723e595288411">SHN_UNDEF</a></div><div class="ttdeci">#define SHN_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00332">elf.h:332</a></div></div>
<div class="ttc" id="aelf_8h_html_abb068619f9fae94dc5cd7ec6eacd4c42"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">elf64_shdr::sh_offset</a></div><div class="ttdeci">Elf64_Off sh_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00635">elf.h:635</a></div></div>
<div class="ttc" id="aelf_8h_html_ade472d8a7be87eb8feaba4b40ae31aee"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ade472d8a7be87eb8feaba4b40ae31aee">elf64_sym::st_value</a></div><div class="ttdeci">Elf64_Addr st_value</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00695">elf.h:695</a></div></div>
<div class="ttc" id="aelf_8h_html_af5edba2a1a4035c365feb3da2aa97757"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#af5edba2a1a4035c365feb3da2aa97757">elf64_shdr::sh_entsize</a></div><div class="ttdeci">Elf64_Xword sh_entsize</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00640">elf.h:640</a></div></div>
<div class="ttc" id="aelf_8h_html_d8/d92/structelf64__sym"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">elf64_sym</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00689">elf.h:690</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_a4788399d1d0b37ccf098a7da82254808"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a></div><div class="ttdeci">__UINTPTR_TYPE__ uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00186">types.h:186</a></div></div>
<div class="ttc" id="anamespaceExecute_html_a208160ff41b6dcf8a704c735933f9c1a"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#a208160ff41b6dcf8a704c735933f9c1a">Execute::ELFLookupSymbol</a></div><div class="ttdeci">Elf64_Sym ELFLookupSymbol(int fd, const char *Name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db6/elf__parse_8cpp_source.html#l00096">elf_parse.cpp:96</a></div></div>
<div class="ttc" id="anamespaceExecute_html_ad4527c193949a102a6793a17f1e2fb45"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">Execute::GetELFSection</a></div><div class="ttdeci">Elf64_Shdr * GetELFSection(Elf64_Ehdr *Header, uint64_t Index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db6/elf__parse_8cpp_source.html#l00042">elf_parse.cpp:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00310">ELF64_ST_BIND</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00062">ELFLookupSymbol()</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00086">error</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00042">GetELFSection()</a>, <a class="el" href="../../d7/dfc/cpu_8cpp_source.html#l00062">CPU::Name()</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00640">elf64_shdr::sh_entsize</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00637">elf64_shdr::sh_link</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00635">elf64_shdr::sh_offset</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00636">elf64_shdr::sh_size</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00333">SHN_ABS</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00332">SHN_UNDEF</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00695">elf64_sym::st_value</a>, and <a class="el" href="../../d1/d9e/elf_8h_source.html#l00196">STB_WEAK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d82/elf__rel_8cpp_source.html#l00029">ELFLoadRel()</a>.</p>

</div>
</div>
<a id="afcdddb68a114a95cf29792bfca2b274a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcdddb68a114a95cf29792bfca2b274a">&#9670;&nbsp;</a></span>ELFIs64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/de6/include_2types_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> Execute::ELFIs64 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>Header</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00027">27</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#dd/d18/structelf32__hdr">Elf32_Ehdr</a> *ELFHeader = (<a class="code" href="../../d1/d9e/elf_8h.html#dd/d18/structelf32__hdr">Elf32_Ehdr</a> *)Header;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordflow">if</span> (ELFHeader-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a0575bb9bb6c40328de8ac17bdd9a9571">e_ident</a>[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235aac9b8531d68f60088b42d23a36c58417">EI_CLASS</a>] == <a class="code" href="../../d1/d9e/elf_8h.html#a9ee66b59be5c78ea1f1eea8a36f2c291">ELFCLASS64</a>)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div>
<div class="ttc" id="aelf_8h_html_a0575bb9bb6c40328de8ac17bdd9a9571"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a0575bb9bb6c40328de8ac17bdd9a9571">elf32_hdr::e_ident</a></div><div class="ttdeci">unsigned char e_ident[EI_NIDENT]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00581">elf.h:581</a></div></div>
<div class="ttc" id="aelf_8h_html_a540f96e9e651e74266e0bd74e0f52235aac9b8531d68f60088b42d23a36c58417"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235aac9b8531d68f60088b42d23a36c58417">EI_CLASS</a></div><div class="ttdeci">@ EI_CLASS</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00046">elf.h:46</a></div></div>
<div class="ttc" id="aelf_8h_html_a9ee66b59be5c78ea1f1eea8a36f2c291"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a9ee66b59be5c78ea1f1eea8a36f2c291">ELFCLASS64</a></div><div class="ttdeci">#define ELFCLASS64</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00536">elf.h:536</a></div></div>
<div class="ttc" id="aelf_8h_html_dd/d18/structelf32__hdr"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#dd/d18/structelf32__hdr">elf32_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00579">elf.h:580</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00581">elf32_hdr::e_ident</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00046">EI_CLASS</a>, and <a class="el" href="../../d1/d9e/elf_8h_source.html#l00536">ELFCLASS64</a>.</p>

</div>
</div>
<a id="afc56188d442f797eefb8ab970127f6c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc56188d442f797eefb8ab970127f6c4">&#9670;&nbsp;</a></span>ELFLoadRel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Execute::ELFLoadRel </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>BaseImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>Name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *&#160;</td>
          <td class="paramname"><em>Process</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d82/elf__rel_8cpp_source.html#l00029">29</a> of file <a class="el" href="../../d2/d82/elf__rel_8cpp_source.html">elf_rel.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#if defined(a64)</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <a class="code" href="../../d6/de6/include_2types_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(<a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Relocatable&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">/* TODO: I have to fully implement this, but for now I will leave it as it is now. */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a1d297376472cc7f4ad7c70327efa7b55">warn</a>(<span class="stringliteral">&quot;Relocatable ELF is not fully supported yet&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *shdr = <a class="code" href="../../d5/d27/namespaceExecute.html#a31dfd87b6fa1ef7beaa37ed956b34097">GetELFSheader</a>(((<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> *)BaseImage));</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d9e/elf_8h.html#adb6a5584018b431da3472e7c6a7fd731">Elf64_Half</a> i = 0; i &lt; ((<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> *)BaseImage)-&gt;e_shnum; i++)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *Section = &amp;shdr[i];</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            <span class="keywordflow">if</span> (Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a20b1ca3674936878ca6a909802c0a3fd">sh_type</a> == <a class="code" href="../../d1/d9e/elf_8h.html#ac66207c7e7e0fab7248858c17aa1b194a985f94e6ac3b5a28032272578a16a49a">SHT_NOBITS</a>)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                <span class="keywordflow">if</span> (!Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a>)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                <span class="keywordflow">if</span> (Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a41de8e250776f71aceecf99c4291baae">sh_flags</a> &amp; <a class="code" href="../../d1/d9e/elf_8h.html#a38476fe4ed88ac83ba86a4e103199a86">SHF_ALLOC</a>)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                    <span class="keywordtype">void</span> *Buffer = <a class="code" href="../../d8/d71/memory_8cpp.html#ad0bbf7b6012cd16abb06c03dd26ffbaf">KernelAllocator</a>.RequestPages(<a class="code" href="../../d4/dc3/macro_8hpp.html#a10029add9db6f0340d9bd2be9b2d1048">TO_PAGES</a>(Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a> + 1));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                    <a class="code" href="../../d3/d68/convert_8cpp.html#ae577b1098c1f745563eb0789fa58ae14">memset</a>(Buffer, 0, Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                    <a class="code" href="../../db/d82/classMemory_1_1Virtual.html">Memory::Virtual</a>(Process-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">PageTable</a>).<a class="code" href="../../db/d82/classMemory_1_1Virtual.html#a1a5c185804c552d127a0e90162600f27">Map</a>((<span class="keywordtype">void</span> *)Buffer, (<span class="keywordtype">void</span> *)Buffer, Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a>, <a class="code" href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2a2e2cbfec756dc2799e930bcb018f3da0">Memory::PTFlag::RW</a> | <a class="code" href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2ad4ef4c4cde11ca945e056ebb58f0a1c0">Memory::PTFlag::US</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                    Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a> = (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)Buffer - (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)BaseImage;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Section %ld&quot;</span>, Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d9e/elf_8h.html#adb6a5584018b431da3472e7c6a7fd731">Elf64_Half</a> i = 0; i &lt; ((<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> *)BaseImage)-&gt;e_shnum; i++)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *Section = &amp;shdr[i];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordflow">if</span> (Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a20b1ca3674936878ca6a909802c0a3fd">sh_type</a> == <a class="code" href="../../d1/d9e/elf_8h.html#ac66207c7e7e0fab7248858c17aa1b194a5e725986507e6d3d83eaea79b8625f48">SHT_REL</a>)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Index = 0; Index &lt; Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a> / Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#af5edba2a1a4035c365feb3da2aa97757">sh_entsize</a>; Index++)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                    <a class="code" href="../../d1/d9e/elf_8h.html#de/d4a/structelf64__rel">Elf64_Rel</a> *RelTable = &amp;((<a class="code" href="../../d1/d9e/elf_8h.html#de/d4a/structelf64__rel">Elf64_Rel</a> *)((<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)BaseImage + Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a>))[Index];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *Target = <a class="code" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a>(((<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> *)BaseImage), Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1f8ce1f31eb995ec7956bbe5ea21253a">sh_info</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    <a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> *RelAddress = (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> *)(((<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)BaseImage + Target-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a>) + RelTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#ae10275b5ff8db6ebcbeb7fd8b5aeb00c">r_offset</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    <a class="code" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> SymbolValue = 0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9e/elf_8h.html#ab8a1253bfcc928f9aa9d4177d84f6830">ELF64_R_SYM</a>(RelTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a2ce90466a6e390cfcd72b65b9f331555">r_info</a>) != <a class="code" href="../../d1/d9e/elf_8h.html#ab2f25695673c5f1c4ec723e595288411">SHN_UNDEF</a>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                    {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                        SymbolValue = <a class="code" href="../../d5/d27/namespaceExecute.html#ab90293c663674036e5f1f8f7bfdb5624">ELFGetSymbolValue</a>(((<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> *)BaseImage), Section-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a301574a5d9476946ac3e6a2416a46a82">sh_link</a>, <a class="code" href="../../d1/d9e/elf_8h.html#ab8a1253bfcc928f9aa9d4177d84f6830">ELF64_R_SYM</a>(RelTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a2ce90466a6e390cfcd72b65b9f331555">r_info</a>));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                        <span class="keywordflow">if</span> (SymbolValue == 0xdead)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d9e/elf_8h.html#a51aeadee885873fec9a218c058fe9e09">ELF64_R_TYPE</a>(RelTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a2ce90466a6e390cfcd72b65b9f331555">r_info</a>))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#a49c53c5dd8ff90ceb3dad1484397ef16aab1b4d3ac5b0433d382ee1959cf765e5">R_386_NONE</a>:</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#a49c53c5dd8ff90ceb3dad1484397ef16a7b52974df2dc7d41fea7ba09e53c8008">R_386_32</a>:</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                        *RelAddress = <a class="code" href="../../d1/d9e/elf_8h.html#a9fd771b855c88f9a13147a0a560a8ebe">DO_64_64</a>(SymbolValue, *RelAddress);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#a49c53c5dd8ff90ceb3dad1484397ef16ac8d5b77f9cdb0ca7b2647768319d72a9">R_386_PC32</a>:</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                        *RelAddress = <a class="code" href="../../d1/d9e/elf_8h.html#ada1680eb451e4468e4725377162ccb93">DO_64_PC32</a>(SymbolValue, *RelAddress, (<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)RelAddress);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                        <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Unsupported relocation type: %d&quot;</span>, <a class="code" href="../../d1/d9e/elf_8h.html#a51aeadee885873fec9a218c058fe9e09">ELF64_R_TYPE</a>(RelTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a2ce90466a6e390cfcd72b65b9f331555">r_info</a>));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Symbol value: %#lx&quot;</span>, SymbolValue);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#elif defined(a32)</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="ttc" id="aclassMemory_1_1Virtual_html"><div class="ttname"><a href="../../db/d82/classMemory_1_1Virtual.html">Memory::Virtual</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dff/virtual_8hpp_source.html#l00029">virtual.hpp:30</a></div></div>
<div class="ttc" id="aclassMemory_1_1Virtual_html_a1a5c185804c552d127a0e90162600f27"><div class="ttname"><a href="../../db/d82/classMemory_1_1Virtual.html#a1a5c185804c552d127a0e90162600f27">Memory::Virtual::Map</a></div><div class="ttdeci">void Map(void *VirtualAddress, void *PhysicalAddress, uint64_t Flag=PTFlag::P, MapType Type=MapType::FourKiB)</div><div class="ttdoc">Map page.</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6c/arch_2aarch64_2memory_2vmm_8cpp_source.html#l00033">vmm.cpp:33</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a26a0d1882e42b835ba923b400dadaeb8"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a26a0d1882e42b835ba923b400dadaeb8">Tasking::PCB::PageTable</a></div><div class="ttdeci">Memory::PageTable * PageTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00382">task.hpp:382</a></div></div>
<div class="ttc" id="aconvert_8cpp_html_ae577b1098c1f745563eb0789fa58ae14"><div class="ttname"><a href="../../d3/d68/convert_8cpp.html#ae577b1098c1f745563eb0789fa58ae14">memset</a></div><div class="ttdeci">EXTERNC __no_stack_protector void * memset(void *dest, int val, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d68/convert_8cpp_source.html#l01067">convert.cpp:1067</a></div></div>
<div class="ttc" id="adebug_8h_html_a1d297376472cc7f4ad7c70327efa7b55"><div class="ttname"><a href="../../db/d16/debug_8h.html#a1d297376472cc7f4ad7c70327efa7b55">warn</a></div><div class="ttdeci">#define warn(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00087">debug.h:87</a></div></div>
<div class="ttc" id="aelf_8h_html_a1f8ce1f31eb995ec7956bbe5ea21253a"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a1f8ce1f31eb995ec7956bbe5ea21253a">elf64_shdr::sh_info</a></div><div class="ttdeci">Elf64_Word sh_info</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00638">elf.h:638</a></div></div>
<div class="ttc" id="aelf_8h_html_a20b1ca3674936878ca6a909802c0a3fd"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a20b1ca3674936878ca6a909802c0a3fd">elf64_shdr::sh_type</a></div><div class="ttdeci">Elf64_Word sh_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00632">elf.h:632</a></div></div>
<div class="ttc" id="aelf_8h_html_a2ce90466a6e390cfcd72b65b9f331555"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a2ce90466a6e390cfcd72b65b9f331555">elf64_rel::r_info</a></div><div class="ttdeci">Elf64_Xword r_info</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00676">elf.h:676</a></div></div>
<div class="ttc" id="aelf_8h_html_a38476fe4ed88ac83ba86a4e103199a86"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a38476fe4ed88ac83ba86a4e103199a86">SHF_ALLOC</a></div><div class="ttdeci">#define SHF_ALLOC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00336">elf.h:336</a></div></div>
<div class="ttc" id="aelf_8h_html_a41de8e250776f71aceecf99c4291baae"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a41de8e250776f71aceecf99c4291baae">elf64_shdr::sh_flags</a></div><div class="ttdeci">Elf64_Xword sh_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00633">elf.h:633</a></div></div>
<div class="ttc" id="aelf_8h_html_a49c53c5dd8ff90ceb3dad1484397ef16a7b52974df2dc7d41fea7ba09e53c8008"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a49c53c5dd8ff90ceb3dad1484397ef16a7b52974df2dc7d41fea7ba09e53c8008">R_386_32</a></div><div class="ttdeci">@ R_386_32</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00097">elf.h:97</a></div></div>
<div class="ttc" id="aelf_8h_html_a49c53c5dd8ff90ceb3dad1484397ef16aab1b4d3ac5b0433d382ee1959cf765e5"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a49c53c5dd8ff90ceb3dad1484397ef16aab1b4d3ac5b0433d382ee1959cf765e5">R_386_NONE</a></div><div class="ttdeci">@ R_386_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00096">elf.h:96</a></div></div>
<div class="ttc" id="aelf_8h_html_a49c53c5dd8ff90ceb3dad1484397ef16ac8d5b77f9cdb0ca7b2647768319d72a9"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a49c53c5dd8ff90ceb3dad1484397ef16ac8d5b77f9cdb0ca7b2647768319d72a9">R_386_PC32</a></div><div class="ttdeci">@ R_386_PC32</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00098">elf.h:98</a></div></div>
<div class="ttc" id="aelf_8h_html_a51aeadee885873fec9a218c058fe9e09"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a51aeadee885873fec9a218c058fe9e09">ELF64_R_TYPE</a></div><div class="ttdeci">#define ELF64_R_TYPE(i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00329">elf.h:329</a></div></div>
<div class="ttc" id="aelf_8h_html_a9fd771b855c88f9a13147a0a560a8ebe"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a9fd771b855c88f9a13147a0a560a8ebe">DO_64_64</a></div><div class="ttdeci">#define DO_64_64(S, A)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00321">elf.h:321</a></div></div>
<div class="ttc" id="aelf_8h_html_ab8a1253bfcc928f9aa9d4177d84f6830"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ab8a1253bfcc928f9aa9d4177d84f6830">ELF64_R_SYM</a></div><div class="ttdeci">#define ELF64_R_SYM(i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00328">elf.h:328</a></div></div>
<div class="ttc" id="aelf_8h_html_ac66207c7e7e0fab7248858c17aa1b194a5e725986507e6d3d83eaea79b8625f48"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ac66207c7e7e0fab7248858c17aa1b194a5e725986507e6d3d83eaea79b8625f48">SHT_REL</a></div><div class="ttdeci">@ SHT_REL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00550">elf.h:550</a></div></div>
<div class="ttc" id="aelf_8h_html_ac66207c7e7e0fab7248858c17aa1b194a985f94e6ac3b5a28032272578a16a49a"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ac66207c7e7e0fab7248858c17aa1b194a985f94e6ac3b5a28032272578a16a49a">SHT_NOBITS</a></div><div class="ttdeci">@ SHT_NOBITS</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00549">elf.h:549</a></div></div>
<div class="ttc" id="aelf_8h_html_ada1680eb451e4468e4725377162ccb93"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ada1680eb451e4468e4725377162ccb93">DO_64_PC32</a></div><div class="ttdeci">#define DO_64_PC32(S, A, P)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00322">elf.h:322</a></div></div>
<div class="ttc" id="aelf_8h_html_ae10275b5ff8db6ebcbeb7fd8b5aeb00c"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ae10275b5ff8db6ebcbeb7fd8b5aeb00c">elf64_rel::r_offset</a></div><div class="ttdeci">Elf64_Addr r_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00675">elf.h:675</a></div></div>
<div class="ttc" id="aelf_8h_html_de/d4a/structelf64__rel"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#de/d4a/structelf64__rel">elf64_rel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00673">elf.h:674</a></div></div>
<div class="ttc" id="ainclude_2types_8h_html_a86d500a34c624c2cae56bc25a31b12f3"><div class="ttname"><a href="../../d6/de6/include_2types_8h.html#a86d500a34c624c2cae56bc25a31b12f3">UNUSED</a></div><div class="ttdeci">#define UNUSED(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de6/include_2types_8h_source.html#l00064">types.h:64</a></div></div>
<div class="ttc" id="amacro_8hpp_html_a10029add9db6f0340d9bd2be9b2d1048"><div class="ttname"><a href="../../d4/dc3/macro_8hpp.html#a10029add9db6f0340d9bd2be9b2d1048">TO_PAGES</a></div><div class="ttdeci">#define TO_PAGES(d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc3/macro_8hpp_source.html#l00046">macro.hpp:46</a></div></div>
<div class="ttc" id="amemory_8cpp_html_ad0bbf7b6012cd16abb06c03dd26ffbaf"><div class="ttname"><a href="../../d8/d71/memory_8cpp.html#ad0bbf7b6012cd16abb06c03dd26ffbaf">KernelAllocator</a></div><div class="ttdeci">Physical KernelAllocator</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d71/memory_8cpp_source.html#l00043">memory.cpp:43</a></div></div>
<div class="ttc" id="anamespaceExecute_html_a31dfd87b6fa1ef7beaa37ed956b34097"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#a31dfd87b6fa1ef7beaa37ed956b34097">Execute::GetELFSheader</a></div><div class="ttdeci">Elf64_Shdr * GetELFSheader(Elf64_Ehdr *Header)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db6/elf__parse_8cpp_source.html#l00037">elf_parse.cpp:37</a></div></div>
<div class="ttc" id="anamespaceExecute_html_ab90293c663674036e5f1f8f7bfdb5624"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#ab90293c663674036e5f1f8f7bfdb5624">Execute::ELFGetSymbolValue</a></div><div class="ttdeci">uintptr_t ELFGetSymbolValue(Elf64_Ehdr *Header, uint64_t Table, uint64_t Index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db6/elf__parse_8cpp_source.html#l00160">elf_parse.cpp:160</a></div></div>
<div class="ttc" id="anamespaceMemory_html_a0e8df7832e7ea87aa8937798d28472b2a2e2cbfec756dc2799e930bcb018f3da0"><div class="ttname"><a href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2a2e2cbfec756dc2799e930bcb018f3da0">Memory::RW</a></div><div class="ttdeci">@ RW</div><div class="ttdoc">Read/Write.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2d/table_8hpp_source.html#l00035">table.hpp:35</a></div></div>
<div class="ttc" id="anamespaceMemory_html_a0e8df7832e7ea87aa8937798d28472b2ad4ef4c4cde11ca945e056ebb58f0a1c0"><div class="ttname"><a href="../../d3/d97/namespaceMemory.html#a0e8df7832e7ea87aa8937798d28472b2ad4ef4c4cde11ca945e056ebb58f0a1c0">Memory::US</a></div><div class="ttdeci">@ US</div><div class="ttdoc">User/Supervisor.</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2d/table_8hpp_source.html#l00038">table.hpp:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d16/debug_8h_source.html#l00094">debug</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00321">DO_64_64</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00322">DO_64_PC32</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00328">ELF64_R_SYM</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00329">ELF64_R_TYPE</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00160">ELFGetSymbolValue()</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00086">error</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00042">GetELFSection()</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00037">GetELFSheader()</a>, <a class="el" href="../../d8/d71/memory_8cpp_source.html#l00043">KernelAllocator</a>, <a class="el" href="../../d0/d6c/arch_2aarch64_2memory_2vmm_8cpp_source.html#l00033">Memory::Virtual::Map()</a>, <a class="el" href="../../d3/d68/convert_8cpp_source.html#l01067">memset()</a>, <a class="el" href="../../d7/dfc/cpu_8cpp_source.html#l00062">CPU::Name()</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00382">Tasking::PCB::PageTable</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00097">R_386_32</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00096">R_386_NONE</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00098">R_386_PC32</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00676">elf64_rel::r_info</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00675">elf64_rel::r_offset</a>, <a class="el" href="../../de/d2d/table_8hpp_source.html#l00035">Memory::RW</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00640">elf64_shdr::sh_entsize</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00633">elf64_shdr::sh_flags</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00638">elf64_shdr::sh_info</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00637">elf64_shdr::sh_link</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00635">elf64_shdr::sh_offset</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00636">elf64_shdr::sh_size</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00632">elf64_shdr::sh_type</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00336">SHF_ALLOC</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00332">SHN_UNDEF</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00549">SHT_NOBITS</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00550">SHT_REL</a>, <a class="el" href="../../d4/dc3/macro_8hpp_source.html#l00046">TO_PAGES</a>, <a class="el" href="../../d6/de6/include_2types_8h_source.html#l00064">UNUSED</a>, <a class="el" href="../../de/d2d/table_8hpp_source.html#l00038">Memory::US</a>, and <a class="el" href="../../db/d16/debug_8h_source.html#l00087">warn</a>.</p>

</div>
</div>
<a id="a7894a544dca4203177ce939296a1e59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7894a544dca4203177ce939296a1e59f">&#9670;&nbsp;</a></span>ELFLookupString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * Execute::ELFLookupString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>Header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>Offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00054">54</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordtype">char</span> *StringTable = <a class="code" href="../../d5/d27/namespaceExecute.html#a4d3d0d454ea84db99c805b1ed826f8d8">GetELFStringTable</a>(Header);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">if</span> (StringTable == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span> StringTable + Offset;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="ttc" id="anamespaceExecute_html_a4d3d0d454ea84db99c805b1ed826f8d8"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#a4d3d0d454ea84db99c805b1ed826f8d8">Execute::GetELFStringTable</a></div><div class="ttdeci">char * GetELFStringTable(Elf64_Ehdr *Header)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db6/elf__parse_8cpp_source.html#l00047">elf_parse.cpp:47</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00047">GetELFStringTable()</a>.</p>

</div>
</div>
<a id="a660cd5854fd95bf599775f39f0f99966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660cd5854fd95bf599775f39f0f99966">&#9670;&nbsp;</a></span>ELFLookupSymbol() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a> * Execute::ELFLookupSymbol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>Header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>Name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00062">62</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *SymbolTable = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *StringTable = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d9e/elf_8h.html#adb6a5584018b431da3472e7c6a7fd731">Elf64_Half</a> i = 0; i &lt; Header-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a43fa0c51b15fb5acca4fa91275da8154">e_shnum</a>; i++)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *shdr = <a class="code" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a>(Header, i);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">switch</span> (shdr-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a20b1ca3674936878ca6a909802c0a3fd">sh_type</a>)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#ac66207c7e7e0fab7248858c17aa1b194a9687fbf26fec535564003c8b7fdf7054">SHT_SYMTAB</a>:</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                SymbolTable = shdr;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                StringTable = <a class="code" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a>(Header, shdr-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a301574a5d9476946ac3e6a2416a46a82">sh_link</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">if</span> (SymbolTable == <span class="keyword">nullptr</span> || StringTable == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; (SymbolTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a> / <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a>)); i++)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">Elf64_Sym</a> *Symbol = (<a class="code" href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">Elf64_Sym</a> *)((<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)Header + SymbolTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a> + (i * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a>)));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordtype">char</span> *String = (<span class="keywordtype">char</span> *)((<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)Header + StringTable-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a> + Symbol-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a5db6c4acfde404ba93d5f6de48c2b330">st_name</a>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/d82/convert_8h.html#a5206cb6f52495066146ae3a41d166eb7">strcmp</a>(String, <a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a>) == 0)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="keywordflow">return</span> Symbol;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="ttc" id="aelf_8h_html_a43fa0c51b15fb5acca4fa91275da8154"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a43fa0c51b15fb5acca4fa91275da8154">elf64_hdr::e_shnum</a></div><div class="ttdeci">Elf64_Half e_shnum</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00611">elf.h:611</a></div></div>
<div class="ttc" id="aelf_8h_html_a444e910ff0ecd13df9478b60951f4eee"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a></div><div class="ttdeci">struct elf64_sym Elf64_Sym</div></div>
<div class="ttc" id="aelf_8h_html_a5db6c4acfde404ba93d5f6de48c2b330"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a5db6c4acfde404ba93d5f6de48c2b330">elf64_sym::st_name</a></div><div class="ttdeci">Elf64_Word st_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00691">elf.h:691</a></div></div>
<div class="ttc" id="aelf_8h_html_ac66207c7e7e0fab7248858c17aa1b194a9687fbf26fec535564003c8b7fdf7054"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ac66207c7e7e0fab7248858c17aa1b194a9687fbf26fec535564003c8b7fdf7054">SHT_SYMTAB</a></div><div class="ttdeci">@ SHT_SYMTAB</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00543">elf.h:543</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00611">elf64_hdr::e_shnum</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00042">GetELFSection()</a>, <a class="el" href="../../d7/dfc/cpu_8cpp_source.html#l00062">CPU::Name()</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00637">elf64_shdr::sh_link</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00635">elf64_shdr::sh_offset</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00636">elf64_shdr::sh_size</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00632">elf64_shdr::sh_type</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00543">SHT_SYMTAB</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00691">elf64_sym::st_name</a>, and <a class="el" href="../../d3/d68/convert_8cpp_source.html#l00123">strcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00160">ELFGetSymbolValue()</a>, and <a class="el" href="../../d7/d8e/elf__loader_8cpp_source.html#l00254">Execute::ELFObject::LoadDyn_x86_64()</a>.</p>

</div>
</div>
<a id="a208160ff41b6dcf8a704c735933f9c1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208160ff41b6dcf8a704c735933f9c1a">&#9670;&nbsp;</a></span>ELFLookupSymbol() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a> Execute::ELFLookupSymbol </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>Name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00096">96</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#if defined(a64)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        off_t OldOffset = <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a> Header;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, 0, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;Header, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#da/d7b/structelf64__hdr">Elf64_Ehdr</a>));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> SymbolTable;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> StringTable;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d9e/elf_8h.html#adb6a5584018b431da3472e7c6a7fd731">Elf64_Half</a> i = 0; i &lt; Header.e_shnum; i++)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> shdr;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, Header.e_shoff + (i * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a>)), <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;shdr, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a>));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">switch</span> (shdr.sh_type)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#ac66207c7e7e0fab7248858c17aa1b194a9687fbf26fec535564003c8b7fdf7054">SHT_SYMTAB</a>:</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                SymbolTable = shdr;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, Header.e_shoff + (shdr.sh_link * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a>)), <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;StringTable, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">if</span> (SymbolTable.<a class="code" href="../../d1/d9e/elf_8h.html#ae56bb6db99f7bbec64618c0d95e07f83">sh_name</a> == 0 ||</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            StringTable.<a class="code" href="../../d1/d9e/elf_8h.html#ae56bb6db99f7bbec64618c0d95e07f83">sh_name</a> == 0)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Symbol table not found.&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, OldOffset, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; (SymbolTable.<a class="code" href="../../d1/d9e/elf_8h.html#a1e9054001e3e7d1284d051ad1291e4a4">sh_size</a> / <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#a444e910ff0ecd13df9478b60951f4eee">Elf64_Sym</a>)); i++)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="comment">// Elf64_Sym *Symbol = (Elf64_Sym *)((uintptr_t)Header + SymbolTable-&gt;sh_offset + (i * sizeof(Elf64_Sym)));</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">Elf64_Sym</a> Symbol;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, SymbolTable.<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a> + (i * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">Elf64_Sym</a>)), <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;Symbol, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#d8/d92/structelf64__sym">Elf64_Sym</a>));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="comment">// char *String = (char *)((uintptr_t)Header + StringTable-&gt;sh_offset + Symbol-&gt;st_name);</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordtype">char</span> String[256];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, StringTable.<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a> + Symbol.st_name, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;String, 256);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/d82/convert_8h.html#a5206cb6f52495066146ae3a41d166eb7">strcmp</a>(String, <a class="code" href="../../d7/dfa/namespaceCPU.html#aa2666633b57974db680ea4f94c98f510">Name</a>) == 0)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, OldOffset, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="keywordflow">return</span> Symbol;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Symbol not found.&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, OldOffset, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="ttc" id="aelf_8h_html_ae56bb6db99f7bbec64618c0d95e07f83"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ae56bb6db99f7bbec64618c0d95e07f83">elf64_shdr::sh_name</a></div><div class="ttdeci">Elf64_Word sh_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00631">elf.h:631</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00611">elf64_hdr::e_shnum</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00605">elf64_hdr::e_shoff</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00086">error</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00055">fread()</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00088">lseek()</a>, <a class="el" href="../../d7/dfc/cpu_8cpp_source.html#l00062">CPU::Name()</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00031">SEEK_CUR</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00030">SEEK_SET</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00637">elf64_shdr::sh_link</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00631">elf64_shdr::sh_name</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00635">elf64_shdr::sh_offset</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00636">elf64_shdr::sh_size</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00632">elf64_shdr::sh_type</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00543">SHT_SYMTAB</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00691">elf64_sym::st_name</a>, and <a class="el" href="../../d3/d68/convert_8cpp_source.html#l00123">strcmp()</a>.</p>

</div>
</div>
<a id="a7660dbbcb09b7326abe3631cd98fc2ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7660dbbcb09b7326abe3631cd98fc2ca">&#9670;&nbsp;</a></span>GetBinaryType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfef">BinaryType</a> Execute::GetBinaryType </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>Path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/da6/binary__parse_8cpp_source.html#l00027">27</a> of file <a class="el" href="../../d6/da6/binary__parse_8cpp_source.html">binary_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfef">BinaryType</a> <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordtype">int</span> fd = <a class="code" href="../../d1/d85/filesystem_8hpp.html#ae2ec3b9037ed12c33f4f7327099f615c">fopen</a>(Path, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfef">BinaryType</a>)fd;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;File opened: %s, descriptor %d&quot;</span>, Path, fd);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html">Memory::SmartHeap</a> sh = <a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html">Memory::SmartHeap</a>(1024);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, sh, 128);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="../../d2/ddc/structFex.html">Fex</a> *FexHdr = (<a class="code" href="../../d2/ddc/structFex.html">Fex</a> *)sh.<a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html#a9a8c00f62d79439d1ce9fa10af1f6242">Get</a>();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="../../d1/d9e/elf_8h.html#dd/d18/structelf32__hdr">Elf32_Ehdr</a> *ELFHeader = (<a class="code" href="../../d1/d9e/elf_8h.html#dd/d18/structelf32__hdr">Elf32_Ehdr</a> *)sh.<a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html#a9a8c00f62d79439d1ce9fa10af1f6242">Get</a>();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="../../de/d63/msexec_8h.html#d2/d81/struct__IMAGE__DOS__HEADER">IMAGE_DOS_HEADER</a> *MZHeader = (<a class="code" href="../../de/d63/msexec_8h.html#d2/d81/struct__IMAGE__DOS__HEADER">IMAGE_DOS_HEADER</a> *)sh.<a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html#a9a8c00f62d79439d1ce9fa10af1f6242">Get</a>();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">/* Check Fex header. */</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span> (FexHdr-&gt;<a class="code" href="../../d2/ddc/structFex.html#a7f6b232e6357e3e651ff3862884d7aab">Magic</a>[0] == <span class="charliteral">&#39;F&#39;</span> &amp;&amp;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            FexHdr-&gt;<a class="code" href="../../d2/ddc/structFex.html#a7f6b232e6357e3e651ff3862884d7aab">Magic</a>[1] == <span class="charliteral">&#39;E&#39;</span> &amp;&amp;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            FexHdr-&gt;<a class="code" href="../../d2/ddc/structFex.html#a7f6b232e6357e3e651ff3862884d7aab">Magic</a>[2] == <span class="charliteral">&#39;X&#39;</span> &amp;&amp;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            FexHdr-&gt;<a class="code" href="../../d2/ddc/structFex.html#a7f6b232e6357e3e651ff3862884d7aab">Magic</a>[3] == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="comment">/* If the fex type is driver, we shouldn&#39;t return as Fex. */</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">if</span> (FexHdr-&gt;<a class="code" href="../../d2/ddc/structFex.html#ab64d62820368ba2d491c0d3a4f8f64f7">Type</a> == <a class="code" href="../../d0/da5/Fex_8hpp.html#a4564a233d1c439c8083525ef1103e9c8a90367fbd47bbac5cea7a998374a1c785">FexFormatType_Executable</a>)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Image - Fex&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a> = <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa4d86e9673c01f19bd31f096c363cf976">BinaryType::BinTypeFex</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <span class="keywordflow">goto</span> Success;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FexHdr-&gt;<a class="code" href="../../d2/ddc/structFex.html#ab64d62820368ba2d491c0d3a4f8f64f7">Type</a> == <a class="code" href="../../d0/da5/Fex_8hpp.html#a4564a233d1c439c8083525ef1103e9c8a02320cb8a8f5f768df99a00dbb3cd540">FexFormatType_Module</a>)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;Fex Module is not supposed to be executed.&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <span class="comment">/* TODO: Module installation pop-up. */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">/* Check ELF header. */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ELFHeader-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a0575bb9bb6c40328de8ac17bdd9a9571">e_ident</a>[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a9a7fd99466c93eee3068eaceff295122">EI_MAG0</a>] == <a class="code" href="../../d1/d9e/elf_8h.html#a2ae7ae1a6df04e0ed6be07b94590686e">ELFMAG0</a> &amp;&amp;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                 ELFHeader-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a0575bb9bb6c40328de8ac17bdd9a9571">e_ident</a>[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a3ba40c8906a48eae2c7854136dcd4034">EI_MAG1</a>] == <a class="code" href="../../d1/d9e/elf_8h.html#a6237b3c20ffd799df7b9a91ab3bbdff4">ELFMAG1</a> &amp;&amp;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                 ELFHeader-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a0575bb9bb6c40328de8ac17bdd9a9571">e_ident</a>[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235afc58ff9022804936a5111c36b1f8edba">EI_MAG2</a>] == <a class="code" href="../../d1/d9e/elf_8h.html#a8ac1b98d78e30ca49e1d3f287939a18f">ELFMAG2</a> &amp;&amp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                 ELFHeader-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#a0575bb9bb6c40328de8ac17bdd9a9571">e_ident</a>[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235aa0d2230d00a94866e6bd6045c8d68e82">EI_MAG3</a>] == <a class="code" href="../../d1/d9e/elf_8h.html#a2beeae5974769f72da5f63dcbcc325fe">ELFMAG3</a>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Image - ELF&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a> = <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa6928c465385d0a26e049a88b34a524f4">BinaryType::BinTypeELF</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">goto</span> Success;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">/* Check MZ header. */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MZHeader-&gt;<a class="code" href="../../de/d63/msexec_8h.html#a9cadd0c24aa3dfa4ab362153b45691d4">e_magic</a> == <a class="code" href="../../de/d63/msexec_8h.html#acde26d24b0ff46215cbd029d8ae87e4d">IMAGE_DOS_SIGNATURE</a>)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a8bd74caed008a66808d92d57fa74d9f6">lseek</a>(fd, MZHeader-&gt;<a class="code" href="../../de/d63/msexec_8h.html#ac08402468d27b9416d201300f2ce3f7f">e_lfanew</a>, <a class="code" href="../../d1/d85/filesystem_8hpp.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, sh, 512);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="../../de/d63/msexec_8h.html#dc/de5/struct__IMAGE__NT__HEADERS">IMAGE_NT_HEADERS</a> *PEHeader =</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                (<a class="code" href="../../de/d63/msexec_8h.html#dc/de5/struct__IMAGE__NT__HEADERS">IMAGE_NT_HEADERS</a> *)(((<span class="keywordtype">char</span> *)sh.<a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html#a9a8c00f62d79439d1ce9fa10af1f6242">Get</a>()) +</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                     MZHeader-&gt;<a class="code" href="../../de/d63/msexec_8h.html#ac08402468d27b9416d201300f2ce3f7f">e_lfanew</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <a class="code" href="../../de/d63/msexec_8h.html#d3/dac/struct__IMAGE__OS2__HEADER">IMAGE_OS2_HEADER</a> *NEHeader =</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                (<a class="code" href="../../de/d63/msexec_8h.html#d3/dac/struct__IMAGE__OS2__HEADER">IMAGE_OS2_HEADER</a> *)(((<span class="keywordtype">char</span> *)sh.<a class="code" href="../../d5/ddc/classMemory_1_1SmartHeap.html#a9a8c00f62d79439d1ce9fa10af1f6242">Get</a>()) +</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                     MZHeader-&gt;<a class="code" href="../../de/d63/msexec_8h.html#ac08402468d27b9416d201300f2ce3f7f">e_lfanew</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="comment">/* TODO: LE, EDOS */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">if</span> (PEHeader-&gt;<a class="code" href="../../de/d63/msexec_8h.html#a515a5bd93ec96008f1ac61555ada3cfe">Signature</a> == <a class="code" href="../../de/d63/msexec_8h.html#a83570e3e2fba8cb7c2abc8b3eee47d48">IMAGE_NT_SIGNATURE</a>)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Image - PE&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a> = <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefad046408a5647cdbf181157853f1ed4f1">BinaryType::BinTypePE</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">goto</span> Success;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NEHeader-&gt;<a class="code" href="../../de/d63/msexec_8h.html#a0c8a746afc5a83c53c23a0b0711a7707">ne_magic</a> == <a class="code" href="../../de/d63/msexec_8h.html#a9d186034e0a154cfc3bcc5ec8e977564">IMAGE_OS2_SIGNATURE</a>)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Image - NE&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a> = <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa7b9fe36e6e4a575b5550167eab17a9c8">BinaryType::BinTypeNE</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <span class="keywordflow">goto</span> Success;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Image - MZ&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a> = <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa5a4c06cd75836ac8ec916a8341a18366">BinaryType::BinTypeMZ</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">goto</span> Success;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">/* ... */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a> = <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefafc199be97ad89f843f5914678a8285d4">BinaryType::BinTypeUnknown</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    Success:</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a>(fd);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="ttc" id="aFex_8hpp_html_a4564a233d1c439c8083525ef1103e9c8a02320cb8a8f5f768df99a00dbb3cd540"><div class="ttname"><a href="../../d0/da5/Fex_8hpp.html#a4564a233d1c439c8083525ef1103e9c8a02320cb8a8f5f768df99a00dbb3cd540">FexFormatType_Module</a></div><div class="ttdeci">@ FexFormatType_Module</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da5/Fex_8hpp_source.html#l00055">Fex.hpp:53</a></div></div>
<div class="ttc" id="aFex_8hpp_html_a4564a233d1c439c8083525ef1103e9c8a90367fbd47bbac5cea7a998374a1c785"><div class="ttname"><a href="../../d0/da5/Fex_8hpp.html#a4564a233d1c439c8083525ef1103e9c8a90367fbd47bbac5cea7a998374a1c785">FexFormatType_Executable</a></div><div class="ttdeci">@ FexFormatType_Executable</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da5/Fex_8hpp_source.html#l00052">Fex.hpp:52</a></div></div>
<div class="ttc" id="aFex_8hpp_html_a875f6ae629219a43a4a631840c1cbaba"><div class="ttname"><a href="../../d0/da5/Fex_8hpp.html#a875f6ae629219a43a4a631840c1cbaba">Type</a></div><div class="ttdeci">enum FexFormatType Type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da5/Fex_8hpp_source.html#l00000">Fex.hpp:1</a></div></div>
<div class="ttc" id="aclassMemory_1_1SmartHeap_html"><div class="ttname"><a href="../../d5/ddc/classMemory_1_1SmartHeap.html">Memory::SmartHeap</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/smart__heap_8hpp_source.html#l00028">smart_heap.hpp:29</a></div></div>
<div class="ttc" id="aclassMemory_1_1SmartHeap_html_a9a8c00f62d79439d1ce9fa10af1f6242"><div class="ttname"><a href="../../d5/ddc/classMemory_1_1SmartHeap.html#a9a8c00f62d79439d1ce9fa10af1f6242">Memory::SmartHeap::Get</a></div><div class="ttdeci">auto Get()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/smart__heap_8hpp_source.html#l00036">smart_heap.hpp:36</a></div></div>
<div class="ttc" id="adebug_8h_html_abd4acaf7c67bd126aefd672fbbd5747f"><div class="ttname"><a href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a></div><div class="ttdeci">#define fixme(Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00099">debug.h:99</a></div></div>
<div class="ttc" id="aelf_8h_html_a2ae7ae1a6df04e0ed6be07b94590686e"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a2ae7ae1a6df04e0ed6be07b94590686e">ELFMAG0</a></div><div class="ttdeci">#define ELFMAG0</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00525">elf.h:525</a></div></div>
<div class="ttc" id="aelf_8h_html_a2beeae5974769f72da5f63dcbcc325fe"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a2beeae5974769f72da5f63dcbcc325fe">ELFMAG3</a></div><div class="ttdeci">#define ELFMAG3</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00528">elf.h:528</a></div></div>
<div class="ttc" id="aelf_8h_html_a540f96e9e651e74266e0bd74e0f52235a3ba40c8906a48eae2c7854136dcd4034"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a3ba40c8906a48eae2c7854136dcd4034">EI_MAG1</a></div><div class="ttdeci">@ EI_MAG1</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00043">elf.h:43</a></div></div>
<div class="ttc" id="aelf_8h_html_a540f96e9e651e74266e0bd74e0f52235a9a7fd99466c93eee3068eaceff295122"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a9a7fd99466c93eee3068eaceff295122">EI_MAG0</a></div><div class="ttdeci">@ EI_MAG0</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00042">elf.h:42</a></div></div>
<div class="ttc" id="aelf_8h_html_a540f96e9e651e74266e0bd74e0f52235aa0d2230d00a94866e6bd6045c8d68e82"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235aa0d2230d00a94866e6bd6045c8d68e82">EI_MAG3</a></div><div class="ttdeci">@ EI_MAG3</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00045">elf.h:45</a></div></div>
<div class="ttc" id="aelf_8h_html_a540f96e9e651e74266e0bd74e0f52235afc58ff9022804936a5111c36b1f8edba"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235afc58ff9022804936a5111c36b1f8edba">EI_MAG2</a></div><div class="ttdeci">@ EI_MAG2</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00044">elf.h:44</a></div></div>
<div class="ttc" id="aelf_8h_html_a6237b3c20ffd799df7b9a91ab3bbdff4"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a6237b3c20ffd799df7b9a91ab3bbdff4">ELFMAG1</a></div><div class="ttdeci">#define ELFMAG1</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00526">elf.h:526</a></div></div>
<div class="ttc" id="aelf_8h_html_a8ac1b98d78e30ca49e1d3f287939a18f"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a8ac1b98d78e30ca49e1d3f287939a18f">ELFMAG2</a></div><div class="ttdeci">#define ELFMAG2</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00527">elf.h:527</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_a575cfdaca3a77c3f910df16d56d7240c"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a></div><div class="ttdeci">int fclose(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5c/kernel__io_8cpp_source.html#l00077">kernel_io.cpp:77</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_ae2ec3b9037ed12c33f4f7327099f615c"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#ae2ec3b9037ed12c33f4f7327099f615c">fopen</a></div><div class="ttdeci">int fopen(const char *pathname, const char *mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5c/kernel__io_8cpp_source.html#l00033">kernel_io.cpp:33</a></div></div>
<div class="ttc" id="amsexec_8h_html_a0c8a746afc5a83c53c23a0b0711a7707"><div class="ttname"><a href="../../de/d63/msexec_8h.html#a0c8a746afc5a83c53c23a0b0711a7707">_IMAGE_OS2_HEADER::ne_magic</a></div><div class="ttdeci">USHORT ne_magic</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00138">msexec.h:138</a></div></div>
<div class="ttc" id="amsexec_8h_html_a515a5bd93ec96008f1ac61555ada3cfe"><div class="ttname"><a href="../../de/d63/msexec_8h.html#a515a5bd93ec96008f1ac61555ada3cfe">_IMAGE_NT_HEADERS::Signature</a></div><div class="ttdeci">uint32_t Signature</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00243">msexec.h:243</a></div></div>
<div class="ttc" id="amsexec_8h_html_a83570e3e2fba8cb7c2abc8b3eee47d48"><div class="ttname"><a href="../../de/d63/msexec_8h.html#a83570e3e2fba8cb7c2abc8b3eee47d48">IMAGE_NT_SIGNATURE</a></div><div class="ttdeci">#define IMAGE_NT_SIGNATURE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00068">msexec.h:68</a></div></div>
<div class="ttc" id="amsexec_8h_html_a9cadd0c24aa3dfa4ab362153b45691d4"><div class="ttname"><a href="../../de/d63/msexec_8h.html#a9cadd0c24aa3dfa4ab362153b45691d4">_IMAGE_DOS_HEADER::e_magic</a></div><div class="ttdeci">USHORT e_magic</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00115">msexec.h:115</a></div></div>
<div class="ttc" id="amsexec_8h_html_a9d186034e0a154cfc3bcc5ec8e977564"><div class="ttname"><a href="../../de/d63/msexec_8h.html#a9d186034e0a154cfc3bcc5ec8e977564">IMAGE_OS2_SIGNATURE</a></div><div class="ttdeci">#define IMAGE_OS2_SIGNATURE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00066">msexec.h:66</a></div></div>
<div class="ttc" id="amsexec_8h_html_ac08402468d27b9416d201300f2ce3f7f"><div class="ttname"><a href="../../de/d63/msexec_8h.html#ac08402468d27b9416d201300f2ce3f7f">_IMAGE_DOS_HEADER::e_lfanew</a></div><div class="ttdeci">USHORT e_lfanew</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00133">msexec.h:133</a></div></div>
<div class="ttc" id="amsexec_8h_html_acde26d24b0ff46215cbd029d8ae87e4d"><div class="ttname"><a href="../../de/d63/msexec_8h.html#acde26d24b0ff46215cbd029d8ae87e4d">IMAGE_DOS_SIGNATURE</a></div><div class="ttdeci">#define IMAGE_DOS_SIGNATURE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00065">msexec.h:65</a></div></div>
<div class="ttc" id="amsexec_8h_html_d2/d81/struct__IMAGE__DOS__HEADER"><div class="ttname"><a href="../../de/d63/msexec_8h.html#d2/d81/struct__IMAGE__DOS__HEADER">_IMAGE_DOS_HEADER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00113">msexec.h:114</a></div></div>
<div class="ttc" id="amsexec_8h_html_d3/dac/struct__IMAGE__OS2__HEADER"><div class="ttname"><a href="../../de/d63/msexec_8h.html#d3/dac/struct__IMAGE__OS2__HEADER">_IMAGE_OS2_HEADER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00136">msexec.h:137</a></div></div>
<div class="ttc" id="amsexec_8h_html_dc/de5/struct__IMAGE__NT__HEADERS"><div class="ttname"><a href="../../de/d63/msexec_8h.html#dc/de5/struct__IMAGE__NT__HEADERS">_IMAGE_NT_HEADERS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/msexec_8h_source.html#l00241">msexec.h:242</a></div></div>
<div class="ttc" id="anamespaceExecute_html_af4e1abcc5b1e4823d6a344e90bd6dfef"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfef">Execute::BinaryType</a></div><div class="ttdeci">BinaryType</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/exec_8hpp_source.html#l00032">exec.hpp:33</a></div></div>
<div class="ttc" id="astructFex_html"><div class="ttname"><a href="../../d2/ddc/structFex.html">Fex</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da5/Fex_8hpp_source.html#l00087">Fex.hpp:88</a></div></div>
<div class="ttc" id="astructFex_html_a7f6b232e6357e3e651ff3862884d7aab"><div class="ttname"><a href="../../d2/ddc/structFex.html#a7f6b232e6357e3e651ff3862884d7aab">Fex::Magic</a></div><div class="ttdeci">char Magic[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da5/Fex_8hpp_source.html#l00089">Fex.hpp:89</a></div></div>
<div class="ttc" id="astructFex_html_ab64d62820368ba2d491c0d3a4f8f64f7"><div class="ttname"><a href="../../d2/ddc/structFex.html#ab64d62820368ba2d491c0d3a4f8f64f7">Fex::Type</a></div><div class="ttdeci">enum FexFormatType Type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da5/Fex_8hpp_source.html#l00089">Fex.hpp:90</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00036">BinTypeELF</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00035">BinTypeFex</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00039">BinTypeMZ</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00038">BinTypeNE</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00037">BinTypePE</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00040">BinTypeUnknown</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00094">debug</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00581">elf32_hdr::e_ident</a>, <a class="el" href="../../de/d63/msexec_8h_source.html#l00133">_IMAGE_DOS_HEADER::e_lfanew</a>, <a class="el" href="../../de/d63/msexec_8h_source.html#l00115">_IMAGE_DOS_HEADER::e_magic</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00042">EI_MAG0</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00043">EI_MAG1</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00044">EI_MAG2</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00045">EI_MAG3</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00525">ELFMAG0</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00526">ELFMAG1</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00527">ELFMAG2</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00528">ELFMAG3</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00077">fclose()</a>, <a class="el" href="../../d0/da5/Fex_8hpp_source.html#l00052">FexFormatType_Executable</a>, <a class="el" href="../../d0/da5/Fex_8hpp_source.html#l00053">FexFormatType_Module</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00099">fixme</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00033">fopen()</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00055">fread()</a>, <a class="el" href="../../d9/d35/smart__heap_8hpp_source.html#l00036">Memory::SmartHeap::Get()</a>, <a class="el" href="../../de/d63/msexec_8h_source.html#l00065">IMAGE_DOS_SIGNATURE</a>, <a class="el" href="../../de/d63/msexec_8h_source.html#l00068">IMAGE_NT_SIGNATURE</a>, <a class="el" href="../../de/d63/msexec_8h_source.html#l00066">IMAGE_OS2_SIGNATURE</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00088">lseek()</a>, <a class="el" href="../../d0/da5/Fex_8hpp_source.html#l00089">Fex::Magic</a>, <a class="el" href="../../de/d63/msexec_8h_source.html#l00138">_IMAGE_OS2_HEADER::ne_magic</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00030">SEEK_SET</a>, <a class="el" href="../../de/d63/msexec_8h_source.html#l00243">_IMAGE_NT_HEADERS::Signature</a>, <a class="el" href="../../d0/da5/Fex_8hpp_source.html#l00001">Type</a>, and <a class="el" href="../../d0/da5/Fex_8hpp_source.html#l00090">Fex::Type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d8e/elf__loader_8cpp_source.html#l00741">Execute::ELFObject::ELFObject()</a>, <a class="el" href="../../d7/d8e/elf__loader_8cpp_source.html#l00254">Execute::ELFObject::LoadDyn_x86_64()</a>, <a class="el" href="../../d7/d8e/elf__loader_8cpp_source.html#l00122">Execute::ELFObject::LoadExec_x86_64()</a>, and <a class="el" href="../../d5/d9b/spawn_8cpp_source.html#l00034">Spawn()</a>.</p>

</div>
</div>
<a id="ad4527c193949a102a6793a17f1e2fb45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4527c193949a102a6793a17f1e2fb45">&#9670;&nbsp;</a></span>GetELFSection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d9e/elf_8h.html#ae1c4a562108c5d4dbccc19966145a77f">Elf64_Shdr</a> * Execute::GetELFSection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>Header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/ddd/arithmetic__operations_8c.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a>&#160;</td>
          <td class="paramname"><em>Index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00042">42</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">return</span> &amp;<a class="code" href="../../d5/d27/namespaceExecute.html#a31dfd87b6fa1ef7beaa37ed956b34097">GetELFSheader</a>(Header)[Index];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00037">GetELFSheader()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00160">ELFGetSymbolValue()</a>, <a class="el" href="../../d2/d82/elf__rel_8cpp_source.html#l00029">ELFLoadRel()</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00062">ELFLookupSymbol()</a>, and <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00047">GetELFStringTable()</a>.</p>

</div>
</div>
<a id="a31dfd87b6fa1ef7beaa37ed956b34097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31dfd87b6fa1ef7beaa37ed956b34097">&#9670;&nbsp;</a></span>GetELFSheader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d9e/elf_8h.html#ae1c4a562108c5d4dbccc19966145a77f">Elf64_Shdr</a> * Execute::GetELFSheader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>Header</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00037">37</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="../../d1/d9e/elf_8h.html#d3/d22/structelf64__shdr">Elf64_Shdr</a> *)((<a class="code" href="../../d6/de6/include_2types_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>)Header + Header-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#adbf80ace75d46820117f58618b5f2870">e_shoff</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="ttc" id="aelf_8h_html_adbf80ace75d46820117f58618b5f2870"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#adbf80ace75d46820117f58618b5f2870">elf64_hdr::e_shoff</a></div><div class="ttdeci">Elf64_Off e_shoff</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00605">elf.h:605</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00605">elf64_hdr::e_shoff</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d82/elf__rel_8cpp_source.html#l00029">ELFLoadRel()</a>, and <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00042">GetELFSection()</a>.</p>

</div>
</div>
<a id="a4d3d0d454ea84db99c805b1ed826f8d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d3d0d454ea84db99c805b1ed826f8d8">&#9670;&nbsp;</a></span>GetELFStringTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * Execute::GetELFStringTable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d9e/elf_8h.html#af59c9cc8cec9316330f757a0fbd79956">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>Header</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html">elf_parse.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">if</span> (Header-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#aca6991f9d3d4452c42d43ec1c7081c7d">e_shstrndx</a> == <a class="code" href="../../d1/d9e/elf_8h.html#ab2f25695673c5f1c4ec723e595288411">SHN_UNDEF</a>)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *)Header + <a class="code" href="../../d5/d27/namespaceExecute.html#ad4527c193949a102a6793a17f1e2fb45">GetELFSection</a>(Header, Header-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#aca6991f9d3d4452c42d43ec1c7081c7d">e_shstrndx</a>)-&gt;<a class="code" href="../../d1/d9e/elf_8h.html#abb068619f9fae94dc5cd7ec6eacd4c42">sh_offset</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="ttc" id="aelf_8h_html_aca6991f9d3d4452c42d43ec1c7081c7d"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#aca6991f9d3d4452c42d43ec1c7081c7d">elf64_hdr::e_shstrndx</a></div><div class="ttdeci">Elf64_Half e_shstrndx</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00612">elf.h:612</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d9e/elf_8h_source.html#l00612">elf64_hdr::e_shstrndx</a>, <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00042">GetELFSection()</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00635">elf64_shdr::sh_offset</a>, and <a class="el" href="../../d1/d9e/elf_8h_source.html#l00332">SHN_UNDEF</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db6/elf__parse_8cpp_source.html#l00054">ELFLookupString()</a>.</p>

</div>
</div>
<a id="a3b3cfddf6a8ff694736f944c401c5ee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b3cfddf6a8ff694736f944c401c5ee0">&#9670;&nbsp;</a></span>Spawn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Execute::Spawn </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>envp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a> *&#160;</td>
          <td class="paramname"><em>Parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d3e/namespaceTasking.html#acdb977b9f386c7a7662877c8b0532d48">Tasking::TaskCompatibility</a>&#160;</td>
          <td class="paramname"><em>Compatibility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/de6/include_2types_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>Critical</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d9b/spawn_8cpp_source.html#l00034">34</a> of file <a class="el" href="../../d5/d9b/spawn_8cpp_source.html">spawn.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordtype">int</span> fd = <a class="code" href="../../d1/d85/filesystem_8hpp.html#ae2ec3b9037ed12c33f4f7327099f615c">fopen</a>(Path, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">if</span> (fd &lt; 0)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keywordflow">return</span> fd;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d1/d85/filesystem_8hpp.html#da/de7/structstat">stat</a> statbuf;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a27628bfab8ccdd0fdeed6778b25cd734">fstat</a>(fd, &amp;statbuf);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d85/filesystem_8hpp.html#aad0f32c2c182238f2ff71c83e6ab65a0">S_ISREG</a>(statbuf.st_mode))</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a>(fd);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#ae22c3a1e0a38f3896de238cc30d0e19b">EISDIR</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="../../d5/d27/namespaceExecute.html#a7660dbbcb09b7326abe3631cd98fc2ca">GetBinaryType</a>(Path))</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa4d86e9673c01f19bd31f096c363cf976">BinaryType::BinTypeFex</a>:</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <a class="code" href="../../d2/ddc/structFex.html">Fex</a> FexHdr;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;FexHdr, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/ddc/structFex.html">Fex</a>));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">if</span> (FexHdr.Type == <a class="code" href="../../d0/da5/Fex_8hpp.html#a4564a233d1c439c8083525ef1103e9c8a90367fbd47bbac5cea7a998374a1c785">FexFormatType::FexFormatType_Executable</a>)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a5daca020dc132cf1c649ba9beb4ca63d">stub</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <a class="code" href="../../dc/da7/assert_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a>(fd);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a4d0b1b435ec441e7d50a430b83df5832">ENOEXEC</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d5/d27/namespaceExecute.html#af4e1abcc5b1e4823d6a344e90bd6dfefa6928c465385d0a26e049a88b34a524f4">BinaryType::BinTypeELF</a>:</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <a class="code" href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302">TaskArchitecture</a> Arch = <a class="code" href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a5b2a90cc96dd262a5f1d340deaa28628">TaskArchitecture::UnknownArchitecture</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *BaseName;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="../../da/d7d/cwalk_8h.html#aa5e93482b11e37af62bb9f605c8866a0">cwk_path_get_basename</a>(Path, &amp;BaseName, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <a class="code" href="../../d1/d9e/elf_8h.html#dd/d18/structelf32__hdr">Elf32_Ehdr</a> ELFHeader;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)&amp;ELFHeader, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9e/elf_8h.html#dd/d18/structelf32__hdr">Elf32_Ehdr</a>));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">switch</span> (ELFHeader.e_machine)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#a77301c665274669ba8d05978eb0d299e">EM_386</a>:</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                Arch = <a class="code" href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a67026fb63dbef08d56b1cacef7d3e3ad">TaskArchitecture::x32</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#a23fd3947ed1cfe58469b045efb4bb418">EM_X86_64</a>:</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                Arch = <a class="code" href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a691951f7c582f9dff5d0d0d6a73392d4">TaskArchitecture::x64</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#ad8fac71aae0d2fbfab30f278a79c941a">EM_ARM</a>:</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                Arch = <a class="code" href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302ae006d492380a1b7ff26e7919abf0323f">TaskArchitecture::ARM32</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d1/d9e/elf_8h.html#ae7d928612b2d484d2ccfd58f50be7db4">EM_AARCH64</a>:</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                Arch = <a class="code" href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a45e4a36775610d48ea685dc5d44374de">TaskArchitecture::ARM64</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Unknown ELF architecture %d&quot;</span>,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                      ELFHeader.e_machine);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">// TODO: This shouldn&#39;t be ignored</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">if</span> (ELFHeader.e_ident[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235aac9b8531d68f60088b42d23a36c58417">EI_CLASS</a>] == <a class="code" href="../../d1/d9e/elf_8h.html#a5f84b1bf6e07374d6289eab3d8c57f1c">ELFCLASS32</a>)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;32-bit ELF&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ELFHeader.e_ident[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235aac9b8531d68f60088b42d23a36c58417">EI_CLASS</a>] == <a class="code" href="../../d1/d9e/elf_8h.html#a9ee66b59be5c78ea1f1eea8a36f2c291">ELFCLASS64</a>)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;64-bit ELF&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;Unknown class %d&quot;</span>, ELFHeader.e_ident[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235aac9b8531d68f60088b42d23a36c58417">EI_CLASS</a>]);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#if __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (ELFHeader.e_ident[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a671a6f529b41b34eab16914253b98b92">EI_DATA</a>] != <a class="code" href="../../d1/d9e/elf_8h.html#af66303c799da18c8aec282ea8592e7e7">ELFDATA2LSB</a>)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;ELF32 LSB expected, got %d&quot;</span>, ELFHeader.e_ident[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a671a6f529b41b34eab16914253b98b92">EI_DATA</a>]);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">if</span> (ELFHeader.e_ident[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a671a6f529b41b34eab16914253b98b92">EI_DATA</a>] != <a class="code" href="../../d1/d9e/elf_8h.html#a06385c3e5f0a3b62fae7f5e224e10f89">ELFDATA2MSB</a>)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#abd4acaf7c67bd126aefd672fbbd5747f">fixme</a>(<span class="stringliteral">&quot;ELF32 MSB expected, got %d&quot;</span>, ELFHeader.e_ident[<a class="code" href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a671a6f529b41b34eab16914253b98b92">EI_DATA</a>]);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">/* ------------------------------------------------------------------------------------------------------------------------------ */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordtype">void</span> *ElfFile = <a class="code" href="../../d8/d71/memory_8cpp.html#ad0bbf7b6012cd16abb06c03dd26ffbaf">KernelAllocator</a>.RequestPages(<a class="code" href="../../d4/dc3/macro_8hpp.html#a10029add9db6f0340d9bd2be9b2d1048">TO_PAGES</a>(statbuf.st_size + 1));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a59e6d0024b412f266839f22638916254">fread</a>(fd, (<a class="code" href="../../d6/de6/include_2types_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *)ElfFile, statbuf.st_size);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Loaded elf %s at %#lx with the length of %ld&quot;</span>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                  Path, ElfFile, statbuf.st_size);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">if</span> (Parent == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                Parent = <a class="code" href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="../../d6/d17/classTasking_1_1PCB.html">PCB</a> *Process = <a class="code" href="../../dd/d24/kernel_8cpp.html#a5a8d7736911609823f0ff8f3c8f51df2">TaskManager</a>-&gt;<a class="code" href="../../dc/dc5/classTasking_1_1Task.html#a32111fbbb04dfee771995a26712763f8">CreateProcess</a>(Parent,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                      BaseName,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                                      <a class="code" href="../../d9/d3e/namespaceTasking.html#a92f7bb81f1f9acf302df0a689c0c1253ab4361355ef5fe95d2d097e6250288db6">TaskExecutionMode::User</a>,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                                      ElfFile, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                      0, 0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <a class="code" href="../../d8/d71/memory_8cpp.html#ad0bbf7b6012cd16abb06c03dd26ffbaf">KernelAllocator</a>.FreePages(ElfFile, <a class="code" href="../../d4/dc3/macro_8hpp.html#a10029add9db6f0340d9bd2be9b2d1048">TO_PAGES</a>(statbuf.st_size + 1));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            Process-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a6beb09bb9903a9f9d92a6a6a21cec150">SetWorkingDirectory</a>(<a class="code" href="../../dd/d24/kernel_8cpp.html#a277679a5638e76b6fd08abe5deee2022">fs</a>-&gt;<a class="code" href="../../d8/d64/classvfs_1_1Virtual.html#acd2f13e6b8ada2d15edfe097501313b1">GetNodeFromPath</a>(Path)-&gt;<a class="code" href="../../df/d69/classvfs_1_1Node.html#a7a8144cdc433238661ad64905e7e0359">Parent</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            Process-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a887637de6f393b567a480ede30884446">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#a32ac6d7d295b6f35ec060e1fe50cf0f8">Compatibility</a> = <a class="code" href="../../d9/d3e/namespaceTasking.html#acdb977b9f386c7a7662877c8b0532d48aa485dedb3548655f59d3caacb6474ee9">TaskCompatibility::Native</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            Process-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#a887637de6f393b567a480ede30884446">Info</a>.<a class="code" href="../../d9/d3e/namespaceTasking.html#aabb3382fec35b68c33599188dd204e70">Architecture</a> = <a class="code" href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a691951f7c582f9dff5d0d0d6a73392d4">TaskArchitecture::x64</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            ELFObject *obj = <span class="keyword">new</span> ELFObject(Path, Process, argv, envp);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (!obj-&gt;IsValid)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <a class="code" href="../../db/d16/debug_8h.html#a65f6c7faf3bfe3937629a7a365e06574">error</a>(<span class="stringliteral">&quot;Failed to load ELF object&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a>(fd);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keyword">delete</span> Process;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a4d0b1b435ec441e7d50a430b83df5832">ENOEXEC</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="comment">/* FIXME: implement stdio fildes */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a> *fdt = Process-&gt;<a class="code" href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">FileDescriptors</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="comment">// stdin</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aad35936ac452cc80e3b56675e686f5a4">_open</a>(<span class="stringliteral">&quot;/dev/tty&quot;</span>, <a class="code" href="../../d1/d85/filesystem_8hpp.html#abb0586253488ee61072b73557eeb873b">O_RDWR</a>, 0666);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="comment">// stdout</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aad35936ac452cc80e3b56675e686f5a4">_open</a>(<span class="stringliteral">&quot;/dev/tty&quot;</span>, <a class="code" href="../../d1/d85/filesystem_8hpp.html#abb0586253488ee61072b73557eeb873b">O_RDWR</a>, 0666);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">// stderr</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            fdt-&gt;<a class="code" href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aad35936ac452cc80e3b56675e686f5a4">_open</a>(<span class="stringliteral">&quot;/dev/tty&quot;</span>, <a class="code" href="../../d1/d85/filesystem_8hpp.html#abb0586253488ee61072b73557eeb873b">O_RDWR</a>, 0666);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="../../da/daf/classTasking_1_1TCB.html">TCB</a> *Thread = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                CriticalSection cs;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                Thread = <a class="code" href="../../dd/d24/kernel_8cpp.html#a5a8d7736911609823f0ff8f3c8f51df2">TaskManager</a>-&gt;<a class="code" href="../../dc/dc5/classTasking_1_1Task.html#aa1ffdb4c6acbdfd1dbd9afb4914c2656">CreateThread</a>(Process,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                                   obj-&gt;InstructionPointer,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                                   obj-&gt;argv, obj-&gt;envp, obj-&gt;auxv,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                                   Arch,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                   Compatibility);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#a421fc4b87573abd0194625680c485864">SetCritical</a>(<a class="code" href="../../d9/d3e/namespaceTasking.html#a6e7b9a12601b9ef62ca79d6b801c29c8af573c84c26fd6678142533c8790ec736">Critical</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a>(fd);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">return</span> Thread-&gt;<a class="code" href="../../da/daf/classTasking_1_1TCB.html#ac9c92137d88ac3b7ac0a88f042a05e9b">ID</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="../../db/d16/debug_8h.html#a31e7d5c5946947277dce12f2584e7a43">debug</a>(<span class="stringliteral">&quot;Unknown binary type: %d&quot;</span>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                  <a class="code" href="../../d5/d27/namespaceExecute.html#a7660dbbcb09b7326abe3631cd98fc2ca">GetBinaryType</a>(Path));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a>(fd);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a4d0b1b435ec441e7d50a430b83df5832">ENOEXEC</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="../../d1/d85/filesystem_8hpp.html#a575cfdaca3a77c3f910df16d56d7240c">fclose</a>(fd);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="../../d8/dc2/errno_8h.html#a4d0b1b435ec441e7d50a430b83df5832">ENOEXEC</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="ttc" id="aassert_8h_html_af576bf8ffa22a44e53018c67095ffbf0"><div class="ttname"><a href="../../dc/da7/assert_8h.html#af576bf8ffa22a44e53018c67095ffbf0">assert</a></div><div class="ttdeci">#define assert(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da7/assert_8h_source.html#l00023">assert.h:23</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html">Tasking::PCB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00331">task.hpp:332</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a6beb09bb9903a9f9d92a6a6a21cec150"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a6beb09bb9903a9f9d92a6a6a21cec150">Tasking::PCB::SetWorkingDirectory</a></div><div class="ttdeci">void SetWorkingDirectory(Node *node)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d4c/process_8cpp_source.html#l00072">process.cpp:72</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_a887637de6f393b567a480ede30884446"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#a887637de6f393b567a480ede30884446">Tasking::PCB::Info</a></div><div class="ttdeci">TaskInfo Info</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00374">task.hpp:374</a></div></div>
<div class="ttc" id="aclassTasking_1_1PCB_html_aaf2f4c22bc6ba11ae549a3331d493d80"><div class="ttname"><a href="../../d6/d17/classTasking_1_1PCB.html#aaf2f4c22bc6ba11ae549a3331d493d80">Tasking::PCB::FileDescriptors</a></div><div class="ttdeci">FileDescriptorTable * FileDescriptors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00379">task.hpp:379</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html">Tasking::TCB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00220">task.hpp:221</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_a421fc4b87573abd0194625680c485864"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#a421fc4b87573abd0194625680c485864">Tasking::TCB::SetCritical</a></div><div class="ttdeci">void SetCritical(bool Critical)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d35/thread_8cpp_source.html#l00095">thread.cpp:95</a></div></div>
<div class="ttc" id="aclassTasking_1_1TCB_html_ac9c92137d88ac3b7ac0a88f042a05e9b"><div class="ttname"><a href="../../da/daf/classTasking_1_1TCB.html#ac9c92137d88ac3b7ac0a88f042a05e9b">Tasking::TCB::ID</a></div><div class="ttdeci">TID ID</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00253">task.hpp:253</a></div></div>
<div class="ttc" id="aclassTasking_1_1Task_html_a32111fbbb04dfee771995a26712763f8"><div class="ttname"><a href="../../dc/dc5/classTasking_1_1Task.html#a32111fbbb04dfee771995a26712763f8">Tasking::Task::CreateProcess</a></div><div class="ttdeci">PCB * CreateProcess(PCB *Parent, const char *Name, TaskExecutionMode TrustLevel, void *Image=nullptr, bool DoNotCreatePageTable=false, uint16_t UserID=UINT16_MAX, uint16_t GroupID=UINT16_MAX)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9c/task_8cpp_source.html#l00324">task.cpp:324</a></div></div>
<div class="ttc" id="aclassTasking_1_1Task_html_aa1ffdb4c6acbdfd1dbd9afb4914c2656"><div class="ttname"><a href="../../dc/dc5/classTasking_1_1Task.html#aa1ffdb4c6acbdfd1dbd9afb4914c2656">Tasking::Task::CreateThread</a></div><div class="ttdeci">TCB * CreateThread(PCB *Parent, IP EntryPoint, const char **argv=nullptr, const char **envp=nullptr, const std::vector&lt; AuxiliaryVector &gt; &amp;auxv=std::vector&lt; AuxiliaryVector &gt;(), TaskArchitecture Architecture=TaskArchitecture::x64, TaskCompatibility Compatibility=TaskCompatibility::Native, bool ThreadNotReady=false)</div></div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html">vfs::FileDescriptorTable</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00308">filesystem.hpp:309</a></div></div>
<div class="ttc" id="aclassvfs_1_1FileDescriptorTable_html_aad35936ac452cc80e3b56675e686f5a4"><div class="ttname"><a href="../../da/d88/classvfs_1_1FileDescriptorTable.html#aad35936ac452cc80e3b56675e686f5a4">vfs::FileDescriptorTable::_open</a></div><div class="ttdeci">int _open(const char *pathname, int flags, mode_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/file__descriptor_8cpp_source.html#l00314">file_descriptor.cpp:314</a></div></div>
<div class="ttc" id="aclassvfs_1_1Node_html_a7a8144cdc433238661ad64905e7e0359"><div class="ttname"><a href="../../df/d69/classvfs_1_1Node.html#a7a8144cdc433238661ad64905e7e0359">vfs::Node::Parent</a></div><div class="ttdeci">Node * Parent</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00187">filesystem.hpp:187</a></div></div>
<div class="ttc" id="aclassvfs_1_1Virtual_html_acd2f13e6b8ada2d15edfe097501313b1"><div class="ttname"><a href="../../d8/d64/classvfs_1_1Virtual.html#acd2f13e6b8ada2d15edfe097501313b1">vfs::Virtual::GetNodeFromPath</a></div><div class="ttdeci">Node * GetNodeFromPath(const char *Path, Node *Parent=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8f/filesystem_8cpp_source.html#l00112">filesystem.cpp:112</a></div></div>
<div class="ttc" id="acwalk_8h_html_aa5e93482b11e37af62bb9f605c8866a0"><div class="ttname"><a href="../../da/d7d/cwalk_8h.html#aa5e93482b11e37af62bb9f605c8866a0">cwk_path_get_basename</a></div><div class="ttdeci">CWK_PUBLIC void cwk_path_get_basename(const char *path, const char **basename, size_t *length)</div><div class="ttdoc">Gets the basename of a file path.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc4/cwalk_8c_source.html#l00942">cwalk.c:942</a></div></div>
<div class="ttc" id="adebug_8h_html_a5daca020dc132cf1c649ba9beb4ca63d"><div class="ttname"><a href="../../db/d16/debug_8h.html#a5daca020dc132cf1c649ba9beb4ca63d">stub</a></div><div class="ttdeci">#define stub</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00100">debug.h:100</a></div></div>
<div class="ttc" id="aelf_8h_html_a06385c3e5f0a3b62fae7f5e224e10f89"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a06385c3e5f0a3b62fae7f5e224e10f89">ELFDATA2MSB</a></div><div class="ttdeci">#define ELFDATA2MSB</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00532">elf.h:532</a></div></div>
<div class="ttc" id="aelf_8h_html_a23fd3947ed1cfe58469b045efb4bb418"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a23fd3947ed1cfe58469b045efb4bb418">EM_X86_64</a></div><div class="ttdeci">#define EM_X86_64</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00383">elf.h:383</a></div></div>
<div class="ttc" id="aelf_8h_html_a540f96e9e651e74266e0bd74e0f52235a671a6f529b41b34eab16914253b98b92"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a540f96e9e651e74266e0bd74e0f52235a671a6f529b41b34eab16914253b98b92">EI_DATA</a></div><div class="ttdeci">@ EI_DATA</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00047">elf.h:47</a></div></div>
<div class="ttc" id="aelf_8h_html_a5f84b1bf6e07374d6289eab3d8c57f1c"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a5f84b1bf6e07374d6289eab3d8c57f1c">ELFCLASS32</a></div><div class="ttdeci">#define ELFCLASS32</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00535">elf.h:535</a></div></div>
<div class="ttc" id="aelf_8h_html_a77301c665274669ba8d05978eb0d299e"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#a77301c665274669ba8d05978eb0d299e">EM_386</a></div><div class="ttdeci">#define EM_386</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00341">elf.h:341</a></div></div>
<div class="ttc" id="aelf_8h_html_ad8fac71aae0d2fbfab30f278a79c941a"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ad8fac71aae0d2fbfab30f278a79c941a">EM_ARM</a></div><div class="ttdeci">#define EM_ARM</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00361">elf.h:361</a></div></div>
<div class="ttc" id="aelf_8h_html_ae7d928612b2d484d2ccfd58f50be7db4"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#ae7d928612b2d484d2ccfd58f50be7db4">EM_AARCH64</a></div><div class="ttdeci">#define EM_AARCH64</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00479">elf.h:479</a></div></div>
<div class="ttc" id="aelf_8h_html_af66303c799da18c8aec282ea8592e7e7"><div class="ttname"><a href="../../d1/d9e/elf_8h.html#af66303c799da18c8aec282ea8592e7e7">ELFDATA2LSB</a></div><div class="ttdeci">#define ELFDATA2LSB</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/elf_8h_source.html#l00531">elf.h:531</a></div></div>
<div class="ttc" id="aerrno_8h_html_a4d0b1b435ec441e7d50a430b83df5832"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#a4d0b1b435ec441e7d50a430b83df5832">ENOEXEC</a></div><div class="ttdeci">#define ENOEXEC</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00043">errno.h:43</a></div></div>
<div class="ttc" id="aerrno_8h_html_ae22c3a1e0a38f3896de238cc30d0e19b"><div class="ttname"><a href="../../d8/dc2/errno_8h.html#ae22c3a1e0a38f3896de238cc30d0e19b">EISDIR</a></div><div class="ttdeci">#define EISDIR</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/errno_8h_source.html#l00082">errno.h:82</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_a27628bfab8ccdd0fdeed6778b25cd734"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#a27628bfab8ccdd0fdeed6778b25cd734">fstat</a></div><div class="ttdeci">int fstat(int fd, struct stat *statbuf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5c/kernel__io_8cpp_source.html#l00110">kernel_io.cpp:110</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_aad0f32c2c182238f2ff71c83e6ab65a0"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#aad0f32c2c182238f2ff71c83e6ab65a0">S_ISREG</a></div><div class="ttdeci">#define S_ISREG(mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00082">filesystem.hpp:82</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_abb0586253488ee61072b73557eeb873b"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#abb0586253488ee61072b73557eeb873b">O_RDWR</a></div><div class="ttdeci">#define O_RDWR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00062">filesystem.hpp:62</a></div></div>
<div class="ttc" id="afilesystem_8hpp_html_da/de7/structstat"><div class="ttname"><a href="../../d1/d85/filesystem_8hpp.html#da/de7/structstat">stat</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d85/filesystem_8hpp_source.html#l00087">filesystem.hpp:88</a></div></div>
<div class="ttc" id="akernel_8cpp_html_a277679a5638e76b6fd08abe5deee2022"><div class="ttname"><a href="../../dd/d24/kernel_8cpp.html#a277679a5638e76b6fd08abe5deee2022">fs</a></div><div class="ttdeci">vfs::Virtual * fs</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d24/kernel_8cpp_source.html#l00064">kernel.cpp:64</a></div></div>
<div class="ttc" id="akernel_8cpp_html_a5a8d7736911609823f0ff8f3c8f51df2"><div class="ttname"><a href="../../dd/d24/kernel_8cpp.html#a5a8d7736911609823f0ff8f3c8f51df2">TaskManager</a></div><div class="ttdeci">Tasking::Task * TaskManager</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d24/kernel_8cpp_source.html#l00069">kernel.cpp:69</a></div></div>
<div class="ttc" id="anamespaceExecute_html_a7660dbbcb09b7326abe3631cd98fc2ca"><div class="ttname"><a href="../../d5/d27/namespaceExecute.html#a7660dbbcb09b7326abe3631cd98fc2ca">Execute::GetBinaryType</a></div><div class="ttdeci">BinaryType GetBinaryType(const char *Path)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da6/binary__parse_8cpp_source.html#l00027">binary_parse.cpp:27</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a32ac6d7d295b6f35ec060e1fe50cf0f8"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a32ac6d7d295b6f35ec060e1fe50cf0f8">Tasking::TaskInfo::Compatibility</a></div><div class="ttdeci">TaskCompatibility Compatibility</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00187">task.hpp:187</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a6e7b9a12601b9ef62ca79d6b801c29c8af573c84c26fd6678142533c8790ec736"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a6e7b9a12601b9ef62ca79d6b801c29c8af573c84c26fd6678142533c8790ec736">Tasking::Critical</a></div><div class="ttdeci">@ Critical</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00158">task.hpp:158</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a92f7bb81f1f9acf302df0a689c0c1253ab4361355ef5fe95d2d097e6250288db6"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a92f7bb81f1f9acf302df0a689c0c1253ab4361355ef5fe95d2d097e6250288db6">Tasking::User</a></div><div class="ttdeci">@ User</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00074">task.hpp:74</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a96e537039eec201fc357dae47c819302"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302">Tasking::TaskArchitecture</a></div><div class="ttdeci">TaskArchitecture</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00046">task.hpp:47</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a96e537039eec201fc357dae47c819302a45e4a36775610d48ea685dc5d44374de"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a45e4a36775610d48ea685dc5d44374de">Tasking::ARM64</a></div><div class="ttdeci">@ ARM64</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00052">task.hpp:52</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a96e537039eec201fc357dae47c819302a5b2a90cc96dd262a5f1d340deaa28628"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a5b2a90cc96dd262a5f1d340deaa28628">Tasking::UnknownArchitecture</a></div><div class="ttdeci">@ UnknownArchitecture</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00048">task.hpp:48</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a96e537039eec201fc357dae47c819302a67026fb63dbef08d56b1cacef7d3e3ad"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a67026fb63dbef08d56b1cacef7d3e3ad">Tasking::x32</a></div><div class="ttdeci">@ x32</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00049">task.hpp:49</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a96e537039eec201fc357dae47c819302a691951f7c582f9dff5d0d0d6a73392d4"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302a691951f7c582f9dff5d0d0d6a73392d4">Tasking::x64</a></div><div class="ttdeci">@ x64</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00050">task.hpp:50</a></div></div>
<div class="ttc" id="anamespaceTasking_html_a96e537039eec201fc357dae47c819302ae006d492380a1b7ff26e7919abf0323f"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#a96e537039eec201fc357dae47c819302ae006d492380a1b7ff26e7919abf0323f">Tasking::ARM32</a></div><div class="ttdeci">@ ARM32</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00051">task.hpp:51</a></div></div>
<div class="ttc" id="anamespaceTasking_html_aabb3382fec35b68c33599188dd204e70"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#aabb3382fec35b68c33599188dd204e70">Tasking::TaskInfo::Architecture</a></div><div class="ttdeci">TaskArchitecture Architecture</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00186">task.hpp:186</a></div></div>
<div class="ttc" id="anamespaceTasking_html_acdb977b9f386c7a7662877c8b0532d48aa485dedb3548655f59d3caacb6474ee9"><div class="ttname"><a href="../../d9/d3e/namespaceTasking.html#acdb977b9f386c7a7662877c8b0532d48aa485dedb3548655f59d3caacb6474ee9">Tasking::Native</a></div><div class="ttdeci">@ Native</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00061">task.hpp:61</a></div></div>
<div class="ttc" id="atask_8hpp_html_abcc2c2d29a284c2304deb5d0778c59c8"><div class="ttname"><a href="../../d8/da1/task_8hpp.html#abcc2c2d29a284c2304deb5d0778c59c8">thisProcess</a></div><div class="ttdeci">#define thisProcess</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da1/task_8hpp_source.html#l00618">task.hpp:618</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d3a/file__descriptor_8cpp_source.html#l00314">vfs::FileDescriptorTable::_open()</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00186">Tasking::TaskInfo::Architecture</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00111">Execute::ELFObject::argv</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00051">Tasking::ARM32</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00052">Tasking::ARM64</a>, <a class="el" href="../../dc/da7/assert_8h_source.html#l00023">assert</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00113">Execute::ELFObject::auxv</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00036">BinTypeELF</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00035">BinTypeFex</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00187">Tasking::TaskInfo::Compatibility</a>, <a class="el" href="../../d9/d9c/task_8cpp_source.html#l00324">Tasking::Task::CreateProcess()</a>, <a class="el" href="../../dc/dc5/classTasking_1_1Task.html#aa1ffdb4c6acbdfd1dbd9afb4914c2656">Tasking::Task::CreateThread()</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00158">Tasking::Critical</a>, <a class="el" href="../../d3/dc4/cwalk_8c_source.html#l00942">cwk_path_get_basename()</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00094">debug</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00581">elf32_hdr::e_ident</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00583">elf32_hdr::e_machine</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00046">EI_CLASS</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00047">EI_DATA</a>, <a class="el" href="../../d8/dc2/errno_8h_source.html#l00082">EISDIR</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00535">ELFCLASS32</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00536">ELFCLASS64</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00531">ELFDATA2LSB</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00532">ELFDATA2MSB</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00341">EM_386</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00479">EM_AARCH64</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00361">EM_ARM</a>, <a class="el" href="../../d1/d9e/elf_8h_source.html#l00383">EM_X86_64</a>, <a class="el" href="../../d8/dc2/errno_8h_source.html#l00043">ENOEXEC</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00112">Execute::ELFObject::envp</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00086">error</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00077">fclose()</a>, <a class="el" href="../../d0/da5/Fex_8hpp_source.html#l00052">FexFormatType_Executable</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00379">Tasking::PCB::FileDescriptors</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00099">fixme</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00033">fopen()</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00055">fread()</a>, <a class="el" href="../../dd/d24/kernel_8cpp_source.html#l00064">fs</a>, <a class="el" href="../../d8/d5c/kernel__io_8cpp_source.html#l00110">fstat()</a>, <a class="el" href="../../d6/da6/binary__parse_8cpp_source.html#l00027">GetBinaryType()</a>, <a class="el" href="../../d9/d8f/filesystem_8cpp_source.html#l00112">vfs::Virtual::GetNodeFromPath()</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00253">Tasking::TCB::ID</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00374">Tasking::PCB::Info</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00110">Execute::ELFObject::InstructionPointer</a>, <a class="el" href="../../d2/d83/exec_8hpp_source.html#l00109">Execute::ELFObject::IsValid</a>, <a class="el" href="../../d8/d71/memory_8cpp_source.html#l00043">KernelAllocator</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00061">Tasking::Native</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00062">O_RDWR</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00187">vfs::Node::Parent</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00082">S_ISREG</a>, <a class="el" href="../../d3/d35/thread_8cpp_source.html#l00095">Tasking::TCB::SetCritical()</a>, <a class="el" href="../../d0/d4c/process_8cpp_source.html#l00072">Tasking::PCB::SetWorkingDirectory()</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00091">stat::st_mode</a>, <a class="el" href="../../d1/d85/filesystem_8hpp_source.html#l00097">stat::st_size</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00100">stub</a>, <a class="el" href="../../dd/d24/kernel_8cpp_source.html#l00069">TaskManager</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00618">thisProcess</a>, <a class="el" href="../../d4/dc3/macro_8hpp_source.html#l00046">TO_PAGES</a>, <a class="el" href="../../d0/da5/Fex_8hpp_source.html#l00090">Fex::Type</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00048">Tasking::UnknownArchitecture</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00074">Tasking::User</a>, <a class="el" href="../../d8/da1/task_8hpp_source.html#l00049">Tasking::x32</a>, and <a class="el" href="../../d8/da1/task_8hpp_source.html#l00050">Tasking::x64</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d70/kernel__thread_8cpp_source.html#l00043">SpawnInit()</a>, and <a class="el" href="../../da/d7e/execve_8cpp_source.html#l00049">sys_execve()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d5/d27/namespaceExecute.html">Execute</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
